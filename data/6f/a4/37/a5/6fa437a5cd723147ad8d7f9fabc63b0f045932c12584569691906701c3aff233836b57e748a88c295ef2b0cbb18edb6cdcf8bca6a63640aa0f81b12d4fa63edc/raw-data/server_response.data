<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="">
    <meta name="description" content="When vendors ignore least privilege guidelines you end up with local admin in a secure testing facility. The story of Pearson and their CertiPort software.">
    <meta name="copyright" content="Chad Baxter">
    <meta name="language" content="EN">
    <meta name="robots" content="index,follow" >
    <meta name="designer" content="Chad Baxter">
    <meta name="owner" content="Chad Baxter">
    <meta name="url" content="https://computeco.de">
    <meta name="identifier-URL" content="https://computeco.de">
    <meta name="directory" content="submission">
    <meta name="coverage" content="Worldwide">
    <meta name="distribution" content="Global">
    <meta name="rating" content="General">

    <title>ComputeCode</title>

    <link rel="stylesheet" href="/style/base.css">

  </head>
  <body>
    <header class="navbar">
      <section class="navbar-section">
        <a href="/" class="navbar-brand mr-2"><h1 class="title">ComputeCode</h1></a>
      </section>
      <section class="navbar-section">
        <a href="/" class="btn btn-link">Home</a>
        <a href="https://keybase.io/mrcbax" class="btn btn-link">Keybase</a>
        <a href="https://github.com/LogoiLab" class="btn btn-link">GitHub</a>
         <a href="/rss.xml" class="btn"><?xml version="1.0" encoding="UTF-8"?>
                    <svg height="1em" width="1em" style="fill: #dcdcdc;"><?xml version="1.0" encoding="iso-8859-1"?><svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 448 448" style="enable-background:new 0 0 448 448;" xml:space="preserve"><g><g><circle cx="64" cy="384" r="64"/></g></g><g><g><path d="M0,149.344v85.344c117.632,0,213.344,95.68,213.344,213.312h85.312C298.656,283.328,164.672,149.344,0,149.344z"/></g></g><g><g><path d="M0,0v85.344C200,85.344,362.688,248,362.688,448H448C448,200.96,247.04,0,0,0z"/></g></g></svg>
</svg>
                </a>
      </section>
    </header>
    <div class="container">
      <div class="columns">
        <div class="column col-3">
          <div class="card">
            <div class="post-content">
              <div class="card-title h1">Links</div>
              <div class="card-body">
                <a class="spacebar">​​﻿​​﻿﻿﻿​﻿​​﻿​﻿﻿﻿​​﻿​﻿​﻿​​﻿﻿​​﻿﻿﻿﻿﻿​﻿﻿﻿﻿﻿​​﻿​﻿﻿​​﻿﻿﻿​﻿﻿​﻿​﻿﻿﻿</a>
                <br>
                <a href="https://peegeepee.com/B6E62A011FB6F1D7C80618DC51F5CC26A52396FC" class="card-title h5">PGP: 51F5 CC26 A523 96FC</a>
                <br>
                <a href="https://doslabelectronics.com" class="card-title h5">DosLab Electronics</a>
                <br>
                <a href="/assets/feedlist.opml" class="card-title h5">Security FeedList</a>
                <br>
                <a class="spacebar">​​﻿​​﻿﻿﻿​﻿​​﻿​﻿﻿﻿​​﻿​﻿​﻿​​﻿﻿​​﻿﻿﻿﻿﻿​﻿﻿﻿﻿﻿​​﻿​﻿﻿​​﻿﻿﻿​﻿﻿​﻿​﻿﻿﻿</a>
              </div>
            </div>
          </div>
        </div>
        <div class="column col-9">
          <div class="card">
            <div class="post-content">
              <div class="card-title h1">Local Privilege Escalation in Certiport Testing Software</div>
              <div class="card-body">
                <a class="spacebar">​​﻿​​﻿﻿﻿​﻿​​﻿​﻿﻿﻿​​﻿​﻿​﻿​​﻿﻿​​﻿﻿﻿﻿﻿​﻿﻿﻿﻿﻿​​﻿​﻿﻿​​﻿﻿﻿​﻿﻿​﻿​﻿﻿﻿</a>
                <h1>Introduction</h1>
<p>Certiport testing software is used to administer certification tests for Microsoft products in a secure testing environment. The software includes monitoring and auto-grading of tests as well as a practice test functionality which will be covered in more depth below. This exploit is not new and I just got around to assigning a CVE once I realized the imp​﻿​﻿﻿​﻿﻿﻿​​​​﻿​﻿​​﻿﻿﻿﻿​​​​﻿﻿​​​﻿﻿​﻿﻿​﻿﻿﻿​﻿​​﻿​﻿​﻿​​﻿﻿​﻿​﻿​﻿﻿﻿​﻿﻿​​​﻿​﻿​​​﻿​​﻿​​﻿​​﻿​​﻿​​﻿﻿​﻿​​​﻿act it could have on testing centers. Testing centers are created by local schools, colleges, and vocational institutions. Because of the severity of the exploit and the impact it can have on these organizations I decided to push through a CVE. This was no easy task as the security personnel at Pearson Inc. (the vendor of the software) did not know what a CVE was until I informed them.</p>
<h1>Affected Versions</h1>
<ul>
<li>Ver. &lt; Certiport Console 8</li>
<li>Ver. &lt; Certiport IQSystem 7</li>
</ul>
<h1>Explanation</h1>
<p>The testing software must be run as a local administrator to be able to hook into Microsoft applications to determine the user's progress on a test. This produces some inherent risks. Upon completing a practice test the testing software asks you if you would ​﻿​﻿﻿​﻿﻿﻿​​​​﻿​﻿​​﻿﻿﻿﻿​​​​﻿﻿​​​﻿﻿​﻿﻿​﻿﻿﻿​﻿​​﻿​﻿​﻿​​﻿﻿​﻿​﻿​﻿﻿﻿​﻿﻿​​​﻿​﻿​​​﻿​​﻿​​﻿​​﻿​​﻿​​﻿﻿​﻿​​​﻿like to view your test results locally. This is done by creating a PDF and opening it in Internet Explorer or Microsoft Edge. This browser process is not a normal process though. It is a child process of the testing software that has inherited all of the pa​﻿​﻿﻿​﻿﻿﻿​​​​﻿​﻿​​﻿﻿﻿﻿​​​​﻿﻿​​​﻿﻿​﻿﻿​﻿﻿﻿​﻿​​﻿​﻿​﻿​​﻿﻿​﻿​﻿​﻿﻿﻿​﻿﻿​​​﻿​﻿​​​﻿​​﻿​​﻿​​﻿​​﻿​​﻿﻿​﻿​​​﻿rent process' permissions. Since most all browsers have a save functionality for web pages and PDFs opening the save dialog gives you local administrator access to all files and programs on the computer. This would allow an attacker or cheater to run any system applications as an administrator this includes Powershell and Command Prompt.</p>
<h1>Mitigations</h1>
<p>This is a local privilege escalation exploi​﻿​﻿﻿​﻿﻿﻿​​​​﻿​﻿​​﻿﻿﻿﻿​​​​﻿﻿​​​﻿﻿​﻿﻿​﻿﻿﻿​﻿​​﻿​﻿​﻿​​﻿﻿​﻿​﻿​﻿﻿﻿​﻿﻿​​​﻿​﻿​​​﻿​​﻿​​﻿​​﻿​​﻿​​﻿﻿​﻿​​​﻿t and as such any computers running the Certiport testing software would provide a foothold on a network from which attackers could enable remote administration, create accounts, access network shares, and install malware.</p>
<p>To mitigate this testing facilities, proctors, and exam takers should be closely monitored for abnormal activity during practice tests.</p>
<h1>Timeline</h1>
<ul>
<li>June 4, 2018:    Exploit ident​﻿​﻿﻿​﻿﻿﻿​​​​﻿​﻿​​﻿﻿﻿﻿​​​​﻿﻿​​​﻿﻿​﻿﻿​﻿﻿﻿​﻿​​﻿​﻿​﻿​​﻿﻿​﻿​﻿​﻿﻿﻿​﻿﻿​​​﻿​﻿​​​﻿​​﻿​​﻿​​﻿​​﻿​​﻿﻿​﻿​​​﻿ified and determined to be of high risk.</li>
<li>June 6, 2018:    Contacted vendor. No response.</li>
<li>June 12, 2018:   Called vendor. Explained exploit.</li>
<li>June 13, 2018:   Email response providing patch date.</li>
<li>June 26, 2018:   Software patched.</li>
<li>June 30, 2018:   CVE reserved.</li>
<li>July 29, 2018:   Exploit details written and published.</li>
<li>August 3, 2018:  CVE published <a href="https://cpcde.page.link/b7pQ">CVE-2018-12989</a>.</li>
</ul>
<h1>Closing Statement</h1>
<p>Certiport as well as Pearson Inc.​﻿​﻿﻿​﻿﻿﻿​​​​﻿​﻿​​﻿﻿﻿﻿​​​​﻿﻿​​​﻿﻿​﻿﻿​﻿﻿﻿​﻿​​﻿​﻿​﻿​​﻿﻿​﻿​﻿​﻿﻿﻿​﻿﻿​​​﻿​﻿​​​﻿​​﻿​​﻿​​﻿​​﻿​​﻿﻿​﻿​​​﻿ do not seem to have a firm grasp on how their software affects the security of school systems and colleges around the world. Upon asking for permission to publish the CVE and this article ​﻿​﻿﻿​﻿﻿﻿​​​​﻿​﻿​​﻿﻿﻿﻿​​​​﻿﻿​​​﻿﻿​﻿﻿​﻿﻿﻿​﻿​​﻿​﻿​﻿​​﻿﻿​﻿​﻿​﻿﻿﻿​﻿﻿​​​﻿​﻿​​​﻿​​﻿​​﻿​​﻿​​﻿​​﻿﻿​﻿​​​﻿I was asked &quot;What is a CVE?&quot;. Keep in mind the person I was talking to was the head of their security staff for software and networks. In the end it is up to you the customer to protect yourself when dealing with these companies.</p>

                <a class="spacebar">​​﻿​​﻿﻿﻿​﻿​​﻿​﻿﻿﻿​​﻿​﻿​﻿​​﻿﻿​​﻿﻿﻿﻿﻿​﻿﻿﻿﻿﻿​​﻿​﻿﻿​​﻿﻿﻿​﻿﻿​﻿​﻿﻿﻿</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <footer class="navbar">
      <section class="navbar-section">
        <p>&copy;2020 Chad Baxter</p>
      </section>
      <section class="navbar-section">
        <a href="https://wigle.net">
          <img src="https://wigle.net/bi/Y6ICR7rJxQTG0P4BNmvkdA.png" loading="lazy" border="0">
        </a>
        <a href="https://www.abuseipdb.com/user/34877" title="AbuseIPDB is an IP address blacklist for webmasters and sysadmins to report IP addresses engaging in abusive behavior on their networks" alt="AbuseIPDB Contributor Badge">
          <img src="https://www.abuseipdb.com/contributor/34877.svg" loading="lazy" style="width: 200px;">
        </a>
      </section>
    </footer>
    <input type="hidden" class="track"></input>
    <style>
      input.track {
          content: url('https://www.google-analytics.com/collect?v=1&tid=UA-66099830-2&t=pageview&dp=%2F2018-07-29_1.html&dt=%22Local Privilege Escalation in Certiport Testing Software%22');
      }
    </style>
  </body>
</html>
