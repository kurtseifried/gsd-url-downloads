<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<link rel="icon" href="/favicon.png">
<title>#972521 - fastd: CVE-2020-27638: DoS&#39;able memory leak on invalid packets - Debian Bug report logs</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/bugs.css" type="text/css">

<link rel="canonical" href="&lt;a href=&quot;bugreport.cgi?bug=972521&quot;&gt;972521&lt;/a&gt;">
<script type="text/javascript">
<!--
function toggle_infmessages()
{
        allDivs=document.getElementsByTagName("div");
        for (var i = 0 ; i < allDivs.length ; i++ )
        {
                if (allDivs[i].className == "infmessage")
                {
                        allDivs[i].style.display=(allDivs[i].style.display == 'none' | allDivs[i].style.display == '') ? 'block' : 'none';
                }
        }
}
-->
</script>
</head>
<body>
<h1>Debian Bug report logs - 
<a href="mailto:972521@bugs.debian.org">#972521</a><br>
fastd: CVE-2020-27638: DoS&#39;able memory leak on invalid packets</h1>
<div class="versiongraph"><a href="version.cgi?info=1;found=fastd%2F17-4;fixed=fastd%2F21-1;fixed=fastd%2F18-3%2Bdeb10u1;absolute=0;collapse=1;package=fastd"><img alt="version graph" src="version.cgi?width=2;absolute=0;fixed=fastd%2F21-1;fixed=fastd%2F18-3%2Bdeb10u1;found=fastd%2F17-4;height=2;collapse=1;package=fastd"></a></div>
<div class="pkginfo">
  <p>Package:
     <a class="submitter" href="pkgreport.cgi?package=fastd">fastd</a>;
Maintainer for <a href="pkgreport.cgi?package=fastd">fastd</a> is <a href="pkgreport.cgi?maint=team%2Bcommunitywlan%40tracker.debian.org">Debian CommunityWLAN Team &lt;team+communitywlan@tracker.debian.org&gt;</a>; Source for <a href="pkgreport.cgi?package=fastd">fastd</a> is <a href="pkgreport.cgi?src=fastd">src:fastd</a> (<a href="https://tracker.debian.org/pkg/fastd">PTS</a>, <a href="https://buildd.debian.org/fastd">buildd</a>, <a href="https://qa.debian.org/popcon.php?package=fastd">popcon</a>). </p>

</div>

<div class="buginfo">
  <p>Reported by: <a href="pkgreport.cgi?submitter=sven%40narfation.org">Sven Eckelmann &lt;sven@narfation.org&gt;</a></p>
  <p>Date: Mon, 19 Oct 2020 20:30:01 UTC</p>

<p>Severity: important</p>
<p>Tags: security</p>

<p>Found in version fastd/17-4</p>
<p>Fixed in versions fastd/21-1, fastd/18-3+deb10u1</p>

<p><strong>Done:</strong> Sven Eckelmann &lt;sven@narfation.org&gt;</p>

<p>Bug is archived. No further changes may be made.<p></div>

<p><a href="javascript:toggle_infmessages();">Toggle useless messages</a></p><div class="msgreceived"><p>View this report as an <a href="bugreport.cgi?bug=972521;mbox=yes">mbox folder</a>, <a href="bugreport.cgi?bug=972521;mbox=yes;mboxstatus=yes">status mbox</a>, <a href="bugreport.cgi?bug=972521;mbox=yes;mboxmaint=yes">maintainer mbox</a></p></div>

<div class="infmessage"><hr><p>
<a name="1"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Debian CommunityWLAN Team &lt;team+communitywlan@tracker.debian.org&gt; -->
<!-- time:1603139403 -->
<strong>Report forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Debian CommunityWLAN Team &lt;team+communitywlan@tracker.debian.org&gt;</code>:<br>
<code>Bug#972521</code>; Package <code>fastd</code>.
 (Mon, 19 Oct 2020 20:30:03 GMT) (<a href="bugreport.cgi?bug=972521;msg=2">full text</a>, <a href="bugreport.cgi?bug=972521;mbox=yes;msg=2">mbox</a>, <a href="#1">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="3"></a>
<!-- request_addr: Sven Eckelmann &lt;sven@narfation.org&gt; -->
<!-- time:1603139403 -->
<strong>Acknowledgement sent</strong>
to <code>Sven Eckelmann &lt;sven@narfation.org&gt;</code>:<br>
New Bug report received and forwarded.  Copy sent to <code>Debian CommunityWLAN Team &lt;team+communitywlan@tracker.debian.org&gt;</code>.
 (Mon, 19 Oct 2020 20:30:03 GMT) (<a href="bugreport.cgi?bug=972521;msg=4">full text</a>, <a href="bugreport.cgi?bug=972521;mbox=yes;msg=4">mbox</a>, <a href="#3">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="5"></a><a name="msg5"></a><a href="#5">Message #5</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=972521;msg=5">full text</a>, <a href="bugreport.cgi?bug=972521;mbox=yes;msg=5">mbox</a>, <a href="mailto:972521@bugs.debian.org?References=%3C5388630.IzPHLck0m8%40sven-edge%3E&amp;In-Reply-To=%3C5388630.IzPHLck0m8%40sven-edge%3E&amp;subject=Re%3A%20fastd%3A%20DoS%27able%20memory%20leak%20on%20invalid%20packets&amp;body=On%20Mon%2C%2019%20Oct%202020%2022%3A21%3A16%20%2B0200%20Sven%20Eckelmann%20%3Csven%40narfation.org%3E%20wrote%3A%0A%3E%20Package%3A%20fastd%0A%3E%20Severity%3A%20important%0A%3E%20Version%3A%2017-4%0A%3E%20%0A%3E%20fastd%20doesn%27t%20free%20receive%20buffers%20for%20invalid%20packets.%20This%20can%20lead%20to%20%0A%3E%20memory%20exhaustion%20or%20%28with%20v20%29%20to%20an%20assert.%20From%20the%20release%20text%3A%20%0A%3E%20%0A%3E%20%20%20%20%20The%20new%20buffer%20management%20of%20fastd%20v20%20revealed%20that%20received%20packets%20with%20an%0A%3E%20%20%20%20%20invalid%20type%20code%20were%20handled%20incorrectly%2C%20leaking%20the%20packet%20buffer.%20This%20lead%0A%3E%20%20%20%20%20to%20an%20assertion%20failure%20as%20soon%20as%20the%20buffer%20pool%20was%20empty%2C%20crashing%20fastd.%0A%3E%20%0A%3E%20%20%20%20%20Older%20versions%20of%20fastd%20are%20affected%20as%20well%2C%20but%20display%20a%20different%20behaviour%3A%0A%3E%20%20%20%20%20instead%20of%20crashing%2C%20the%20buffer%20leaks%20will%20manifest%20as%20a%20regular%20memory%20leak.%0A%3E%20%20%20%20%20This%20can%20still%20be%20used%20for%20Denial%20of%20Service%20attacks%2C%20so%20a%20patch%20for%20older%0A%3E%20%20%20%20%20versions%20will%20be%20provided%2C%20for%20the%20case%20that%20users%20can%27t%20or%20do%20not%20want%20to%0A%3E%20%20%20%20%20update%20to%20a%20newer%20version%20yet.%0A%3E%20%0A%3E%20The%20fix%20can%20also%20be%20found%20inside%20the%20attached%20mail.%0A%3E%20%0A%3E%20Kind%20regards%2C%0A%3E%20%09Sven">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=sven%40narfation.org" alt="">
<div class="header"><span class="headerfield">From:</span> Sven Eckelmann &lt;sven@narfation.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> &quot;submit@bugs.debian.org&quot; &lt;submit@bugs.debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> fastd: DoS&#39;able memory leak on invalid packets</div>
<div class="header"><span class="headerfield">Date:</span> Mon, 19 Oct 2020 22:21:16 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=972521;msg=5">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">Package: fastd
Severity: important
Version: 17-4

fastd doesn&#39;t free receive buffers for invalid packets. This can lead to 
memory exhaustion or (with v20) to an assert. From the release text: 

    The new buffer management of fastd v20 revealed that received packets with an
    invalid type code were handled incorrectly, leaking the packet buffer. This lead
    to an assertion failure as soon as the buffer pool was empty, crashing fastd.

    Older versions of fastd are affected as well, but display a different behaviour:
    instead of crashing, the buffer leaks will manifest as a regular memory leak.
    This can still be used for Denial of Service attacks, so a patch for older
    versions will be provided, for the case that users can&#39;t or do not want to
    update to a newer version yet.

The fix can also be found inside the attached mail.

Kind regards,
	Sven</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=972521;filename=forwarded+message;msg=5">forwarded message</a> (message/rfc822, inline)]</pre>
<blockquote>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=mschiffer%40universe-factory.net" alt="">
<div class="header"><span class="headerfield">From:</span> Matthias Schiffer &lt;mschiffer@universe-factory.net&gt;</div>
<div class="header"><span class="headerfield">To:</span> &quot;gluon@luebeck.freifunk.net&quot; &lt;gluon@luebeck.freifunk.net&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> [gluon] [ANNOUNCE] fastd v21</div>
<div class="header"><span class="headerfield">Date:</span> Mon, 19 Oct 2020 21:49:44 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=2;bug=972521;msg=5">Message part 3</a> (text/plain, inline)]</pre>
<pre class="message">Faster than expected, there is a new release of fastd, fixing a critial
Denial of Service (fastd crash) vulnerability. All users of fastd v20 must
update.

In fastd v19 and older, the same vulnerablity exists, but exploiting it
will cause a memory leak rather than an instant crash. Users that can&#39;t or
do not want to update to v21 yet should apply the patch that is attached to
this mail.

The release notes can be found at:

  <a href="https://fastd.readthedocs.io/en/stable/releases/v21.html">https://fastd.readthedocs.io/en/stable/releases/v21.html</a>

The new release can be obtained via Git from

  <a href="https://github.com/NeoRaider/fastd">https://github.com/NeoRaider/fastd</a>

or as a tarball:

  <a href="https://github.com/NeoRaider/fastd/releases/download/v21/fastd-21.tar.xz">https://github.com/NeoRaider/fastd/releases/download/v21/fastd-21.tar.xz</a>
  SHA256: 942f33bcd794bcb8e19da4c30c875bdfd4d0f1c24ec4dcdf51237791bbfb0d4c

-- NeoRaider




</pre>
<pre class="mime">[<a href="bugreport.cgi?att=3;bug=972521;filename=0001-receive-fix-buffer-leak-when-receiving-invalid-packe.patch;msg=5">0001-receive-fix-buffer-leak-when-receiving-invalid-packe.patch</a> (text/x-patch, attachment)]</pre>
<pre class="mime">[<a href="bugreport.cgi?att=4;bug=972521;filename=signature.asc;msg=5">signature.asc</a> (application/pgp-signature, attachment)]</pre>
</blockquote>
<pre class="mime">[<a href="bugreport.cgi?att=5;bug=972521;filename=signature.asc;msg=5">signature.asc</a> (application/pgp-signature, inline)]</pre>

<div class="msgreceived"><hr><p>
<a name="6"></a>
<!-- request_addr: Sven Eckelmann &lt;sven@narfation.org&gt; -->
<!-- time:1603141396 -->
<strong>Reply sent</strong>
to <code>Sven Eckelmann &lt;sven@narfation.org&gt;</code>:<br>
You have taken responsibility.
 (Mon, 19 Oct 2020 21:03:16 GMT) (<a href="bugreport.cgi?bug=972521;msg=7">full text</a>, <a href="bugreport.cgi?bug=972521;mbox=yes;msg=7">mbox</a>, <a href="#6">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="8"></a>
<!-- request_addr: Sven Eckelmann &lt;sven@narfation.org&gt; -->
<!-- time:1603141396 -->
<strong>Notification sent</strong>
to <code>Sven Eckelmann &lt;sven@narfation.org&gt;</code>:<br>
Bug acknowledged by developer.
 (Mon, 19 Oct 2020 21:03:16 GMT) (<a href="bugreport.cgi?bug=972521;msg=9">full text</a>, <a href="bugreport.cgi?bug=972521;mbox=yes;msg=9">mbox</a>, <a href="#8">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="10"></a><a name="msg10"></a><a href="#10">Message #10</a> received at 972521-done@bugs.debian.org (<a href="bugreport.cgi?bug=972521;msg=10">full text</a>, <a href="bugreport.cgi?bug=972521;mbox=yes;msg=10">mbox</a>, <a href="mailto:972521@bugs.debian.org?body=On%20Mon%2C%2019%20Oct%202020%2022%3A51%3A09%20%2B0200%20Sven%20Eckelmann%20%3Csven%40narfation.org%3E%20wrote%3A%0A%3E%20Source%3A%20fastd%0A%3E%20Source-Version%3A%2021-1%0A%3E%20Done%3A%20Sven%20Eckelmann%20%3Csven%40narfation.org%3E%0A%3E%20%0A&amp;subject=Re%3A%20Bug%23972521%3A%20fastd%3A%20DoS%27able%20memory%20leak%20on%20invalid%20packets&amp;In-Reply-To=%3C3416343.Z1zflejWrS%40sven-edge%3E&amp;References=%3C5388630.IzPHLck0m8%40sven-edge%3E%0A%20%3C3416343.Z1zflejWrS%40sven-edge%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=sven%40narfation.org" alt="">
<div class="header"><span class="headerfield">From:</span> Sven Eckelmann &lt;sven@narfation.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 972521-done@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#972521: fastd: DoS&#39;able memory leak on invalid packets</div>
<div class="header"><span class="headerfield">Date:</span> Mon, 19 Oct 2020 22:51:09 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=972521;msg=10">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">Source: fastd
Source-Version: 21-1
Done: Sven Eckelmann &lt;sven@narfation.org&gt;

</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=972521;filename=forwarded+message;msg=10">forwarded message</a> (message/rfc822, inline)]</pre>
<blockquote>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=ftpmaster%40ftp-master.debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Debian FTP Masters &lt;ftpmaster@ftp-master.debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> debian-devel-changes@lists.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Accepted fastd 21-1 (source) into unstable</div>
<div class="header"><span class="headerfield">Date:</span> Mon, 19 Oct 2020 20:35:41 +0000</div>
</div>
<pre class="message">-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Mon, 19 Oct 2020 21:47:58 +0200
Source: fastd
Architecture: source
Version: 21-1
Distribution: unstable
Urgency: high
Maintainer: Debian CommunityWLAN Team &lt;team+communitywlan@tracker.debian.org&gt;
Changed-By: Sven Eckelmann &lt;sven@narfation.org&gt;
Changes:
 fastd (21-1) unstable; urgency=high
 .
   * New Upstream Version
     - Fix crash (assert) when receiving too many invalid packets
Checksums-Sha1:
 86e3526afcdd5e029a4c83245f4a784fb824479f 2118 fastd_21-1.dsc
 685f538e46b32a1a63c86fbfbc7934d97a93a9a5 137660 fastd_21.orig.tar.xz
 f9c38e8e1e410e9a54f092b53f946b8bc1f74a03 6784 fastd_21-1.debian.tar.xz
 47e521cb5e55360739824f76c49fb1a4e95060dd 7569 fastd_21-1_source.buildinfo
Checksums-Sha256:
 503249c0366679398819d5b3e7d38bf2a59d9cd7ca20d1ec0e68aeb002f45653 2118 fastd_21-1.dsc
 942f33bcd794bcb8e19da4c30c875bdfd4d0f1c24ec4dcdf51237791bbfb0d4c 137660 fastd_21.orig.tar.xz
 803f8e8e37a53b55001cdd76c0edfc2d1498da045e800d91ca7e804d902276c8 6784 fastd_21-1.debian.tar.xz
 30b46e89ce0da3b26dd88b813f611165d3f110b870041b04bb2abcfc417298b6 7569 fastd_21-1_source.buildinfo
Files:
 ba245bab5393210f1e75b3c1f98a20e4 2118 net optional fastd_21-1.dsc
 6342b9eae209327ce1d0ae99bc493425 137660 net optional fastd_21.orig.tar.xz
 ea9046ee7838ee6e38cb2a65f830ab73 6784 net optional fastd_21-1.debian.tar.xz
 0f9b4da78c305ceb4256a6397d56a035 7569 net optional fastd_21-1_source.buildinfo

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEF10rh2Elc9zjMuACXYcKB8Eme0YFAl+N7ggACgkQXYcKB8Em
e0bmjw//ZizLoG5D3L/kM6kD1OePBywBapBUyu2H86UpSdNExKC7i/Sob2kH4+DI
MldM04bUQ5tViieOGjtdIHicVe3HJKiM9lQZGl7MDWMteG02SQpYpQVIhKEzf+DS
/Eo+naZY0ttvJCEoeAN3CCkS98VoaK9RiynjlMUxmqC/kKmps/N5OFqevzh6g/ot
fFa9wUR2wQ9j2coJI+IplrkJTi3S6GmE9VWbj9ouaf2aLMAWFsl4h2BDHgG8IBFZ
plRT0ANHurBp6bNpJaPcRnndd0pqDjMRoA5/DkIMZTjEzWwKVVGo37wPvF5ac87t
vqfEcd4WbQ6EO26hd+4FxrbFXGqQ6b7fCXjg2BpnoFVGzy4w84e3xmT0s1KYxNmZ
ajKIdrzsl2tbxspdbB6MQonsYXMipw0jZvloI54ftvOe8E8E6sY4CvO61fCgfwFX
ZZ0kn8+1a0jIs/VGh/UgAOT/u+7xGJ9MJZ3mcabn3jNlqFy6E4546OnbX5BjPOmk
e1gCbxNehgroSom0vtOKhMqzjUiAJ4r4+is3w4gGPdyUO35eUVsvmfQS+gf4GBuc
ldPTMNBSHBtnwFtAT2p6oP7kZqe5fmC7XMOZFRXHYSe6HyBjLqW3h2ex5Kbi1cA5
UoS42nbZDlxwDw22WgMntdd4g2TN9KscmJo3AHyCVsRdG0wUdL0=
=GXef
-----END PGP SIGNATURE-----

</pre>
</blockquote>
<pre class="mime">[<a href="bugreport.cgi?att=2;bug=972521;filename=signature.asc;msg=10">signature.asc</a> (application/pgp-signature, inline)]</pre>

<div class="msgreceived"><hr><p>
<a name="11"></a>
<!-- command:tag -->
<!-- requester: Salvatore Bonaccorso &lt;carnil@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1603350542 -->
<!-- new_data:
$new_data = {
              &#39;keywords&#39; =&gt; &#39;security&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;keywords&#39; =&gt; &#39;&#39;
            };
-->
<strong>Added tag(s) security.</strong>
Request was from <code>Salvatore Bonaccorso &lt;carnil@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Thu, 22 Oct 2020 07:09:02 GMT) (<a href="bugreport.cgi?bug=972521;msg=12">full text</a>, <a href="bugreport.cgi?bug=972521;mbox=yes;msg=12">mbox</a>, <a href="#11">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="13"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Debian CommunityWLAN Team &lt;team+communitywlan@tracker.debian.org&gt; -->
<!-- time:1603370522 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Debian CommunityWLAN Team &lt;team+communitywlan@tracker.debian.org&gt;</code>:<br>
<code>Bug#972521</code>; Package <code>fastd</code>.
 (Thu, 22 Oct 2020 12:42:02 GMT) (<a href="bugreport.cgi?bug=972521;msg=14">full text</a>, <a href="bugreport.cgi?bug=972521;mbox=yes;msg=14">mbox</a>, <a href="#13">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="15"></a>
<!-- request_addr: Salvatore Bonaccorso &lt;carnil@debian.org&gt; -->
<!-- time:1603370522 -->
<strong>Acknowledgement sent</strong>
to <code>Salvatore Bonaccorso &lt;carnil@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Debian CommunityWLAN Team &lt;team+communitywlan@tracker.debian.org&gt;</code>.
 (Thu, 22 Oct 2020 12:42:02 GMT) (<a href="bugreport.cgi?bug=972521;msg=16">full text</a>, <a href="bugreport.cgi?bug=972521;mbox=yes;msg=16">mbox</a>, <a href="#15">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="17"></a><a name="msg17"></a><a href="#17">Message #17</a> received at 972521@bugs.debian.org (<a href="bugreport.cgi?bug=972521;msg=17">full text</a>, <a href="bugreport.cgi?bug=972521;mbox=yes;msg=17">mbox</a>, <a href="mailto:972521@bugs.debian.org?In-Reply-To=%3C20201022123902.GA31964%40lorien.valinor.li%3E&amp;References=%3C5388630.IzPHLck0m8%40sven-edge%3E%0A%20%3C20201022123902.GA31964%40lorien.valinor.li%3E&amp;body=On%20Thu%2C%2022%20Oct%202020%2014%3A39%3A02%20%2B0200%20Salvatore%20Bonaccorso%20%3Ccarnil%40debian.org%3E%20wrote%3A%0A%3E%20Control%3A%20retitle%20-1%20fastd%3A%20CVE-2020-27638%3A%20DoS%27able%20memory%20leak%20on%20invalid%20packets%20%0A%3E%20%0A%3E%20On%20Mon%2C%20Oct%2019%2C%202020%20at%2010%3A21%3A16PM%20%2B0200%2C%20Sven%20Eckelmann%20wrote%3A%0A%3E%20%3E%20Package%3A%20fastd%0A%3E%20%3E%20Severity%3A%20important%0A%3E%20%3E%20Version%3A%2017-4%0A%3E%20%3E%20%0A%3E%20%3E%20fastd%20doesn%27t%20free%20receive%20buffers%20for%20invalid%20packets.%20This%20can%20lead%20to%20%0A%3E%20%3E%20memory%20exhaustion%20or%20%28with%20v20%29%20to%20an%20assert.%20From%20the%20release%20text%3A%20%0A%3E%20%3E%20%0A%3E%20%3E%20%20%20%20%20The%20new%20buffer%20management%20of%20fastd%20v20%20revealed%20that%20received%20packets%20with%20an%0A%3E%20%3E%20%20%20%20%20invalid%20type%20code%20were%20handled%20incorrectly%2C%20leaking%20the%20packet%20buffer.%20This%20lead%0A%3E%20%3E%20%20%20%20%20to%20an%20assertion%20failure%20as%20soon%20as%20the%20buffer%20pool%20was%20empty%2C%20crashing%20fastd.%0A%3E%20%3E%20%0A%3E%20%3E%20%20%20%20%20Older%20versions%20of%20fastd%20are%20affected%20as%20well%2C%20but%20display%20a%20different%20behaviour%3A%0A%3E%20%3E%20%20%20%20%20instead%20of%20crashing%2C%20the%20buffer%20leaks%20will%20manifest%20as%20a%20regular%20memory%20leak.%0A%3E%20%3E%20%20%20%20%20This%20can%20still%20be%20used%20for%20Denial%20of%20Service%20attacks%2C%20so%20a%20patch%20for%20older%0A%3E%20%3E%20%20%20%20%20versions%20will%20be%20provided%2C%20for%20the%20case%20that%20users%20can%27t%20or%20do%20not%20want%20to%0A%3E%20%3E%20%20%20%20%20update%20to%20a%20newer%20version%20yet.%0A%3E%20%3E%20%0A%3E%20%3E%20The%20fix%20can%20also%20be%20found%20inside%20the%20attached%20mail.%0A%3E%20%0A%3E%20CVE-2020-27638%20was%20assigned%20for%20this%20issue.%0A%3E%20%0A%3E%20Regards%2C%0A%3E%20Salvatore%0A%3E%20%0A%3E%20%0A&amp;subject=Re%3A%20Bug%23972521%3A%20fastd%3A%20DoS%27able%20memory%20leak%20on%20invalid%20packets">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=carnil%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Salvatore Bonaccorso &lt;carnil@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Sven Eckelmann &lt;sven@narfation.org&gt;, 972521@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#972521: fastd: DoS&#39;able memory leak on invalid packets</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 22 Oct 2020 14:39:02 +0200</div>
</div>
<pre class="message">Control: retitle -1 fastd: <a href="https://security-tracker.debian.org/tracker/CVE-2020-27638">CVE-2020-27638</a>: DoS&#39;able memory leak on invalid packets 

On Mon, Oct 19, 2020 at 10:21:16PM +0200, Sven Eckelmann wrote:
&gt; Package: fastd
&gt; Severity: important
&gt; Version: 17-4
&gt; 
&gt; fastd doesn&#39;t free receive buffers for invalid packets. This can lead to 
&gt; memory exhaustion or (with v20) to an assert. From the release text: 
&gt; 
&gt;     The new buffer management of fastd v20 revealed that received packets with an
&gt;     invalid type code were handled incorrectly, leaking the packet buffer. This lead
&gt;     to an assertion failure as soon as the buffer pool was empty, crashing fastd.
&gt; 
&gt;     Older versions of fastd are affected as well, but display a different behaviour:
&gt;     instead of crashing, the buffer leaks will manifest as a regular memory leak.
&gt;     This can still be used for Denial of Service attacks, so a patch for older
&gt;     versions will be provided, for the case that users can&#39;t or do not want to
&gt;     update to a newer version yet.
&gt; 
&gt; The fix can also be found inside the attached mail.

<a href="https://security-tracker.debian.org/tracker/CVE-2020-27638">CVE-2020-27638</a> was assigned for this issue.

Regards,
Salvatore


</pre>

<div class="msgreceived"><hr><p>
<a name="18"></a>
<!-- command:title -->
<!-- requester: Salvatore Bonaccorso &lt;carnil@debian.org&gt; -->
<!-- request_addr: 972521-submit@bugs.debian.org -->
<!-- time:1603370522 -->
<!-- new_data:
$new_data = {
              &#39;subject&#39; =&gt; &#39;fastd: CVE-2020-27638: DoS\&#39;able memory leak on invalid packets&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;subject&#39; =&gt; &#39;fastd: DoS\&#39;able memory leak on invalid packets&#39;
            };
-->
<strong>Changed Bug title to &#39;fastd: CVE-2020-27638: DoS&#39;able memory leak on invalid packets&#39; from &#39;fastd: DoS&#39;able memory leak on invalid packets&#39;.</strong>
Request was from <code>Salvatore Bonaccorso &lt;carnil@debian.org&gt;</code>
to <code>972521-submit@bugs.debian.org</code>.
 (Thu, 22 Oct 2020 12:42:02 GMT) (<a href="bugreport.cgi?bug=972521;msg=19">full text</a>, <a href="bugreport.cgi?bug=972521;mbox=yes;msg=19">mbox</a>, <a href="#18">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="20"></a>
<!-- request_addr: Sven Eckelmann &lt;sven@narfation.org&gt; -->
<!-- time:1605813670 -->
<strong>Reply sent</strong>
to <code>Sven Eckelmann &lt;sven@narfation.org&gt;</code>:<br>
You have taken responsibility.
 (Thu, 19 Nov 2020 19:21:10 GMT) (<a href="bugreport.cgi?bug=972521;msg=21">full text</a>, <a href="bugreport.cgi?bug=972521;mbox=yes;msg=21">mbox</a>, <a href="#20">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="22"></a>
<!-- request_addr: Sven Eckelmann &lt;sven@narfation.org&gt; -->
<!-- time:1605813670 -->
<strong>Notification sent</strong>
to <code>Sven Eckelmann &lt;sven@narfation.org&gt;</code>:<br>
Bug acknowledged by developer.
 (Thu, 19 Nov 2020 19:21:10 GMT) (<a href="bugreport.cgi?bug=972521;msg=23">full text</a>, <a href="bugreport.cgi?bug=972521;mbox=yes;msg=23">mbox</a>, <a href="#22">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="24"></a><a name="msg24"></a><a href="#24">Message #24</a> received at 972521-close@bugs.debian.org (<a href="bugreport.cgi?bug=972521;msg=24">full text</a>, <a href="bugreport.cgi?bug=972521;mbox=yes;msg=24">mbox</a>, <a href="mailto:972521@bugs.debian.org?subject=Re%3A%20Bug%23972521%3A%20fixed%20in%20fastd%2018-3%2Bdeb10u1&amp;body=On%20Thu%2C%2019%20Nov%202020%2019%3A17%3A08%20%2B0000%20Debian%20FTP%20Masters%20%3Cftpmaster%40ftp-master.debian.org%3E%20wrote%3A%0A%3E%20Source%3A%20fastd%0A%3E%20Source-Version%3A%2018-3%2Bdeb10u1%0A%3E%20Done%3A%20Sven%20Eckelmann%20%3Csven%40narfation.org%3E%0A%3E%20%0A%3E%20We%20believe%20that%20the%20bug%20you%20reported%20is%20fixed%20in%20the%20latest%20version%20of%0A%3E%20fastd%2C%20which%20is%20due%20to%20be%20installed%20in%20the%20Debian%20FTP%20archive.%0A%3E%20%0A%3E%20A%20summary%20of%20the%20changes%20between%20this%20version%20and%20the%20previous%20one%20is%0A%3E%20attached.%0A%3E%20%0A%3E%20Thank%20you%20for%20reporting%20the%20bug%2C%20which%20will%20now%20be%20closed.%20%20If%20you%0A%3E%20have%20further%20comments%20please%20address%20them%20to%20972521%40bugs.debian.org%2C%0A%3E%20and%20the%20maintainer%20will%20reopen%20the%20bug%20report%20if%20appropriate.%0A%3E%20%0A%3E%20Debian%20distribution%20maintenance%20software%0A%3E%20pp.%0A%3E%20Sven%20Eckelmann%20%3Csven%40narfation.org%3E%20%28supplier%20of%20updated%20fastd%20package%29%0A%3E%20%0A%3E%20%28This%20message%20was%20generated%20automatically%20at%20their%20request%3B%20if%20you%0A%3E%20believe%20that%20there%20is%20a%20problem%20with%20it%20please%20contact%20the%20archive%0A%3E%20administrators%20by%20mailing%20ftpmaster%40ftp-master.debian.org%29%0A%3E%20%0A%3E%20%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA512%0A%3E%20%0A%3E%20Format%3A%201.8%0A%3E%20Date%3A%20Mon%2C%2019%20Oct%202020%2022%3A38%3A02%20%2B0200%0A%3E%20Source%3A%20fastd%0A%3E%20Architecture%3A%20source%0A%3E%20Version%3A%2018-3%2Bdeb10u1%0A%3E%20Distribution%3A%20buster%0A%3E%20Urgency%3A%20medium%0A%3E%20Maintainer%3A%20Matthias%20Schiffer%20%3Cmschiffer%40universe-factory.net%3E%0A%3E%20Changed-By%3A%20Sven%20Eckelmann%20%3Csven%40narfation.org%3E%0A%3E%20Closes%3A%20972521%0A%3E%20Changes%3A%0A%3E%20%20fastd%20%2818-3%2Bdeb10u1%29%20buster%3B%20urgency%3Dmedium%0A%3E%20%20.%0A%3E%20%20%20%20%2A%20debian%2Fpatches%3A%0A%3E%20%20%20%20%20%20-%20Add%200001-receive-fix-buffer-leak-when-receiving-invalid-packe.patch%2C%0A%3E%20%20%20%20%20%20%20%20CVE-2020-27638%3A%20Fix%20DoS%27able%20memory%20leak%20when%20receiving%20too%20many%0A%3E%20%20%20%20%20%20%20%20invalid%20packets%20%28Closes%3A%20%23972521%29%0A%3E%20Checksums-Sha1%3A%0A%3E%20%20c71caf2b495deab8ba8bf39eeecf6e4b4a71cc90%201919%20fastd_18-3%2Bdeb10u1.dsc%0A%3E%20%2089707af0c3f70d91909095a058916fb60b7260b5%206444%20fastd_18-3%2Bdeb10u1.debian.tar.xz%0A%3E%20%20f3e656a6ad4572d73a4394432bb8e571c4a24d60%207247%20fastd_18-3%2Bdeb10u1_source.buildinfo%0A%3E%20Checksums-Sha256%3A%0A%3E%20%20d315869c8b77ee71dc4fbe8c909e66fdf60f915a343308c2c63c03622e8a4160%201919%20fastd_18-3%2Bdeb10u1.dsc%0A%3E%20%20f8aa279853545ba777217bdf40d846e0c973b93f3b48bcb04a48d7c2813b133f%206444%20fastd_18-3%2Bdeb10u1.debian.tar.xz%0A%3E%20%200a6badd956ac82aa3f3d2ff2970e7f53ac8ae185d50802ca478f217ab9883202%207247%20fastd_18-3%2Bdeb10u1_source.buildinfo%0A%3E%20Files%3A%0A%3E%20%209ce1a1387e8985f6cff5ecf0e3a3defb%201919%20net%20optional%20fastd_18-3%2Bdeb10u1.dsc%0A%3E%20%20913db07e746cc814959e4c6076850d24%206444%20net%20optional%20fastd_18-3%2Bdeb10u1.debian.tar.xz%0A%3E%20%2074b291c8f513704f0c95af593621b39a%207247%20net%20optional%20fastd_18-3%2Bdeb10u1_source.buildinfo%0A%3E%20%0A%3E%20-----BEGIN%20PGP%20SIGNATURE-----%0A%3E%20%0A%3E%20iQIzBAEBCgAdFiEEF10rh2Elc9zjMuACXYcKB8Eme0YFAl%2BUeggACgkQXYcKB8Em%0A%3E%20e0alfhAAsI7GpbsC2aZF6sZD72XuVTVINq6%2Bdjp9mB1IXa%2BwFBtqr5Gv1LfxcIDa%0A&amp;References=%3CE1kfpQa-0000df-FL%40fasolo.debian.org%3E&amp;In-Reply-To=%3CE1kfpQa-0000df-FL%40fasolo.debian.org%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=ftpmaster%40ftp-master.debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Debian FTP Masters &lt;ftpmaster@ftp-master.debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 972521-close@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#972521: fixed in fastd 18-3+deb10u1</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 19 Nov 2020 19:17:08 +0000</div>
</div>
<pre class="message">Source: fastd
Source-Version: 18-3+deb10u1
Done: Sven Eckelmann &lt;sven@narfation.org&gt;

We believe that the bug you reported is fixed in the latest version of
fastd, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 972521@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Sven Eckelmann &lt;sven@narfation.org&gt; (supplier of updated fastd package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Mon, 19 Oct 2020 22:38:02 +0200
Source: fastd
Architecture: source
Version: 18-3+deb10u1
Distribution: buster
Urgency: medium
Maintainer: Matthias Schiffer &lt;mschiffer@universe-factory.net&gt;
Changed-By: Sven Eckelmann &lt;sven@narfation.org&gt;
Closes: <a href="bugreport.cgi?bug=972521">972521</a>
Changes:
 fastd (18-3+deb10u1) buster; urgency=medium
 .
   * debian/patches:
     - Add 0001-receive-fix-buffer-leak-when-receiving-invalid-packe.patch,
       <a href="https://security-tracker.debian.org/tracker/CVE-2020-27638">CVE-2020-27638</a>: Fix DoS&#39;able memory leak when receiving too many
       invalid packets (Closes: #<a href="bugreport.cgi?bug=972521">972521</a>)
Checksums-Sha1:
 c71caf2b495deab8ba8bf39eeecf6e4b4a71cc90 1919 fastd_18-3+deb10u1.dsc
 89707af0c3f70d91909095a058916fb60b7260b5 6444 fastd_18-3+deb10u1.debian.tar.xz
 f3e656a6ad4572d73a4394432bb8e571c4a24d60 7247 fastd_18-3+deb10u1_source.buildinfo
Checksums-Sha256:
 d315869c8b77ee71dc4fbe8c909e66fdf60f915a343308c2c63c03622e8a4160 1919 fastd_18-3+deb10u1.dsc
 f8aa279853545ba777217bdf40d846e0c973b93f3b48bcb04a48d7c2813b133f 6444 fastd_18-3+deb10u1.debian.tar.xz
 0a6badd956ac82aa3f3d2ff2970e7f53ac8ae185d50802ca478f217ab9883202 7247 fastd_18-3+deb10u1_source.buildinfo
Files:
 9ce1a1387e8985f6cff5ecf0e3a3defb 1919 net optional fastd_18-3+deb10u1.dsc
 913db07e746cc814959e4c6076850d24 6444 net optional fastd_18-3+deb10u1.debian.tar.xz
 74b291c8f513704f0c95af593621b39a 7247 net optional fastd_18-3+deb10u1_source.buildinfo

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEF10rh2Elc9zjMuACXYcKB8Eme0YFAl+UeggACgkQXYcKB8Em
e0alfhAAsI7GpbsC2aZF6sZD72XuVTVINq6+djp9mB1IXa+wFBtqr5Gv1LfxcIDa
If7KErQJKRj/mEAgK7p5y19T/mW5b0NwnTuUKRRSh/5ulgYquUMpXpbCTC9u4HVk
XbhhvTp6g0RX/+QZ2jxWLIu/ogz6jobRyFHDDdfjK6icZ07sbp1bF134yxH8KdEf
aFpKr2Am272na9qiPSvIiQRmsByBRAg3YjPc6KkKIPienGS2Xn4M4Uq3XSDsgAXr
3Z0tpW9NvAunQwTuzHDGUQRZrgJTx2kcYJnOrcMWwgL5i8N8xho2zWhpYJue1M1d
0ygS5a8jTZmAPAFc2+EKIhS98RgeaUu5/XYK6QVV6mjEA1HUEjBSpdaBRTs9mKc0
ZcaYUZc3CAH68rzNo8/Jp+P04jlaijspqdOAxABAHHrIjyobBanNRAK+5bjjvvhC
ualwzust9RtGTldvyYhA5a7StIL47bgSJsr/5RK4b9Dbx5kBAQ82L3X7sy3pj4J8
vV92WXiOkkdiUcltWlJMWLXFmiZDD6r5Nz66QypU4+i9tOn4lxMDyXulHPh9yv2P
Fx5BpPyNBjWWhJ0swtqXd3DH+DYi5DjBcRUaG704pwYQG7usYGtfaJQWL/JepPB2
AjXi5xMsA2dfDcYizLzv8INc2FqG/nUFl1AQdY/NCuaHNJUh9fQ=
=DqDM
-----END PGP SIGNATURE-----



</pre>

<div class="msgreceived"><hr><p>
<a name="25"></a>
<!-- command:archive -->
<!-- requester: Debbugs Internal Request &lt;owner@bugs.debian.org&gt; -->
<!-- request_addr: internal_control@bugs.debian.org -->
<!-- time:1608276348 -->
<!-- new_data:
$new_data = {};
-->
<!-- old_data:
$old_data = {};
-->
<strong>Bug archived.</strong>
Request was from <code>Debbugs Internal Request &lt;owner@bugs.debian.org&gt;</code>
to <code>internal_control@bugs.debian.org</code>.
 (Fri, 18 Dec 2020 07:25:48 GMT) (<a href="bugreport.cgi?bug=972521;msg=26">full text</a>, <a href="bugreport.cgi?bug=972521;mbox=yes;msg=26">mbox</a>, <a href="#25">link</a>).</p></p></div>

<hr>
<p class="msgreceived">Send a report that <a href="https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=972521">this bug log contains spam</a>.</p>
<hr>
<ADDRESS>Debian bug tracking system administrator &lt;<A HREF="mailto:owner@bugs.debian.org">owner@bugs.debian.org</A>&gt;.
Last modified:
<!--timestamp-->Sat Oct 30 18:22:02 2021<!--end timestamp-->; 
Machine Name:
<!--machinename-->bembo<!--machinename-->
<P>
<A HREF="https://www.debian.org/Bugs/">Debian Bug tracking system</A>
</p>
<p>
  Debbugs is free software and licensed under the terms of the GNU
  Public License version 2. The current version can be obtained
  from <a href="https://bugs.debian.org/debbugs-source/">https://bugs.debian.org/debbugs-source/</a>.
</p>
<p>
Copyright Â© 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.
</p>
</ADDRESS>

</body>
</html>
