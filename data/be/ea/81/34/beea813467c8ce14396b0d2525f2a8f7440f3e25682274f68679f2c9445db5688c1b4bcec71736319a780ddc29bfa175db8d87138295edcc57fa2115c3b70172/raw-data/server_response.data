<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<link rel="icon" href="/favicon.png">
<title>#779392 - glibc: CVE-2015-8985: potential denial of service in pop_fail_stack() - Debian Bug report logs</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/bugs.css" type="text/css">

<link rel="canonical" href="&lt;a href=&quot;bugreport.cgi?bug=779392&quot;&gt;779392&lt;/a&gt;">
<script type="text/javascript">
<!--
function toggle_infmessages()
{
        allDivs=document.getElementsByTagName("div");
        for (var i = 0 ; i < allDivs.length ; i++ )
        {
                if (allDivs[i].className == "infmessage")
                {
                        allDivs[i].style.display=(allDivs[i].style.display == 'none' | allDivs[i].style.display == '') ? 'block' : 'none';
                }
        }
}
-->
</script>
</head>
<body>
<h1>Debian Bug report logs - 
<a href="mailto:779392@bugs.debian.org">#779392</a><br>
glibc: CVE-2015-8985: potential denial of service in pop_fail_stack()</h1>
<div class="versiongraph"><a href="version.cgi?info=1;absolute=0;package=libc6;found=glibc%2F2.19-15;fixed=glibc%2F2.28-0experimental0;collapse=1"><img alt="version graph" src="version.cgi?height=2;width=2;collapse=1;fixed=glibc%2F2.28-0experimental0;package=libc6;found=glibc%2F2.19-15;absolute=0"></a></div>
<div class="pkginfo">
  <p>Package:
     <a class="submitter" href="pkgreport.cgi?package=libc6">libc6</a>;
Maintainer for <a href="pkgreport.cgi?package=libc6">libc6</a> is <a href="pkgreport.cgi?maint=debian-glibc%40lists.debian.org">GNU Libc Maintainers &lt;debian-glibc@lists.debian.org&gt;</a>; Source for <a href="pkgreport.cgi?package=libc6">libc6</a> is <a href="pkgreport.cgi?src=glibc">src:glibc</a> (<a href="https://tracker.debian.org/pkg/glibc">PTS</a>, <a href="https://buildd.debian.org/glibc">buildd</a>, <a href="https://qa.debian.org/popcon.php?package=glibc">popcon</a>). </p>

</div>

<div class="buginfo">
  <p>Reported by: <a href="pkgreport.cgi?submitter=jwilk%40debian.org">Jakub Wilk &lt;jwilk@debian.org&gt;</a></p>
  <p>Date: Sat, 28 Feb 2015 00:21:07 UTC</p>

<p>Severity: normal</p>
<p>Tags: fixed-upstream, security</p>

<p>Found in version glibc/2.19-15</p>
<p>Fixed in version glibc/2.28-0experimental0</p>

<p><strong>Done:</strong> Salvatore Bonaccorso &lt;carnil@debian.org&gt;</p>

<p>Bug is archived. No further changes may be made.<p><p>Forwarded to <a href="https://sourceware.org/bugzilla/show_bug.cgi?id=21163">https://sourceware.org/bugzilla/show_bug.cgi?id=21163</a></p>
</div>

<p><a href="javascript:toggle_infmessages();">Toggle useless messages</a></p><div class="msgreceived"><p>View this report as an <a href="bugreport.cgi?bug=779392;mbox=yes">mbox folder</a>, <a href="bugreport.cgi?bug=779392;mbox=yes;mboxstatus=yes">status mbox</a>, <a href="bugreport.cgi?bug=779392;mbox=yes;mboxmaint=yes">maintainer mbox</a></p></div>

<div class="infmessage"><hr><p>
<a name="1"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, jwilk@debian.org, GNU Libc Maintainers &lt;debian-glibc@lists.debian.org&gt; -->
<!-- time:1425082871 -->
<strong>Report forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, jwilk@debian.org, GNU Libc Maintainers &lt;debian-glibc@lists.debian.org&gt;</code>:<br>
<code>Bug#779392</code>; Package <code>libc6</code>.
 (Sat, 28 Feb 2015 00:21:11 GMT) (<a href="bugreport.cgi?bug=779392;msg=2">full text</a>, <a href="bugreport.cgi?bug=779392;mbox=yes;msg=2">mbox</a>, <a href="#1">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="3"></a><a name="msg3"></a><a href="#3">Message #3</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=779392;msg=3">full text</a>, <a href="bugreport.cgi?bug=779392;mbox=yes;msg=3">mbox</a>, <a href="mailto:779392@bugs.debian.org?body=On%20Sat%2C%2028%20Feb%202015%2001%3A19%3A56%20%2B0100%20Jakub%20Wilk%20%3Cjwilk%40debian.org%3E%20wrote%3A%0A%3E%20Package%3A%20libc6%0A%3E%20Version%3A%202.19-15%0A%3E%20Tags%3A%20security%0A%3E%20Usertags%3A%20afl%0A%3E%20%0A%3E%20The%20attached%20test%20program%2C%20which%20compiles%20an%20invalid%20regexp%20and%20then%20%0A%3E%20tries%20to%20match%20a%20string%20against%20it%2C%20triggers%20an%20assertion%3A%0A%3E%20%0A%3E%20%24%20make%20CFLAGS%3D-Wall%20pop_fail_stack%0A%3E%20cc%20-Wall%20%20%20%20pop_fail_stack.c%20%20%20-o%20pop_fail_stack%0A%3E%20%0A%3E%20%24%20.%2Fpop_fail_stack%0A%3E%20pop_fail_stack%3A%20regexec.c%3A1401%3A%20pop_fail_stack%3A%20Assertion%20%60num%20%3E%3D%200%27%20failed.%0A%3E%20Aborted%0A%3E%20%0A%3E%20%0A%3E%20This%20bug%20was%20found%20using%20American%20fuzzy%20lop%3A%0A%3E%20http%3A%2F%2Flcamtuf.coredump.cx%2Fafl%2F%0A%3E%20%28available%20in%20Debian%20experimental%29%0A%3E%20%0A%3E%20%0A%3E%20--%20System%20Information%3A%0A%3E%20Debian%20Release%3A%208.0%0A%3E%20%20%20APT%20prefers%20unstable%0A%3E%20%20%20APT%20policy%3A%20%28990%2C%20%27unstable%27%29%2C%20%28500%2C%20%27experimental%27%29%0A%3E%20Architecture%3A%20i386%20%28x86_64%29%0A%3E%20Foreign%20Architectures%3A%20amd64%0A%3E%20%0A%3E%20Kernel%3A%20Linux%203.2.0-4-amd64%20%28SMP%20w%2F2%20CPU%20cores%29%0A%3E%20Locale%3A%20LANG%3DC%2C%20LC_CTYPE%3Dpl_PL.UTF-8%20%28charmap%3DUTF-8%29%0A%3E%20Shell%3A%20%2Fbin%2Fsh%20linked%20to%20%2Fbin%2Fdash%0A%3E%20Init%3A%20sysvinit%20%28via%20%2Fsbin%2Finit%29%0A%3E%20%0A%3E%20Versions%20of%20packages%20libc6%20depends%20on%3A%0A%3E%20ii%20%20libgcc1%20%201%3A5-20150226-1%0A%3E%20%0A%3E%20Versions%20of%20packages%20libc6%20recommends%3A%0A%3E%20ii%20%20libc6-i686%20%202.19-15%0A%3E%20%0A%3E%20Versions%20of%20packages%20libc6%20suggests%3A%0A%3E%20ii%20%20debconf%20%5Bdebconf-2.0%5D%20%201.5.55%0A%3E%20ii%20%20glibc-doc%20%20%20%20%20%20%20%20%20%20%20%20%20%202.19-15%0A%3E%20ii%20%20locales%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%202.19-15%0A%3E%20%0A%3E%20--%20%0A%3E%20Jakub%20Wilk%0A&amp;References=%3C20150228001956.GA8308%40jwilk.net%3E&amp;In-Reply-To=%3C20150228001956.GA8308%40jwilk.net%3E&amp;subject=Re%3A%20libc6%3A%20regexec.c%3A1401%3A%20pop_fail_stack%3A%20Assertion%20%60num%20%3E%3D%200%27%20failed">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=jwilk%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Jakub Wilk &lt;jwilk@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Debian Bug Tracking System &lt;submit@bugs.debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> libc6: regexec.c:1401: pop_fail_stack: Assertion `num &gt;= 0&#39; failed</div>
<div class="header"><span class="headerfield">Date:</span> Sat, 28 Feb 2015 01:19:56 +0100</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=779392;msg=3">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message flowed">Package: libc6
Version: 2.19-15
Tags: security
Usertags: afl

The attached test program, which compiles an invalid regexp and then 
tries to match a string against it, triggers an assertion:

$ make CFLAGS=-Wall pop_fail_stack
cc -Wall    pop_fail_stack.c   -o pop_fail_stack

$ ./pop_fail_stack
pop_fail_stack: regexec.c:1401: pop_fail_stack: Assertion `num &gt;= 0&#39; failed.
Aborted


This bug was found using American fuzzy lop:
<a href="http://lcamtuf.coredump.cx/afl/">http://lcamtuf.coredump.cx/afl/</a>
(available in Debian experimental)


-- System Information:
Debian Release: 8.0
 APT prefers unstable
 APT policy: (990, &#39;unstable&#39;), (500, &#39;experimental&#39;)
Architecture: i386 (x86_64)
Foreign Architectures: amd64

Kernel: Linux 3.2.0-4-amd64 (SMP w/2 CPU cores)
Locale: LANG=C, LC_CTYPE=pl_PL.UTF-8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash
Init: sysvinit (via /sbin/init)

Versions of packages libc6 depends on:
ii  libgcc1  1:5-20150226-1

Versions of packages libc6 recommends:
ii  libc6-i686  2.19-15

Versions of packages libc6 suggests:
ii  debconf [debconf-2.0]  1.5.55
ii  glibc-doc              2.19-15
ii  locales                2.19-15

-- 
Jakub Wilk
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=779392;filename=pop_fail_stack.c;msg=3">pop_fail_stack.c</a> (text/x-csrc, attachment)]</pre>

<div class="msgreceived"><hr><p>
<a name="4"></a>
<!-- command:tag -->
<!-- requester: Jakub Wilk &lt;jwilk@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1426869184 -->
<!-- new_data:
$new_data = {
              &#39;keywords&#39; =&gt; &#39;&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;keywords&#39; =&gt; &#39;security&#39;
            };
-->
<strong>Removed tag(s) security.</strong>
Request was from <code>Jakub Wilk &lt;jwilk@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Fri, 20 Mar 2015 16:33:04 GMT) (<a href="bugreport.cgi?bug=779392;msg=5">full text</a>, <a href="bugreport.cgi?bug=779392;mbox=yes;msg=5">mbox</a>, <a href="#4">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="6"></a>
<!-- command:forwarded -->
<!-- requester: Florian Weimer &lt;fweimer@redhat.com&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1487098622 -->
<!-- new_data:
$new_data = {
              &#39;forwarded&#39; =&gt; &#39;<a href="https://sourceware.org/bugzilla/show_bug.cgi?id=21163">https://sourceware.org/bugzilla/show_bug.cgi?id=21163</a>&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;forwarded&#39; =&gt; &#39;&#39;
            };
-->
<strong>Set Bug forwarded-to-address to &#39;<a href="https://sourceware.org/bugzilla/show_bug.cgi?id=21163">https://sourceware.org/bugzilla/show_bug.cgi?id=21163</a>&#39;.</strong>
Request was from <code>Florian Weimer &lt;fweimer@redhat.com&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Tue, 14 Feb 2017 18:57:02 GMT) (<a href="bugreport.cgi?bug=779392;msg=7">full text</a>, <a href="bugreport.cgi?bug=779392;mbox=yes;msg=7">mbox</a>, <a href="#6">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="8"></a>
<!-- command:tag -->
<!-- requester: Salvatore Bonaccorso &lt;carnil@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1487099344 -->
<!-- new_data:
$new_data = {
              &#39;keywords&#39; =&gt; &#39;security&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;keywords&#39; =&gt; &#39;&#39;
            };
-->
<strong>Added tag(s) security.</strong>
Request was from <code>Salvatore Bonaccorso &lt;carnil@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Tue, 14 Feb 2017 19:09:04 GMT) (<a href="bugreport.cgi?bug=779392;msg=9">full text</a>, <a href="bugreport.cgi?bug=779392;mbox=yes;msg=9">mbox</a>, <a href="#8">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="10"></a>
<!-- command:title -->
<!-- requester: Salvatore Bonaccorso &lt;carnil@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1487099346 -->
<!-- new_data:
$new_data = {
              &#39;subject&#39; =&gt; &#39;glibc: CVE-2015-8985: potential denial of service in pop_fail_stack()&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;subject&#39; =&gt; &#39;libc6: regexec.c:1401: pop_fail_stack: Assertion `num &gt;= 0\&#39; failed&#39;
            };
-->
<strong>Changed Bug title to &#39;glibc: CVE-2015-8985: potential denial of service in pop_fail_stack()&#39; from &#39;libc6: regexec.c:1401: pop_fail_stack: Assertion `num &gt;= 0&#39; failed&#39;.</strong>
Request was from <code>Salvatore Bonaccorso &lt;carnil@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Tue, 14 Feb 2017 19:09:06 GMT) (<a href="bugreport.cgi?bug=779392;msg=11">full text</a>, <a href="bugreport.cgi?bug=779392;mbox=yes;msg=11">mbox</a>, <a href="#10">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="12"></a>
<!-- command:tag -->
<!-- requester: debian-bts-link@lists.debian.org -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1530838813 -->
<!-- new_data:
$new_data = {
              &#39;keywords&#39; =&gt; &#39;security fixed-upstream&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;keywords&#39; =&gt; &#39;security&#39;
            };
-->
<strong>Added tag(s) fixed-upstream.</strong>
Request was from <code>debian-bts-link@lists.debian.org</code>
to <code>control@bugs.debian.org</code>.
 (Fri, 06 Jul 2018 01:00:13 GMT) (<a href="bugreport.cgi?bug=779392;msg=13">full text</a>, <a href="bugreport.cgi?bug=779392;mbox=yes;msg=13">mbox</a>, <a href="#12">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="14"></a>
<!-- command:fixed -->
<!-- requester: Salvatore Bonaccorso &lt;carnil@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1546780505 -->
<!-- new_data:
$new_data = {
              &#39;fixed_versions&#39; =&gt; [
                                    &#39;glibc/2.28-0experimental0&#39;
                                  ]
            };
-->
<!-- old_data:
$old_data = {
              &#39;fixed_versions&#39; =&gt; []
            };
-->
<strong>Marked as fixed in versions glibc/2.28-0experimental0.</strong>
Request was from <code>Salvatore Bonaccorso &lt;carnil@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Sun, 06 Jan 2019 13:15:05 GMT) (<a href="bugreport.cgi?bug=779392;msg=15">full text</a>, <a href="bugreport.cgi?bug=779392;mbox=yes;msg=15">mbox</a>, <a href="#14">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="16"></a>
<!-- command:done -->
<!-- requester: Salvatore Bonaccorso &lt;carnil@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1546780505 -->
<!-- new_data:
$new_data = {
              &#39;done&#39; =&gt; &#39;Salvatore Bonaccorso &lt;carnil@debian.org&gt;&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;done&#39; =&gt; &#39;&#39;
            };
-->
<strong>Marked Bug as done</strong>
Request was from <code>Salvatore Bonaccorso &lt;carnil@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Sun, 06 Jan 2019 13:15:05 GMT) (<a href="bugreport.cgi?bug=779392;msg=17">full text</a>, <a href="bugreport.cgi?bug=779392;mbox=yes;msg=17">mbox</a>, <a href="#16">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="18"></a>
<!-- request_addr: Jakub Wilk &lt;jwilk@debian.org&gt; -->
<!-- time:1546780506 -->
<strong>Notification sent</strong>
to <code>Jakub Wilk &lt;jwilk@debian.org&gt;</code>:<br>
Bug acknowledged by developer.
 (Sun, 06 Jan 2019 13:15:06 GMT) (<a href="bugreport.cgi?bug=779392;msg=19">full text</a>, <a href="bugreport.cgi?bug=779392;mbox=yes;msg=19">mbox</a>, <a href="#18">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="20"></a>
<!-- request_addr: Jakub Wilk &lt;jwilk@debian.org&gt; -->
<!-- time:1546780508 -->
<strong>Message sent on</strong>
to <code>Jakub Wilk &lt;jwilk@debian.org&gt;</code>:<br>
Bug#779392.
 (Sun, 06 Jan 2019 13:15:08 GMT) (<a href="bugreport.cgi?bug=779392;msg=21">full text</a>, <a href="bugreport.cgi?bug=779392;mbox=yes;msg=21">mbox</a>, <a href="#20">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="22"></a><a name="msg22"></a><a href="#22">Message #22</a> received at 779392-submitter@bugs.debian.org (<a href="bugreport.cgi?bug=779392;msg=22">full text</a>, <a href="bugreport.cgi?bug=779392;mbox=yes;msg=22">mbox</a>, <a href="mailto:779392@bugs.debian.org?subject=Re%3A%20closing%20779392&amp;body=On%20Sun%2C%2006%20Jan%202019%2014%3A11%3A48%20%2B0100%20Salvatore%20Bonaccorso%20%3Ccarnil%40debian.org%3E%20wrote%3A%0A%3E%20close%20779392%202.28-0experimental0%0A%3E%20thanks%0A%3E%20%0A%3E%20%0A%3E%20%0A&amp;References=%3C1546780308-1785-bts-carnil%40debian.org%3E&amp;In-Reply-To=%3C1546780308-1785-bts-carnil%40debian.org%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=carnil%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Salvatore Bonaccorso &lt;carnil@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> control@bugs.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> 779392-submitter@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> closing 779392</div>
<div class="header"><span class="headerfield">Date:</span> Sun, 06 Jan 2019 14:11:48 +0100</div>
</div>
<pre class="message">close 779392 2.28-0experimental0
thanks



</pre>

<div class="msgreceived"><hr><p>
<a name="23"></a>
<!-- command:archive -->
<!-- requester: Debbugs Internal Request &lt;owner@bugs.debian.org&gt; -->
<!-- request_addr: internal_control@bugs.debian.org -->
<!-- time:1549266725 -->
<!-- new_data:
$new_data = {};
-->
<!-- old_data:
$old_data = {};
-->
<strong>Bug archived.</strong>
Request was from <code>Debbugs Internal Request &lt;owner@bugs.debian.org&gt;</code>
to <code>internal_control@bugs.debian.org</code>.
 (Mon, 04 Feb 2019 07:52:05 GMT) (<a href="bugreport.cgi?bug=779392;msg=24">full text</a>, <a href="bugreport.cgi?bug=779392;mbox=yes;msg=24">mbox</a>, <a href="#23">link</a>).</p></p></div>

<hr>
<p class="msgreceived">Send a report that <a href="https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=779392">this bug log contains spam</a>.</p>
<hr>
<ADDRESS>Debian bug tracking system administrator &lt;<A HREF="mailto:owner@bugs.debian.org">owner@bugs.debian.org</A>&gt;.
Last modified:
<!--timestamp-->Sat Oct 30 18:31:18 2021<!--end timestamp-->; 
Machine Name:
<!--machinename-->buxtehude<!--machinename-->
<P>
<A HREF="https://www.debian.org/Bugs/">Debian Bug tracking system</A>
</p>
<p>
  Debbugs is free software and licensed under the terms of the GNU
  Public License version 2. The current version can be obtained
  from <a href="https://bugs.debian.org/debbugs-source/">https://bugs.debian.org/debbugs-source/</a>.
</p>
<p>
Copyright Â© 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.
</p>
</ADDRESS>

</body>
</html>
