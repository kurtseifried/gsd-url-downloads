<!DOCTYPE html>
<html class='v2' dir='ltr' lang='en' xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr'>
<head>
<link href='https://www.blogger.com/static/v1/widgets/1667664774-css_bundle_v2.css' rel='stylesheet' type='text/css'/>
<!-- thememod twitter card -->
<meta content='summary' name='twitter:card'/>
<meta content='@_tint0' name='twitter:site'/>
<meta content='A Saga of Code Executions on Zimbra' name='twitter:title'/>
<meta content='https://1.bp.blogspot.com/-q0RYsZOQhVw/XIjXY6D0gRI/AAAAAAAABEY/ShFcmeO1c8I1BKL4BT-POYqqVuSrBkjmgCLcBGAs/s400/ftp_patch.PNG' name='twitter:image'/>
<meta content='width=1100' name='viewport'/>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<meta content='blogger' name='generator'/>
<link href='https://blog.tint0.com/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="tint0 - Atom" href="https://blog.tint0.com/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="tint0 - RSS" href="https://blog.tint0.com/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="tint0 - Atom" href="https://www.blogger.com/feeds/3042129283045399598/posts/default" />

<link rel="alternate" type="application/atom+xml" title="tint0 - Atom" href="https://blog.tint0.com/feeds/9131331354675697613/comments/default" />
<!--[if IE]><script type="text/javascript" src="https://www.blogger.com/static/v1/jsbin/403901366-ieretrofit.js"></script>
<![endif]-->
<link href='https://1.bp.blogspot.com/-q0RYsZOQhVw/XIjXY6D0gRI/AAAAAAAABEY/ShFcmeO1c8I1BKL4BT-POYqqVuSrBkjmgCLcBGAs/s400/ftp_patch.PNG' rel='image_src'/>
<meta content='https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html' property='og:url'/>
<meta content='A Saga of Code Executions on Zimbra' property='og:title'/>
<meta content='Zimbra is well known for its signature email product, Zimbra Collaboration Suite. Putting client-side vulnerabilities aside, Zimbra seems to...' property='og:description'/>
<meta content='https://1.bp.blogspot.com/-q0RYsZOQhVw/XIjXY6D0gRI/AAAAAAAABEY/ShFcmeO1c8I1BKL4BT-POYqqVuSrBkjmgCLcBGAs/w1200-h630-p-k-no-nu/ftp_patch.PNG' property='og:image'/>
<!--[if IE]> <script> (function() { var html5 = ("abbr,article,aside,audio,canvas,datalist,details," + "figure,footer,header,hgroup,mark,menu,meter,nav,output," + "progress,section,time,video").split(','); for (var i = 0; i < html5.length; i++) { document.createElement(html5[i]); } try { document.execCommand('BackgroundImageCache', false, true); } catch(e) {} })(); </script> <![endif]-->
<title>tint0: A Saga of Code Executions on Zimbra</title>
<style id='page-skin-1' type='text/css'><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Simple
Designer: Blogger
URL:      www.blogger.com
----------------------------------------------- */
/* Variable definitions
====================
<Variable name="keycolor" description="Main Color" type="color" default="#66bbdd"/>
<Group description="Page Text" selector="body">
<Variable name="body.font" description="Font" type="font"
default="normal normal 12px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="body.text.color" description="Text Color" type="color" default="#222222"/>
</Group>
<Group description="Backgrounds" selector=".body-fauxcolumns-outer">
<Variable name="body.background.color" description="Outer Background" type="color" default="#66bbdd"/>
<Variable name="content.background.color" description="Main Background" type="color" default="#ffffff"/>
<Variable name="header.background.color" description="Header Background" type="color" default="transparent"/>
</Group>
<Group description="Links" selector=".main-outer">
<Variable name="link.color" description="Link Color" type="color" default="#2288bb"/>
<Variable name="link.visited.color" description="Visited Color" type="color" default="#888888"/>
<Variable name="link.hover.color" description="Hover Color" type="color" default="#33aaff"/>
</Group>
<Group description="Blog Title" selector=".header h1">
<Variable name="header.font" description="Font" type="font"
default="normal normal 60px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="header.text.color" description="Title Color" type="color" default="#3399bb" />
</Group>
<Group description="Blog Description" selector=".header .description">
<Variable name="description.text.color" description="Description Color" type="color"
default="#777777" />
</Group>
<Group description="Tabs Text" selector=".tabs-inner .widget li a">
<Variable name="tabs.font" description="Font" type="font"
default="normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="tabs.text.color" description="Text Color" type="color" default="#999999"/>
<Variable name="tabs.selected.text.color" description="Selected Color" type="color" default="#000000"/>
</Group>
<Group description="Tabs Background" selector=".tabs-outer .PageList">
<Variable name="tabs.background.color" description="Background Color" type="color" default="#f5f5f5"/>
<Variable name="tabs.selected.background.color" description="Selected Color" type="color" default="#eeeeee"/>
</Group>
<Group description="Post Title" selector="h3.post-title, .comments h4">
<Variable name="post.title.font" description="Font" type="font"
default="normal normal 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
</Group>
<Group description="Date Header" selector=".date-header">
<Variable name="date.header.color" description="Text Color" type="color"
default="#666666"/>
<Variable name="date.header.background.color" description="Background Color" type="color"
default="transparent"/>
<Variable name="date.header.font" description="Text Font" type="font"
default="normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="date.header.padding" description="Date Header Padding" type="string" default="inherit"/>
<Variable name="date.header.letterspacing" description="Date Header Letter Spacing" type="string" default="inherit"/>
<Variable name="date.header.margin" description="Date Header Margin" type="string" default="inherit"/>
</Group>
<Group description="Post Footer" selector=".post-footer">
<Variable name="post.footer.text.color" description="Text Color" type="color" default="#666666"/>
<Variable name="post.footer.background.color" description="Background Color" type="color"
default="#f9f9f9"/>
<Variable name="post.footer.border.color" description="Shadow Color" type="color" default="#eeeeee"/>
</Group>
<Group description="Gadgets" selector="h2">
<Variable name="widget.title.font" description="Title Font" type="font"
default="normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="widget.title.text.color" description="Title Color" type="color" default="#000000"/>
<Variable name="widget.alternate.text.color" description="Alternate Color" type="color" default="#999999"/>
</Group>
<Group description="Images" selector=".main-inner">
<Variable name="image.background.color" description="Background Color" type="color" default="#ffffff"/>
<Variable name="image.border.color" description="Border Color" type="color" default="#eeeeee"/>
<Variable name="image.text.color" description="Caption Text Color" type="color" default="#666666"/>
</Group>
<Group description="Accents" selector=".content-inner">
<Variable name="body.rule.color" description="Separator Line Color" type="color" default="#eeeeee"/>
<Variable name="tabs.border.color" description="Tabs Border Color" type="color" default="transparent"/>
</Group>
<Variable name="body.background" description="Body Background" type="background"
color="#ffffff" default="$(color) none repeat scroll top left"/>
<Variable name="body.background.override" description="Body Background Override" type="string" default=""/>
<Variable name="body.background.gradient.cap" description="Body Gradient Cap" type="url"
default="url(https://resources.blogblog.com/blogblog/data/1kt/simple/gradients_light.png)"/>
<Variable name="body.background.gradient.tile" description="Body Gradient Tile" type="url"
default="url(https://resources.blogblog.com/blogblog/data/1kt/simple/body_gradient_tile_light.png)"/>
<Variable name="content.background.color.selector" description="Content Background Color Selector" type="string" default=".content-inner"/>
<Variable name="content.padding" description="Content Padding" type="length" default="10px" min="0" max="100px"/>
<Variable name="content.padding.horizontal" description="Content Horizontal Padding" type="length" default="10px" min="0" max="100px"/>
<Variable name="content.shadow.spread" description="Content Shadow Spread" type="length" default="40px" min="0" max="100px"/>
<Variable name="content.shadow.spread.webkit" description="Content Shadow Spread (WebKit)" type="length" default="5px" min="0" max="100px"/>
<Variable name="content.shadow.spread.ie" description="Content Shadow Spread (IE)" type="length" default="10px" min="0" max="100px"/>
<Variable name="main.border.width" description="Main Border Width" type="length" default="0" min="0" max="10px"/>
<Variable name="header.background.gradient" description="Header Gradient" type="url" default="none"/>
<Variable name="header.shadow.offset.left" description="Header Shadow Offset Left" type="length" default="-1px" min="-50px" max="50px"/>
<Variable name="header.shadow.offset.top" description="Header Shadow Offset Top" type="length" default="-1px" min="-50px" max="50px"/>
<Variable name="header.shadow.spread" description="Header Shadow Spread" type="length" default="1px" min="0" max="100px"/>
<Variable name="header.padding" description="Header Padding" type="length" default="30px" min="0" max="100px"/>
<Variable name="header.border.size" description="Header Border Size" type="length" default="1px" min="0" max="10px"/>
<Variable name="header.bottom.border.size" description="Header Bottom Border Size" type="length" default="1px" min="0" max="10px"/>
<Variable name="header.border.horizontalsize" description="Header Horizontal Border Size" type="length" default="0" min="0" max="10px"/>
<Variable name="description.text.size" description="Description Text Size" type="string" default="140%"/>
<Variable name="tabs.margin.top" description="Tabs Margin Top" type="length" default="0" min="0" max="100px"/>
<Variable name="tabs.margin.side" description="Tabs Side Margin" type="length" default="30px" min="0" max="100px"/>
<Variable name="tabs.background.gradient" description="Tabs Background Gradient" type="url"
default="url(https://resources.blogblog.com/blogblog/data/1kt/simple/gradients_light.png)"/>
<Variable name="tabs.border.width" description="Tabs Border Width" type="length" default="1px" min="0" max="10px"/>
<Variable name="tabs.bevel.border.width" description="Tabs Bevel Border Width" type="length" default="1px" min="0" max="10px"/>
<Variable name="post.margin.bottom" description="Post Bottom Margin" type="length" default="25px" min="0" max="100px"/>
<Variable name="image.border.small.size" description="Image Border Small Size" type="length" default="2px" min="0" max="10px"/>
<Variable name="image.border.large.size" description="Image Border Large Size" type="length" default="5px" min="0" max="10px"/>
<Variable name="page.width.selector" description="Page Width Selector" type="string" default=".region-inner"/>
<Variable name="page.width" description="Page Width" type="string" default="auto"/>
<Variable name="main.section.margin" description="Main Section Margin" type="length" default="15px" min="0" max="100px"/>
<Variable name="main.padding" description="Main Padding" type="length" default="15px" min="0" max="100px"/>
<Variable name="main.padding.top" description="Main Padding Top" type="length" default="30px" min="0" max="100px"/>
<Variable name="main.padding.bottom" description="Main Padding Bottom" type="length" default="30px" min="0" max="100px"/>
<Variable name="paging.background"
color="#ffffff"
description="Background of blog paging area" type="background"
default="transparent none no-repeat scroll top center"/>
<Variable name="footer.bevel" description="Bevel border length of footer" type="length" default="0" min="0" max="10px"/>
<Variable name="mobile.background.overlay" description="Mobile Background Overlay" type="string"
default="transparent none repeat scroll top left"/>
<Variable name="mobile.background.size" description="Mobile Background Size" type="string" default="auto"/>
<Variable name="mobile.button.color" description="Mobile Button Color" type="color" default="#ffffff" />
<Variable name="startSide" description="Side where text starts in blog language" type="automatic" default="left"/>
<Variable name="endSide" description="Side where text ends in blog language" type="automatic" default="right"/>
*/
/* Content
----------------------------------------------- */
body {
font: normal normal 12px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #666666;
background: #ffffff none repeat scroll top left;
padding: 0 0 0 0;
}
html body .region-inner {
min-width: 0;
max-width: 100%;
width: auto;
}
h2 {
font-size: 22px;
}
/*thememod pre*/
pre {
overflow: auto;
}
a:link {
text-decoration:none;
color: #6ea1bb;
}
a:visited {
text-decoration:none;
color: #9E9E9E;
}
a:hover {
text-decoration:underline;
color: #33aaff;
}
.body-fauxcolumn-outer .fauxcolumn-inner {
background: transparent none repeat scroll top left;
_background-image: none;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 400px;
width: 100%;
}
.body-fauxcolumn-outer .cap-top .cap-left {
width: 100%;
background: transparent none repeat-x scroll top left;
_background-image: none;
}
.content-outer {
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .15);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .15);
-goog-ms-box-shadow: 0 0 0 #333333;
box-shadow: 0 0 0 rgba(0, 0, 0, .15);
margin-bottom: 1px;
}
.content-inner {
padding: 10px 40px;
}
.content-inner {
background-color: #ffffff;
}
/* Header
----------------------------------------------- */
.header-outer {
background: transparent none repeat-x scroll 0 -400px;
_background-image: none;
}
.Header h1 {
font: normal normal 25px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #999999;
text-shadow: 0 0 0 rgba(0, 0, 0, .2);
}
.Header h1 a {
color: #999999;
}
.Header .description {
font-size: 18px;
color: #000000;
}
.header-inner .Header .titlewrapper {
padding: 22px 0;
}
.header-inner .Header .descriptionwrapper {
padding: 0 0;
}
/* Tabs
----------------------------------------------- */
.tabs-inner .section:first-child {
border-top: 0 solid #dddddd;
}
.tabs-inner .section:first-child ul {
margin-top: -1px;
border-top: 1px solid #dddddd;
border-left: 1px solid #dddddd;
border-right: 1px solid #dddddd;
}
.tabs-inner .widget ul {
background: transparent none repeat-x scroll 0 -800px;
_background-image: none;
border-bottom: 1px solid #dddddd;
margin-top: 0;
margin-left: -30px;
margin-right: -30px;
}
.tabs-inner .widget li a {
display: inline-block;
padding: .6em 1em;
font: normal normal 12px 'Trebuchet MS', Trebuchet, Verdana, sans-serif;
color: #000000;
border-left: 1px solid #ffffff;
border-right: 1px solid #dddddd;
}
.tabs-inner .widget li:first-child a {
border-left: none;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
color: #000000;
background-color: #eeeeee;
text-decoration: none;
}
/* Columns
----------------------------------------------- */
.main-outer {
border-top: 0 solid transparent;
}
.fauxcolumn-left-outer .fauxcolumn-inner {
border-right: 1px solid transparent;
}
.fauxcolumn-right-outer .fauxcolumn-inner {
border-left: 1px solid transparent;
}
/* Headings
----------------------------------------------- */
div.widget > h2,
div.widget h2.title {
margin: 0 0 1em 0;
font: normal bold 11px 'Trebuchet MS',Trebuchet,Verdana,sans-serif;
color: #000000;
}
/* Widgets
----------------------------------------------- */
.widget .zippy {
color: #999999;
text-shadow: 2px 2px 1px rgba(0, 0, 0, .1);
}
.widget .popular-posts ul {
list-style: none;
}
/* Posts
----------------------------------------------- */
h2.date-header {
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
}
.date-header span {
background-color: #bbbbbb;
color: #ffffff;
padding: 0.4em;
letter-spacing: 3px;
margin: inherit;
}
.main-inner {
padding-top: 35px;
padding-bottom: 65px;
}
.main-inner .column-center-inner {
padding: 0 0;
}
.main-inner .column-center-inner .section {
margin: 0 1em;
}
.post {
margin: 0 0 45px 0;
}
h3.post-title, .comments h4 {
font: normal normal 20px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
margin: .75em 0 0;
}
.post-body {
font-size: 110%;
line-height: 1.4;
position: relative;
}
.post-body img, .post-body .tr-caption-container, .Profile img, .Image img,
.BlogList .item-thumbnail img {
padding: 2px;
background: #ffffff;
border: 1px solid #eeeeee;
-moz-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
-webkit-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
}
.post-body img, .post-body .tr-caption-container {
padding: 5px;
}
.post-body .tr-caption-container {
color: #666666;
}
.post-body .tr-caption-container img {
padding: 0;
background: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
box-shadow: 0 0 0 rgba(0, 0, 0, .1);
}
.post-header {
margin: 0 0 1.5em;
line-height: 1.6;
font-size: 90%;
}
.post-footer {
margin: 20px -2px 0;
padding: 5px 10px;
color: #666666;
background-color: #eeeeee;
border-bottom: 1px solid #eeeeee;
line-height: 1.6;
font-size: 90%;
}
#comments .comment-author {
padding-top: 1.5em;
border-top: 1px solid transparent;
background-position: 0 1.5em;
}
#comments .comment-author:first-child {
padding-top: 0;
border-top: none;
}
.avatar-image-container {
margin: .2em 0 0;
}
#comments .avatar-image-container img {
border: 1px solid #eeeeee;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
}
.comments .comment-thread.inline-thread {
background-color: #eeeeee;
}
.comments .continue {
border-top: 2px solid #999999;
}
/* Accents
---------------------------------------------- */
.section-columns td.columns-cell {
border-left: 1px solid transparent;
}
.blog-pager {
background: transparent url(https://resources.blogblog.com/blogblog/data/1kt/simple/paging_dot.png) repeat-x scroll top center;
}
.blog-pager-older-link, .home-link,
.blog-pager-newer-link {
background-color: #ffffff;
padding: 5px;
}
.footer-outer {
border-top: 1px dashed #bbbbbb;
}
/* Mobile
----------------------------------------------- */
body.mobile  {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
.mobile .body-fauxcolumn-outer .cap-top {
background-size: 100% auto;
}
.mobile .content-outer {
-webkit-box-shadow: 0 0 3px rgba(0, 0, 0, .15);
box-shadow: 0 0 3px rgba(0, 0, 0, .15);
}
.mobile .tabs-inner .widget ul {
margin-left: 0;
margin-right: 0;
}
.mobile .post {
margin: 0;
}
.mobile .main-inner .column-center-inner .section {
margin: 0;
}
.mobile .date-header span {
padding: 0.1em 10px;
margin: 0 -10px;
}
.mobile h3.post-title {
margin: 0;
}
.mobile .blog-pager {
background: transparent none no-repeat scroll top center;
}
.mobile .footer-outer {
border-top: none;
}
.mobile .main-inner, .mobile .footer-inner {
background-color: #ffffff;
}
.mobile-index-contents {
color: #666666;
}
.mobile-link-button {
background-color: #6ea1bb;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .section:first-child {
border-top: none;
}
.mobile .tabs-inner .PageList .widget-content {
background-color: #eeeeee;
color: #000000;
border-top: 1px solid #dddddd;
border-bottom: 1px solid #dddddd;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #dddddd;
}

--></style>
<style id='template-skin-1' type='text/css'><!--
body {
min-width: 1050px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 1050px;
max-width: 1050px;
_width: 1050px;
}
.main-inner .columns {
padding-left: 0;
padding-right: 260px;
}
.main-inner .fauxcolumn-center-outer {
left: 0;
right: 260px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0") -
parseInt("260px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0;
}
.main-inner .fauxcolumn-right-outer {
width: 260px;
}
.main-inner .column-left-outer {
width: 0;
right: 100%;
margin-left: -0;
}
.main-inner .column-right-outer {
width: 260px;
margin-right: -260px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
body#layout div.add_widget {
padding: 8px;
}
body#layout div.add_widget a {
margin-left: 32px;
}
--></style>
<script type='text/javascript'>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-209049493-1', 'auto', 'blogger');
      ga('blogger.send', 'pageview');
    </script>
<link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=3042129283045399598&amp;zx=57f019df-3afd-46e4-a856-168d456a7233' media='none' onload='if(media!=&#39;all&#39;)media=&#39;all&#39;' rel='stylesheet'/><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=3042129283045399598&amp;zx=57f019df-3afd-46e4-a856-168d456a7233' rel='stylesheet'/></noscript>
<meta name='google-adsense-platform-account' content='ca-host-pub-1556223355139109'/>
<meta name='google-adsense-platform-domain' content='blogspot.com'/>

</head>
<body class='loading'>
<div class='navbar section' id='navbar' name='Navbar'><div class='widget Navbar' data-version='1' id='Navbar1'><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://www.blogger.com/navbar.g?targetBlogID\x3d3042129283045399598\x26blogName\x3dtint0\x26publishMode\x3dPUBLISH_MODE_HOSTED\x26navbarType\x3dLIGHT\x26layoutType\x3dLAYOUTS\x26searchRoot\x3dhttps://blog.tint0.com/search\x26blogLocale\x3den\x26v\x3d2\x26homepageUrl\x3dhttps://blog.tint0.com/\x26targetPostID\x3d9131331354675697613\x26blogPostOrPageUrl\x3dhttps://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html\x26vt\x3d6761148873366869525',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe"
          });
        }
      });
    </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div class='body-fauxcolumns'>
<div class='fauxcolumn-outer body-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content'>
<div class='content-fauxcolumns'>
<div class='fauxcolumn-outer content-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content-outer'>
<div class='content-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left content-fauxborder-left'>
<div class='fauxborder-right content-fauxborder-right'></div>
<div class='content-inner'>
<header>
<div class='header-outer'>
<div class='header-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left header-fauxborder-left'>
<div class='fauxborder-right header-fauxborder-right'></div>
<div class='region-inner header-inner'>
<div class='header section' id='header' name='Header'><div class='widget Header' data-version='1' id='Header1'>
<div id='header-inner'>
<div class='titlewrapper'>
<h1 class='title'>
<a href='https://blog.tint0.com/'>
tint0
</a>
</h1>
</div>
<div class='descriptionwrapper'>
<p class='description'><span>
</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class='header-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</header>
<div class='tabs-outer'>
<div class='tabs-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left tabs-fauxborder-left'>
<div class='fauxborder-right tabs-fauxborder-right'></div>
<div class='region-inner tabs-inner'>
<div class='tabs no-items section' id='crosscol' name='Cross-Column'></div>
<div class='tabs no-items section' id='crosscol-overflow' name='Cross-Column 2'></div>
</div>
</div>
<div class='tabs-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='main-outer'>
<div class='main-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left main-fauxborder-left'>
<div class='fauxborder-right main-fauxborder-right'></div>
<div class='region-inner main-inner'>
<div class='columns fauxcolumns'>
<div class='fauxcolumn-outer fauxcolumn-center-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-left-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-right-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class='columns-inner'>
<div class='column-center-outer'>
<div class='column-center-inner'>
<div class='main section' id='main' name='Main'><div class='widget Blog' data-version='1' id='Blog1'>
<div class='blog-posts hfeed'>

          <div class="date-outer">
        
<h2 class='date-header'><span>March 13, 2019</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry uncustomized-post-template' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'>
<meta content='https://1.bp.blogspot.com/-q0RYsZOQhVw/XIjXY6D0gRI/AAAAAAAABEY/ShFcmeO1c8I1BKL4BT-POYqqVuSrBkjmgCLcBGAs/s400/ftp_patch.PNG' itemprop='image_url'/>
<meta content='3042129283045399598' itemprop='blogId'/>
<meta content='9131331354675697613' itemprop='postId'/>
<a name='9131331354675697613'></a>
<h3 class='post-title entry-title' itemprop='name'>
A Saga of Code Executions on Zimbra
</h3>
<div class='post-header'>
<div class='post-header-line-1'></div>
</div>
<div class='post-body entry-content' id='post-body-9131331354675697613' itemprop='description articleBody'>
Zimbra is well known for its signature email product, Zimbra Collaboration Suite. Putting client-side vulnerabilities aside, Zimbra seems to have very little <a href="https://wiki.zimbra.com/wiki/Zimbra_Security_Advisories" rel="nofollow" target="_blank">security history</a> in the past. Its last critical bug was a Local File Disclosure back in 2013.<br />
<br />
Recently with several new findings, it has been known that at least one potential Remote Code Execution exists in all versions of Zimbra. Specifically,<br />
<br />
- Pre-Auth RCE on Zimbra &lt;8.5.<br />
<br />
- Pre-Auth RCE on Zimbra from 8.5 to 8.7.11.<br />
<br />
- Auth'd RCE on Zimbra 8.8.11 and below with an additional condition that Zimbra uses Memcached. More on that in <a href="#memcached_condition">the next section</a>.<br />
<br />
<h2>
Breaking Zimbra part 1</h2>
<div>
<br /></div>
<h3>
1. The XXE cavalry - CVE-2016-9924, CVE-2018-20160, CVE-2019-9670</h3>
Zimbra uses a large amount of XML handling for both its internal and external operations. With great XML usage comes great XXE vulnerabilities.<br />
<br />
Back in 2016, another researcher discovered CVE-2016-9924 with the bug locating in SoapEngine.chooseFaultProtocolFromBadXml(), which happens on the parsing of invalid XML requests. This code is used in all Zimbra instances version below 8.5. Note however, as there's no way to extract the output to the HTTP response, an out-of-band extraction method is required in exploiting it.<br />
<br />
For more recent versions, CVE-2019-9670 works flawlessly where the XXE lies in the handling of Autodiscover requests. This can be applied on Zimbra from 8.5 to 8.7.11. And for the sake of completeness, CVE-2018-20160 is an XXE in the handling of XMPP protocol and an additional bug along CVE-2019-9670 is a prevention bypass in the sanitizing of XHTML documents which also leads to XXE, however they both require some additional conditions to trigger. These all allow direct file extraction through response.<br />
<br />
It's worth to mention that exploiting out-of-band XXE on recent Java just got a lot harder due to a patch in the core FtpClient which makes it reject all FTP commands containing newline. This doesn't affect the exploits for the vulnerabilities mentioned above, but it did make some of my previous efforts to chain XXE with other bugs in vain.<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://1.bp.blogspot.com/-q0RYsZOQhVw/XIjXY6D0gRI/AAAAAAAABEY/ShFcmeO1c8I1BKL4BT-POYqqVuSrBkjmgCLcBGAs/s1600/ftp_patch.PNG" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="479" data-original-width="557" height="343" src="https://1.bp.blogspot.com/-q0RYsZOQhVw/XIjXY6D0gRI/AAAAAAAABEY/ShFcmeO1c8I1BKL4BT-POYqqVuSrBkjmgCLcBGAs/s400/ftp_patch.PNG" width="400" /></a></div>
<div style="text-align: center;">
<i>sun.net.ftp.impl.FtpClient</i></div>
<br />
On installation, Zimbra sets up a global admin for its internal SOAP communications, with the username 'zimbra' and a randomly generated password. These information are always stored in a local file named localconfig.xml. As such, a file-read vulnerability like XXE could potentially be catastrophic to Zimbra, since it allows an attacker to acquire the login information of a user with all the admin rights. This has been demonstrated as the case in a <a href="https://www.exploit-db.com/exploits/30472" rel="nofollow" target="_blank">CVE-2013-7091 LFI exploit</a> where under certain conditions, one could use such credentials to gain RCE.<br />
<br />
However things have never been that easy. Zimbra manages user privileges via tokens, and it sets up an application model such that an admin token can only be granted to requests coming to the admin port, which by default is 7071. The aforementioned LFI exploit conveniently assumes we already have access to that port. But how often do you see the weirdo 7071 open to public?<br />
<br />
<h3>
2. SSRF to the rescue - CVE-2019-9621</h3>
If you can't access the port from public, let the application do it for you. The code at ProxyServlet.doProxy() does exactly what its name says, it proxies a request to another designated location. What's more, this servlet is available on the normal webapp and therefore accessible from public. Sweet! However the code has an additional protection, it checks whether the proxied target matches a set of predefined whitelisted domains. That is, unless the request is from an admin. Sounds right, an admin should be able to do what he wants.<br />
<br />
(Un)Fortunately, the admin checks are flawed. First thing it checks is whether the request comes from port 7071. However it uses <a href="https://docs.oracle.com/javaee/6/api/javax/servlet/ServletRequest.html#getServerPort()" rel="nofollow" target="_blank">ServletRequest.getServerPort()</a> to fetch the incoming port. This method returns a tainted input controllable by an attacker, which is the part after ':' in the Host header. What's more, after that the check for the admin token happens only if it is fetched from a parameter, meanwhile we can totally send a token via cookie! In short, if we send a request with 'foo:7071' Host header and a valid token in cookie, we can proxy a request to arbitrary targets that is otherwise only accessible to admins.<br />
<br />
<h3>
3. Pre-Auth RCE from public port</h3>
ProxyServlet still needs a valid token though, so how does this fit in a preauth RCE chain? Turns out Zimbra has a 'hidden' feature that can help us generate a normal user token under the special global 'zimbra' account. When we modify an ordinary SOAP AuthRequest which looks like this:<br />
<pre>...&lt;account by="<i>name</i>">an&lt;/account>...</pre>
into this:<br />
<pre>...&lt;account by="<i>adminName</i>">zimbra&lt;/account>...</pre>
Zimbra will then lookup all the admin accounts and proceed to check the password. This is actually quite surprising because Zimbra admins and users naturally reside in two different LDAP branches. A normal AuthRequest should only touch the normal user branch, never the other. If the application wants a token for an admin, it already has port 7071 for that.<br />
<br />
Note that while this little trick could give us a token for the 'zimbra' user, this token doesn't have any of the admin flag in it as it's not coming from port 7071. This is when ProxyServlet jumps in, which will help us to proxy another admin AuthRequest to port 7071 and obtain a global admin token.<br />
<br />
Now that we've got everything we need. The flow is to read the config file via XXE, generate a low-priv token through a normal AuthRequest, proxy an admin AuthRequest to the local admin port via ProxyServlet and finally, use the global admin token to upload a webshell via the ClientUploader extension.<br />
<br />
<h2>
Breaking Zimbra part 2</h2>
<div>
<br /></div>
Zimbra has its own implementation of IMAP protocol, where it keeps a cache of the recently logged-in mailbox folders so that it doesn't have to load all the metadata from scratch next time. Zimbra serializes a user's mailbox folders to the cache on logging out and deserializes it when the same user logs in again.<br />
<br />
It has three ways to maintain a cache: Memcached(network-based input), EhCache(memory-based) and file-based. If one fails, it tries the next in list. Of all of those, we can only hope to manipulate Memcached, and this is the condition of the exploit: Zimbra has to use Memcached as its caching mechanism. Even though Memcached is prioritized over the others, (un)fortunately on a single-server instance, the LDAP key zimbraMemcachedClientServerList isn't auto-populated, so Zimbra wouldn't know where the service is and will fail over to Ehcache. This is probably a bug in Zimbra itself, as Memcached service is up and running by default and that way it wouldn't have any data in it. On a multi-server install however, setting this key is expected as only Memcached can work accross many servers.<br />
<br />
<div id="memcached_condition">
To check whether your Zimbra install is vulnerable, invoke this command on <i>every</i>&nbsp;node in the cluster and check if it returns a value:<br />
<pre>$ zmprov gs `zmhostname` zimbraMemcachedClientServerList</pre>
</div>
<br />
This was assigned CVE-2019-6980. The deserialization process happens at ImapMemcachedSerializer.deserialize() and triggers on ImapHandler.doSELECT() i.e. when a user invoking an IMAP SELECT command. The IMAP port in most cases is publicly accessible, so we can safely assume the trigger of this exploit.<br />
<br />
To bring this to RCE, one still needs to find a suitable gadget to form a chain. The twist is, none of the current public chains (ysoserial) works on Zimbra.<br />
<br />
<h3>
1. Making of a gadget</h3>
Of all the gadgets available, <a href="https://github.com/frohoff/ysoserial/blob/master/src/main/java/ysoserial/payloads/MozillaRhino1.java" rel="nofollow" target="_blank">MozillaRhino1 </a>particularly stands out as all classes in the chain are available on Zimbra's classpath. This chain is based on Rhino library version 1.7R2. Zimbra uses the lib yuicompressor version 2.4.2 for js compression, and yuicompressor is bundled with Rhino 1.6R7. The unfortunate thing is there's an internal bug in 1.6R7 that would break the MozillaRhino1 chain before it ever reaches code execution, so we're out of luck. The good thing is, thanks to the effort in attempting to get the original chain to work and to the blog post detailing the MozillaRhino1 chain&nbsp;<a href="#href1">[1]</a>, we learnt a lot about Rhino's internals and on our way to pop another gadget.<br />
<br />
There are two main points. First, the class NativeJavaObject on deserialization will store all members of an object's class. Members refer to all elements that define a class such as variables and methods. In Rhino context, it also detects when there's a getter or setter member and if so, it declares and includes the corresponding bean as an additonal member of this class. Second, a call to NativeJavaObject.get() will search those members for a matching bean name and if one is found, invoke that bean's getter. These match the nature of one of the native 'gadget helpers' - TemplatesImpl.getOutputProperties(). Essentially if we can pass in the name 'outputProperties' in NativeJavaObject.get(), Rhino will invoke TemplatesImpl.getOutputProperties() which will eventually lead to the construction of a malicious class from our predefined bytecodes. Searching for a place that we can control the passed-in member name leads to the discovery of JavaAdapter.getObjectFunctionNames() (Thanks to the valuable help from <a href="https://twitter.com/matthias_kaiser" rel="nofollow" target="_blank">@matthias_kaiser</a>) and it's directly accessible from NativeJavaObject.readObject().<br />
<br />
The chain is now available in ysoserial's payload storage <a href="https://github.com/frohoff/ysoserial/blob/master/src/main/java/ysoserial/payloads/MozillaRhino2.java" target="_blank">under the name MozillaRhino2</a>. It works all the way to the latest version (with some tweaks) and has some additional improvement over MozillaRhino1. One interesting thing I found while reading Matt's blog post is that OpenJDK 1.7.x always bundles with rhino as its scripting engine, which essentially means that these rhino gadgets may very well work natively on OpenJDK7 and below.<br />
<br />
This discovery escalates the bug from a Memcached Injection into a Code Execution. To exploit it, query into the Memcached service, pop out any 'zmImap' key, replace its value with the serialized object from ysoserial and next time the corresponding user logins via IMAP, the deserialization will trigger.<br />
<br />
<h3>
2. Smuggling from HTTP to Memcached</h3>
RCE from port 11211 sounds fun, but less so practical. So again, we turn to SSRF for help. The idea is to use the HTTP request from SSRF to inject our defined data in Memcached. To accomplish this, first we need to control a field in the HTTP request that allows the injection of newlines (CRLF). This is because a CRLF in Memcached will denote the end of a command and allow us to start a new arbitrary command after that. Second, since we're pushing raw objects into Memcached, our controlled input also needs to be able to carry binary data.<br />
<br />
Zimbra has quite a few SSRFs in itself, however there's only one place that suffices both conditions, and it happens to be the all-powerful ProxyServlet earlier.<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://4.bp.blogspot.com/-dncMTzlrfZE/XIjqNL6qZMI/AAAAAAAABFU/GPELZeoauE4T4yfDZFvzwO0yh6-udesXACEwYBhgL/s1600/memcached_stored.PNG" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="748" data-original-width="607" height="400" src="https://4.bp.blogspot.com/-dncMTzlrfZE/XIjqNL6qZMI/AAAAAAAABFU/GPELZeoauE4T4yfDZFvzwO0yh6-udesXACEwYBhgL/s400/memcached_stored.PNG" width="323" /></a></div>
<div class="separator" style="clear: both; text-align: center;">
</div>
For a successful smuggle from HTTP to Memcached protocol, you should see something like above under the hood. It has exactly 6 ERROR and 1 STORED, correlating to 6 lines of HTTP headers and our payload, which also means our payload was successfully injected.<br />
<br />
<h3>
3. RCE from public port</h3>
That said, things are different when we use SSRF to inject to Memcached. In this situation we could only inject data into the cache, not pop data out because HTTP protocol cannot parse Memcached response. So we have no idea what our targeted Memcached entry's key looks like, and we need to know the exact key to be able replace its value with our malicious payload.<br />
<br />
Fortunately, the Memcached key for Zimbra Imap follows a structure that we can construct ourselves. It follows the pattern <br />
<pre>zmImap:&lt;accountId&gt;:&lt;folderNo&gt;:&lt;modseq&gt;:&lt;uidvalidity&gt;</pre>
with:<br />
- accountId fetched from hex-decoding any login token<br />
- folderNo the constant '2' if we target the user's Inbox folder<br />
- modseq and uidvalidity obtained via IMAP as shown below<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://1.bp.blogspot.com/-kKcnAMw2ULI/XIjoPaHiQeI/AAAAAAAABE0/xnhRrxyWDDoBT0IdJGzCAmMG9q_WwZN0ACLcBGAs/s1600/memcached_key_modseq.PNG" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="221" data-original-width="449" height="196" src="https://1.bp.blogspot.com/-kKcnAMw2ULI/XIjoPaHiQeI/AAAAAAAABE0/xnhRrxyWDDoBT0IdJGzCAmMG9q_WwZN0ACLcBGAs/s400/memcached_key_modseq.PNG" width="400" /></a></div>
<br />
Now we have everything we need. Putting it together, the chain would be as follows:<br />
- Get a user credentials<br />
- Construct a Memcached key for that user following the above instructions<br />
- Generate a ysoserial payload from the gadget MozillaRhino2, use it as the Memcached entry value.<br />
- Inject the payload to Memcached via the SSRF. In the end, our payload should look like:<br />
<pre>"set zmImap:61e0594d-dda9-4274-87d8-a2912470a35e:2:162:1 2048 3600 &lt;size_of_object&gt;" + "\r\n" + &lt;object&gt; + "\r\n"</pre>
- Login again via IMAP. Upon selecting the Inbox folder, the payload will get deserialized, followed by the RCE gadget.<br />
<br />
<h2>
The patches</h2>
<br />
Zimbra issued quite a number of patches, of which the most important are to fix XXEs and arbitrary deserialization. However the fix is only available for 8.7.11 and 8.8.x. If you happen to use an earlier version of Zimbra, consider upgrading to one of <a href="https://wiki.zimbra.com/wiki/Zimbra_Releases" rel="nofollow" target="_blank">their supported version</a>.<br />
<br />
As a workaround, blocking public requests going to '/service/proxy*' would most likely break the RCE chains. Unfortunately there's none that I can think of that could block all the XXEs without also breaking some of Zimbra features.<br />
<br />
Edit 30/04: Including a more specific workaround for the Autodiscover XXE and ProxyServlet SSRF which seem to be actively exploited. Locate {zimbra_home}/mailboxd/etc/service.web.xml.in, find the servlet tags named ProxyServlet and AutoDiscoverServlet, remove %%zimbraMailPort%% and %%zimbraMailSSLPort%% in both allowed.ports param and restart Zimbra. This would prevent public access to the affected components. Other than that, <a href="https://forums.zimbra.org/viewtopic.php?f=15&amp;t=65932" rel="nofollow" target="_blank">this thread</a> provides some useful information suggested by savvy Zimbra user on how to clean an infected instance.<br />
<br />
<div>
<hr />
<a id="href1">[1]</a> <a href="https://codewhitesec.blogspot.com/2016/05/return-of-rhino-old-gadget-revisited.html" target="_blank"><i>https://codewhitesec.blogspot.com/2016/05/return-of-rhino-old-gadget-revisited.html</i></a></div>
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'>
<span class='post-author vcard'>
</span>
<span class='post-timestamp'>
at
<meta content='https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html' itemprop='url'/>
<a class='timestamp-link' href='https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2019-03-13T03:42:00-07:00'>March 13, 2019</abbr></a>
</span>
<span class='post-comment-link'>
</span>
<span class='post-icons'>
</span>
<div class='post-share-buttons goog-inline-block'>
<a class='goog-inline-block share-button sb-email' href='https://www.blogger.com/share-post.g?blogID=3042129283045399598&postID=9131331354675697613&target=email' target='_blank' title='Email This'><span class='share-button-link-text'>Email This</span></a><a class='goog-inline-block share-button sb-blog' href='https://www.blogger.com/share-post.g?blogID=3042129283045399598&postID=9131331354675697613&target=blog' onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target='_blank' title='BlogThis!'><span class='share-button-link-text'>BlogThis!</span></a><a class='goog-inline-block share-button sb-twitter' href='https://www.blogger.com/share-post.g?blogID=3042129283045399598&postID=9131331354675697613&target=twitter' target='_blank' title='Share to Twitter'><span class='share-button-link-text'>Share to Twitter</span></a><a class='goog-inline-block share-button sb-facebook' href='https://www.blogger.com/share-post.g?blogID=3042129283045399598&postID=9131331354675697613&target=facebook' onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target='_blank' title='Share to Facebook'><span class='share-button-link-text'>Share to Facebook</span></a><a class='goog-inline-block share-button sb-pinterest' href='https://www.blogger.com/share-post.g?blogID=3042129283045399598&postID=9131331354675697613&target=pinterest' target='_blank' title='Share to Pinterest'><span class='share-button-link-text'>Share to Pinterest</span></a>
</div>
</div>
<div class='post-footer-line post-footer-line-2'>
<span class='post-labels'>
</span>
</div>
<div class='post-footer-line post-footer-line-3'>
<span class='post-location'>
</span>
</div>
</div>
</div>
<div class='comments' id='comments'>
<a name='comments'></a>
<h4>22 comments:</h4>
<div class='comments-content'>
<script async='async' src='' type='text/javascript'></script>
<script type='text/javascript'>
    (function() {
      var items = null;
      var msgs = null;
      var config = {};

// <![CDATA[
      var cursor = null;
      if (items && items.length > 0) {
        cursor = parseInt(items[items.length - 1].timestamp) + 1;
      }

      var bodyFromEntry = function(entry) {
        var text = (entry &&
                    ((entry.content && entry.content.$t) ||
                     (entry.summary && entry.summary.$t))) ||
            '';
        if (entry && entry.gd$extendedProperty) {
          for (var k in entry.gd$extendedProperty) {
            if (entry.gd$extendedProperty[k].name == 'blogger.contentRemoved') {
              return '<span class="deleted-comment">' + text + '</span>';
            }
          }
        }
        return text;
      }

      var parse = function(data) {
        cursor = null;
        var comments = [];
        if (data && data.feed && data.feed.entry) {
          for (var i = 0, entry; entry = data.feed.entry[i]; i++) {
            var comment = {};
            // comment ID, parsed out of the original id format
            var id = /blog-(\d+).post-(\d+)/.exec(entry.id.$t);
            comment.id = id ? id[2] : null;
            comment.body = bodyFromEntry(entry);
            comment.timestamp = Date.parse(entry.published.$t) + '';
            if (entry.author && entry.author.constructor === Array) {
              var auth = entry.author[0];
              if (auth) {
                comment.author = {
                  name: (auth.name ? auth.name.$t : undefined),
                  profileUrl: (auth.uri ? auth.uri.$t : undefined),
                  avatarUrl: (auth.gd$image ? auth.gd$image.src : undefined)
                };
              }
            }
            if (entry.link) {
              if (entry.link[2]) {
                comment.link = comment.permalink = entry.link[2].href;
              }
              if (entry.link[3]) {
                var pid = /.*comments\/default\/(\d+)\?.*/.exec(entry.link[3].href);
                if (pid && pid[1]) {
                  comment.parentId = pid[1];
                }
              }
            }
            comment.deleteclass = 'item-control blog-admin';
            if (entry.gd$extendedProperty) {
              for (var k in entry.gd$extendedProperty) {
                if (entry.gd$extendedProperty[k].name == 'blogger.itemClass') {
                  comment.deleteclass += ' ' + entry.gd$extendedProperty[k].value;
                } else if (entry.gd$extendedProperty[k].name == 'blogger.displayTime') {
                  comment.displayTime = entry.gd$extendedProperty[k].value;
                }
              }
            }
            comments.push(comment);
          }
        }
        return comments;
      };

      var paginator = function(callback) {
        if (hasMore()) {
          var url = config.feed + '?alt=json&v=2&orderby=published&reverse=false&max-results=50';
          if (cursor) {
            url += '&published-min=' + new Date(cursor).toISOString();
          }
          window.bloggercomments = function(data) {
            var parsed = parse(data);
            cursor = parsed.length < 50 ? null
                : parseInt(parsed[parsed.length - 1].timestamp) + 1
            callback(parsed);
            window.bloggercomments = null;
          }
          url += '&callback=bloggercomments';
          var script = document.createElement('script');
          script.type = 'text/javascript';
          script.src = url;
          document.getElementsByTagName('head')[0].appendChild(script);
        }
      };
      var hasMore = function() {
        return !!cursor;
      };
      var getMeta = function(key, comment) {
        if ('iswriter' == key) {
          var matches = !!comment.author
              && comment.author.name == config.authorName
              && comment.author.profileUrl == config.authorUrl;
          return matches ? 'true' : '';
        } else if ('deletelink' == key) {
          return config.baseUri + '/delete-comment.g?blogID='
               + config.blogId + '&postID=' + comment.id;
        } else if ('deleteclass' == key) {
          return comment.deleteclass;
        }
        return '';
      };

      var replybox = null;
      var replyUrlParts = null;
      var replyParent = undefined;

      var onReply = function(commentId, domId) {
        if (replybox == null) {
          // lazily cache replybox, and adjust to suit this style:
          replybox = document.getElementById('comment-editor');
          if (replybox != null) {
            replybox.height = '250px';
            replybox.style.display = 'block';
            replyUrlParts = replybox.src.split('#');
          }
        }
        if (replybox && (commentId !== replyParent)) {
          replybox.src = '';
          document.getElementById(domId).insertBefore(replybox, null);
          replybox.src = replyUrlParts[0]
              + (commentId ? '&parentID=' + commentId : '')
              + '#' + replyUrlParts[1];
          replyParent = commentId;
        }
      };

      var hash = (window.location.hash || '#').substring(1);
      var startThread, targetComment;
      if (/^comment-form_/.test(hash)) {
        startThread = hash.substring('comment-form_'.length);
      } else if (/^c[0-9]+$/.test(hash)) {
        targetComment = hash.substring(1);
      }

      // Configure commenting API:
      var configJso = {
        'maxDepth': config.maxThreadDepth
      };
      var provider = {
        'id': config.postId,
        'data': items,
        'loadNext': paginator,
        'hasMore': hasMore,
        'getMeta': getMeta,
        'onReply': onReply,
        'rendered': true,
        'initComment': targetComment,
        'initReplyThread': startThread,
        'config': configJso,
        'messages': msgs
      };

      var render = function() {
        if (window.goog && window.goog.comments) {
          var holder = document.getElementById('comment-holder');
          window.goog.comments.render(holder, provider);
        }
      };

      // render now, or queue to render when library loads:
      if (window.goog && window.goog.comments) {
        render();
      } else {
        window.goog = window.goog || {};
        window.goog.comments = window.goog.comments || {};
        window.goog.comments.loadQueue = window.goog.comments.loadQueue || [];
        window.goog.comments.loadQueue.push(render);
      }
    })();
// ]]>
  </script>
<div id='comment-holder'>
<div class="comment-thread toplevel-thread"><ol id="top-ra"><li class="comment" id="c1594492320985355848"><div class="avatar-image-container"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/01118735346129443582" rel="nofollow">zhangdp214</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html?showComment=1552904118037#c1594492320985355848">March 18, 2019 at 3:15 AM</a></span></div><p class="comment-content">Hi! In my simulation environment, Zimbra&#39;s version is Zimbra 8.7.11_GA_1854. I tried to use the CVE-2018-20160 to trigger the XXE vulnerability, but it failed. The CVE-2018-20160 vulnerability can display content in an HTTP response, but I have tried it many times and found it to be unsuccessful. Do you know how to trigger the CVE-2018-20160 vulnerability?</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="1594492320985355848">Reply</a><span class="item-control blog-admin blog-admin pid-762690084"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=3042129283045399598&amp;postID=1594492320985355848">Delete</a></span></span></div><div class="comment-replies"><div id="c1594492320985355848-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c1594492320985355848-ra" class="thread-chrome thread-expanded"><div></div><div id="c1594492320985355848-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="1594492320985355848">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c1594492320985355848-ce"></div></li><li class="comment" id="c790837067490474483"><div class="avatar-image-container"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/15851337342923837502" rel="nofollow">BG</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html?showComment=1552915716307#c790837067490474483">March 18, 2019 at 6:28 AM</a></span></div><p class="comment-content">How does ssrf upload webshell through clientuploader? I tried it many times and it failed. Because ProxyServlet cookie will not be added to the request, may I ask how you do it?</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="790837067490474483">Reply</a><span class="item-control blog-admin blog-admin pid-1773629985"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=3042129283045399598&amp;postID=790837067490474483">Delete</a></span></span></div><div class="comment-replies"><div id="c790837067490474483-rt" class="comment-thread inline-thread"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c790837067490474483-ra" class="thread-chrome thread-expanded"><div><li class="comment" id="c1701008325348358644"><div class="avatar-image-container"><img src="//4.bp.blogspot.com/-xJUpDcjXJf0/XK2DP7-5E-I/AAAAAAAABIo/GWj_JxQlch0eopomhpJmGkFkI2DtlnawQCK4BGAYYCw/s35/brewmaster1.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/15659119678974316182" rel="nofollow">tint0</a></cite><span class="icon user blog-author"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html?showComment=1554057811692#c1701008325348358644">March 31, 2019 at 11:43 AM</a></span></div><p class="comment-content">You don&#39;t need ssrf for it.</p><span class="comment-actions secondary-text"><span class="item-control blog-admin blog-admin pid-801730244"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=3042129283045399598&amp;postID=1701008325348358644">Delete</a></span></span></div><div class="comment-replies"><div id="c1701008325348358644-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c1701008325348358644-ra" class="thread-chrome thread-expanded"><div></div><div id="c1701008325348358644-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="1701008325348358644">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c1701008325348358644-ce"></div></li></div><div id="c790837067490474483-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="790837067490474483">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c790837067490474483-ce"></div></li><li class="comment" id="c4509838673566018256"><div class="avatar-image-container"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/09220939229302507831" rel="nofollow"></a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html?showComment=1553067677480#c4509838673566018256">March 20, 2019 at 12:41 AM</a></span></div><p class="comment-content">hi,I am a Chinese,can you send me a link about how to exploit the CVE-2019-9621,I`ve been searching for a long time</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="4509838673566018256">Reply</a><span class="item-control blog-admin blog-admin pid-1080310699"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=3042129283045399598&amp;postID=4509838673566018256">Delete</a></span></span></div><div class="comment-replies"><div id="c4509838673566018256-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c4509838673566018256-ra" class="thread-chrome thread-expanded"><div></div><div id="c4509838673566018256-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="4509838673566018256">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c4509838673566018256-ce"></div></li><li class="comment" id="c8826134951584225805"><div class="avatar-image-container"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/15736880315203101938" rel="nofollow">Unknown</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html?showComment=1553094821727#c8826134951584225805">March 20, 2019 at 8:13 AM</a></span></div><p class="comment-content">Hi,<br><br>Sorry for the ignorance and kudos for what it looks like a really outstanding job. For what I could understand, the use of imap is needed for doing some harm. Is not using imap service a good precaution to avoid the risk of being vulnerable? At least while we plan the timeframe for the update?<br><br>Also, excecuting this &quot;zmprov gs `zmhostname` zimbraMemcachedClientServerList&quot; and getting nothing as return, does it means that we have not yet been attacked? Or only that we are not yet vulnerable?<br><br>Thank you very much for your help!<br><br>Thank you!</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="8826134951584225805">Reply</a><span class="item-control blog-admin blog-admin pid-2002606801"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=3042129283045399598&amp;postID=8826134951584225805">Delete</a></span></span></div><div class="comment-replies"><div id="c8826134951584225805-rt" class="comment-thread inline-thread"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c8826134951584225805-ra" class="thread-chrome thread-expanded"><div><li class="comment" id="c1606838193251754545"><div class="avatar-image-container"><img src="//4.bp.blogspot.com/-xJUpDcjXJf0/XK2DP7-5E-I/AAAAAAAABIo/GWj_JxQlch0eopomhpJmGkFkI2DtlnawQCK4BGAYYCw/s35/brewmaster1.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/15659119678974316182" rel="nofollow">tint0</a></cite><span class="icon user blog-author"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html?showComment=1554056674688#c1606838193251754545">March 31, 2019 at 11:24 AM</a></span></div><p class="comment-content">Hi, sorry for the late reply. That command output does mean you are not vulnerable to the deserialization RCE, so blocking IMAP wouldn&#39;t make much sense.</p><span class="comment-actions secondary-text"><span class="item-control blog-admin blog-admin pid-801730244"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=3042129283045399598&amp;postID=1606838193251754545">Delete</a></span></span></div><div class="comment-replies"><div id="c1606838193251754545-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c1606838193251754545-ra" class="thread-chrome thread-expanded"><div></div><div id="c1606838193251754545-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="1606838193251754545">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c1606838193251754545-ce"></div></li></div><div id="c8826134951584225805-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="8826134951584225805">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c8826134951584225805-ce"></div></li><li class="comment" id="c5917801268566755233"><div class="avatar-image-container"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/17533858294312389629" rel="nofollow">Unknown</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html?showComment=1553558184157#c5917801268566755233">March 25, 2019 at 4:56 PM</a></span></div><p class="comment-content">thanks for info ;)</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="5917801268566755233">Reply</a><span class="item-control blog-admin blog-admin pid-1736492227"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=3042129283045399598&amp;postID=5917801268566755233">Delete</a></span></span></div><div class="comment-replies"><div id="c5917801268566755233-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c5917801268566755233-ra" class="thread-chrome thread-expanded"><div></div><div id="c5917801268566755233-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="5917801268566755233">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c5917801268566755233-ce"></div></li><li class="comment" id="c520642507247811329"><div class="avatar-image-container"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/10742150252299991564" rel="nofollow">ITHound</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html?showComment=1554260388013#c520642507247811329">April 2, 2019 at 7:59 PM</a></span></div><p class="comment-content">Imagine my surprise when I saw 5 random chars account with an admin one in one of my clients server. LOL, Wtf??<br>Lucky for me, he left many prints through its journey into that server, and I noticed him.<br>But he was able to upload a java web shell, wget some Bash stuff and tried to execute it to gain root access. Patched and cut him off just in time.<br>However logs analysis (particularly XXE in Autodiscover.xml) brought me here. <br>A very nice job. Work like this helps to build a better and more secure internet.<br>Thanks</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="520642507247811329">Reply</a><span class="item-control blog-admin blog-admin pid-1718161246"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=3042129283045399598&amp;postID=520642507247811329">Delete</a></span></span></div><div class="comment-replies"><div id="c520642507247811329-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c520642507247811329-ra" class="thread-chrome thread-expanded"><div></div><div id="c520642507247811329-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="520642507247811329">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c520642507247811329-ce"></div></li><li class="comment" id="c7020528835121393307"><div class="avatar-image-container"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/16649902221111127256" rel="nofollow">syrius01</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html?showComment=1554744870065#c7020528835121393307">April 8, 2019 at 10:34 AM</a></span></div><p class="comment-content">Would be awesome to test that via a python script just to see if our environment is vulnerable. Didn&#39;t saw any PoC scripts yet :/</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="7020528835121393307">Reply</a><span class="item-control blog-admin blog-admin pid-1140728798"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=3042129283045399598&amp;postID=7020528835121393307">Delete</a></span></span></div><div class="comment-replies"><div id="c7020528835121393307-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c7020528835121393307-ra" class="thread-chrome thread-expanded"><div></div><div id="c7020528835121393307-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="7020528835121393307">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c7020528835121393307-ce"></div></li><li class="comment" id="c1662334990241208128"><div class="avatar-image-container"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/11647642822006036879" rel="nofollow">Si Pa</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html?showComment=1554924669950#c1662334990241208128">April 10, 2019 at 12:31 PM</a></span></div><p class="comment-content">Can we just upgrade mailbox server from 8.7.1 to 8.7.11 and then patch 10 without upgrading LDAP, proxy ,mta</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="1662334990241208128">Reply</a><span class="item-control blog-admin blog-admin pid-996144256"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=3042129283045399598&amp;postID=1662334990241208128">Delete</a></span></span></div><div class="comment-replies"><div id="c1662334990241208128-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c1662334990241208128-ra" class="thread-chrome thread-expanded"><div></div><div id="c1662334990241208128-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="1662334990241208128">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c1662334990241208128-ce"></div></li><li class="comment" id="c8862643283208439147"><div class="avatar-image-container"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/11647642822006036879" rel="nofollow">Si Pa</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html?showComment=1554924819719#c8862643283208439147">April 10, 2019 at 12:33 PM</a></span></div><p class="comment-content">Can we change the ownership of /jetty/webapps/zimbra to other system accounts and only allow zimbra for read and execute without write permission so that we can prevent hacker on uploading files</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="8862643283208439147">Reply</a><span class="item-control blog-admin blog-admin pid-996144256"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=3042129283045399598&amp;postID=8862643283208439147">Delete</a></span></span></div><div class="comment-replies"><div id="c8862643283208439147-rt" class="comment-thread inline-thread"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c8862643283208439147-ra" class="thread-chrome thread-expanded"><div><li class="comment" id="c3431192152286148521"><div class="avatar-image-container"><img src="//4.bp.blogspot.com/-xJUpDcjXJf0/XK2DP7-5E-I/AAAAAAAABIo/GWj_JxQlch0eopomhpJmGkFkI2DtlnawQCK4BGAYYCw/s35/brewmaster1.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/15659119678974316182" rel="nofollow">tint0</a></cite><span class="icon user blog-author"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html?showComment=1554953309955#c3431192152286148521">April 10, 2019 at 8:28 PM</a></span></div><p class="comment-content">You should do it on the /webapps directory, not just /zimbra</p><span class="comment-actions secondary-text"><span class="item-control blog-admin blog-admin pid-801730244"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=3042129283045399598&amp;postID=3431192152286148521">Delete</a></span></span></div><div class="comment-replies"><div id="c3431192152286148521-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c3431192152286148521-ra" class="thread-chrome thread-expanded"><div></div><div id="c3431192152286148521-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="3431192152286148521">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c3431192152286148521-ce"></div></li></div><div id="c8862643283208439147-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="8862643283208439147">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c8862643283208439147-ce"></div></li><li class="comment" id="c1192108093518031126"><div class="avatar-image-container"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/13117077627574958037" rel="nofollow">halfgaar</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html?showComment=1556374380539#c1192108093518031126">April 27, 2019 at 7:13 AM</a></span></div><p class="comment-content">When it comes to blocking &#39;/service/proxy&#39;: I decided to block HTTP(S) completely and only allow access through an HTTP proxy with HTTP authentication. So, to use my webmail, I have to go to the proxy and enter a browser password first. I had to exlude some paths to make CalDAV and CardDAV work.<br><br>See details here: https://forums.zimbra.org/viewtopic.php?f=15&amp;t=65932&amp;start=30#p289864.</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="1192108093518031126">Reply</a><span class="item-control blog-admin blog-admin pid-1335977716"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=3042129283045399598&amp;postID=1192108093518031126">Delete</a></span></span></div><div class="comment-replies"><div id="c1192108093518031126-rt" class="comment-thread inline-thread"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c1192108093518031126-ra" class="thread-chrome thread-expanded"><div><li class="comment" id="c1191921972339401894"><div class="avatar-image-container"><img src="//4.bp.blogspot.com/-xJUpDcjXJf0/XK2DP7-5E-I/AAAAAAAABIo/GWj_JxQlch0eopomhpJmGkFkI2DtlnawQCK4BGAYYCw/s35/brewmaster1.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/15659119678974316182" rel="nofollow">tint0</a></cite><span class="icon user blog-author"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html?showComment=1556613031938#c1191921972339401894">April 30, 2019 at 1:30 AM</a></span></div><p class="comment-content">That seems to only add an additional layer of authentication and doesn&#39;t really block /service/proxy. For the workaround I&#39;d block ProxyServlet from public access altogether. To do that, change the allowed.ports parameter to only 7070 in the servlet tag named ProxyServlet in {zimbra_home}/mailboxd/etc/service.web.xml.in and restart the instance. You could also disable AutoDiscoverServlet there for the XXE.</p><span class="comment-actions secondary-text"><span class="item-control blog-admin blog-admin pid-801730244"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=3042129283045399598&amp;postID=1191921972339401894">Delete</a></span></span></div><div class="comment-replies"><div id="c1191921972339401894-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c1191921972339401894-ra" class="thread-chrome thread-expanded"><div></div><div id="c1191921972339401894-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="1191921972339401894">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c1191921972339401894-ce"></div></li><li class="comment" id="c5188999848730316012"><div class="avatar-image-container"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/11647642822006036879" rel="nofollow">Si Pa</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html?showComment=1556710621202#c5188999848730316012">May 1, 2019 at 4:37 AM</a></span></div><p class="comment-content">This comment has been removed by the author.</p><span class="comment-actions secondary-text"><span class="item-control blog-admin blog-admin "><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=3042129283045399598&amp;postID=5188999848730316012">Delete</a></span></span></div><div class="comment-replies"><div id="c5188999848730316012-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c5188999848730316012-ra" class="thread-chrome thread-expanded"><div></div><div id="c5188999848730316012-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="5188999848730316012">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c5188999848730316012-ce"></div></li><li class="comment" id="c6896165069421667157"><div class="avatar-image-container"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/11647642822006036879" rel="nofollow">Si Pa</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html?showComment=1556710711535#c6896165069421667157">May 1, 2019 at 4:38 AM</a></span></div><p class="comment-content">Is it mean to change the below line<br>from <br>\\\\%%zimbraMailPort%%, %%zimbraMailSSLPort%%, 7070\\\<br>\\\\7070\\\</p><span class="comment-actions secondary-text"><span class="item-control blog-admin blog-admin pid-996144256"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=3042129283045399598&amp;postID=6896165069421667157">Delete</a></span></span></div><div class="comment-replies"><div id="c6896165069421667157-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c6896165069421667157-ra" class="thread-chrome thread-expanded"><div></div><div id="c6896165069421667157-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="6896165069421667157">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c6896165069421667157-ce"></div></li><li class="comment" id="c2521635298266608998"><div class="avatar-image-container"><img src="//4.bp.blogspot.com/-xJUpDcjXJf0/XK2DP7-5E-I/AAAAAAAABIo/GWj_JxQlch0eopomhpJmGkFkI2DtlnawQCK4BGAYYCw/s35/brewmaster1.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/15659119678974316182" rel="nofollow">tint0</a></cite><span class="icon user blog-author"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html?showComment=1556712506031#c2521635298266608998">May 1, 2019 at 5:08 AM</a></span></div><p class="comment-content">Yes. I also updated the blog post to include this workaround.</p><span class="comment-actions secondary-text"><span class="item-control blog-admin blog-admin pid-801730244"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=3042129283045399598&amp;postID=2521635298266608998">Delete</a></span></span></div><div class="comment-replies"><div id="c2521635298266608998-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c2521635298266608998-ra" class="thread-chrome thread-expanded"><div></div><div id="c2521635298266608998-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="2521635298266608998">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c2521635298266608998-ce"></div></li></div><div id="c1192108093518031126-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="1192108093518031126">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c1192108093518031126-ce"></div></li><li class="comment" id="c1166393513556522288"><div class="avatar-image-container"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/02041982936110353738" rel="nofollow">luca219</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html?showComment=1556454521070#c1166393513556522288">April 28, 2019 at 5:28 AM</a></span></div><p class="comment-content">Hi, I tried in my lab to use metasploit zimbra XXE module, with zimbra 8.6.0 1194 on centos7.  <br>The exploit can&#39;t upload java file, but can create the user.I want to try this vulnerability in my lab,  Someone can give me some suggestion?<br><br>[*] Executing payload on /downloads/LrLEjpQrXJbHDOq.jsp<br>[*] Server stopped.<br>[!] This exploit may require manual cleanup of &#39;$(find /opt/zimbra/ -regex &#39;.*downloads/.*LrLEjpQrXJbHDOq.jsp&#39; -type f)&#39; on the target<br>[!] This exploit may require manual cleanup of &#39;$(find /opt/zimbra/ -regex &#39;.*downloads/.*LrLEjpQrXJbHDOq.*1StreamConnector.class&#39; -type f)&#39; on the target<br></p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="1166393513556522288">Reply</a><span class="item-control blog-admin blog-admin pid-1321005893"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=3042129283045399598&amp;postID=1166393513556522288">Delete</a></span></span></div><div class="comment-replies"><div id="c1166393513556522288-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c1166393513556522288-ra" class="thread-chrome thread-expanded"><div></div><div id="c1166393513556522288-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="1166393513556522288">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c1166393513556522288-ce"></div></li><li class="comment" id="c5914965266103818494"><div class="avatar-image-container"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/11647642822006036879" rel="nofollow">Si Pa</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html?showComment=1556847133757#c5914965266103818494">May 2, 2019 at 6:32 PM</a></span></div><p class="comment-content">I have checked that the mailbox server is not listening on port 7070 and only the admin port 7071. What is the meaning of 7070 port in the remaining configuration?<br>How to total disable the autodiscover servlet?</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="5914965266103818494">Reply</a><span class="item-control blog-admin blog-admin pid-996144256"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=3042129283045399598&amp;postID=5914965266103818494">Delete</a></span></span></div><div class="comment-replies"><div id="c5914965266103818494-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c5914965266103818494-ra" class="thread-chrome thread-expanded"><div></div><div id="c5914965266103818494-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="5914965266103818494">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c5914965266103818494-ce"></div></li><li class="comment" id="c25260218394674211"><div class="avatar-image-container"><img src="//resources.blogblog.com/img/blank.gif" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html?showComment=1557168318754#c25260218394674211">May 6, 2019 at 11:45 AM</a></span></div><p class="comment-content">Hi,<br><br>Thanks for the detailed announcement.<br><br>We would like to know if Zimbra&#39;s MTA vulnerable? From what we can see on your blog post, HTTP+IMAP are vulnerable and mainly any service proxied by Zimbra&#39; Nginx. We have an internal server where all the ports are restricted beside tcp port 25 in order to receive emails. The service that listens to this port is Postfix. Is there ANY chances we could have been vulnerable?<br><br>Thanks!</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="25260218394674211">Reply</a><span class="item-control blog-admin blog-admin pid-1539918603"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=3042129283045399598&amp;postID=25260218394674211">Delete</a></span></span></div><div class="comment-replies"><div id="c25260218394674211-rt" class="comment-thread inline-thread"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c25260218394674211-ra" class="thread-chrome thread-expanded"><div><li class="comment" id="c3912853935197999846"><div class="avatar-image-container"><img src="//4.bp.blogspot.com/-xJUpDcjXJf0/XK2DP7-5E-I/AAAAAAAABIo/GWj_JxQlch0eopomhpJmGkFkI2DtlnawQCK4BGAYYCw/s35/brewmaster1.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/15659119678974316182" rel="nofollow">tint0</a></cite><span class="icon user blog-author"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html?showComment=1557199308395#c3912853935197999846">May 6, 2019 at 8:21 PM</a></span></div><p class="comment-content">AFAIK Postfix has nothing to do with the other services so you should be fine.</p><span class="comment-actions secondary-text"><span class="item-control blog-admin blog-admin pid-801730244"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=3042129283045399598&amp;postID=3912853935197999846">Delete</a></span></span></div><div class="comment-replies"><div id="c3912853935197999846-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c3912853935197999846-ra" class="thread-chrome thread-expanded"><div></div><div id="c3912853935197999846-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="3912853935197999846">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c3912853935197999846-ce"></div></li></div><div id="c25260218394674211-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="25260218394674211">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c25260218394674211-ce"></div></li><li class="comment" id="c7900006837201203157"><div class="avatar-image-container"><img src="//resources.blogblog.com/img/blank.gif" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html?showComment=1557234993597#c7900006837201203157">May 7, 2019 at 6:16 AM</a></span></div><p class="comment-content">Thanks for the answer. How about LMTP ?</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="7900006837201203157">Reply</a><span class="item-control blog-admin blog-admin pid-1539918603"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=3042129283045399598&amp;postID=7900006837201203157">Delete</a></span></span></div><div class="comment-replies"><div id="c7900006837201203157-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c7900006837201203157-ra" class="thread-chrome thread-expanded"><div></div><div id="c7900006837201203157-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="7900006837201203157">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c7900006837201203157-ce"></div></li></ol><div id="top-continue" class="continue"><a class="comment-reply" target="_self">Add comment</a></div><div class="comment-replybox-thread" id="top-ce"></div><div class="loadmore hidden" data-post-id="9131331354675697613"><a target="_self">Load more...</a></div></div>
</div>
</div>
<p class='comment-footer'>
<div class='comment-form'>
<a name='comment-form'></a>
<p>
</p>
<a href='https://www.blogger.com/comment-iframe.g?blogID=3042129283045399598&postID=9131331354675697613' id='comment-editor-src'></a>
<iframe allowtransparency='true' class='blogger-iframe-colorize blogger-comment-from-post' frameborder='0' height='410px' id='comment-editor' name='comment-editor' src='' width='100%'></iframe>
<script src='https://www.blogger.com/static/v1/jsbin/2517944472-comment_from_post_iframe.js' type='text/javascript'></script>
<script type='text/javascript'>
      BLOG_CMT_createIframe('https://www.blogger.com/rpc_relay.html');
    </script>
</div>
</p>
<div id='backlinks-container'>
<div id='Blog1_backlinks-container'>
</div>
</div>
</div>
</div>

        </div></div>
      
</div>
<div class='blog-pager' id='blog-pager'>
<span id='blog-pager-newer-link'>
<a class='blog-pager-newer-link' href='https://blog.tint0.com/2021/09/pinging-xmlsec.html' id='Blog1_blog-pager-newer-link' title='Newer Post'>Newer Post</a>
</span>
<span id='blog-pager-older-link'>
<a class='blog-pager-older-link' href='https://blog.tint0.com/2019/03/when-el-injection-meets-java-deserialization.html' id='Blog1_blog-pager-older-link' title='Older Post'>Older Post</a>
</span>
<a class='home-link' href='https://blog.tint0.com/'>Home</a>
</div>
<div class='clear'></div>
<div class='post-feeds'>
<div class='feed-links'>
Subscribe to:
<a class='feed-link' href='https://blog.tint0.com/feeds/9131331354675697613/comments/default' target='_blank' type='application/atom+xml'>Post Comments (Atom)</a>
</div>
</div>
</div></div>
</div>
</div>
<div class='column-left-outer'>
<div class='column-left-inner'>
<aside>
</aside>
</div>
</div>
<div class='column-right-outer'>
<div class='column-right-inner'>
<aside>
<div class='sidebar section' id='sidebar-right-1'><div class='widget BlogArchive' data-version='1' id='BlogArchive1'>
<h2>Blog Archive</h2>
<div class='widget-content'>
<div id='ArchiveList'>
<div id='BlogArchive1_ArchiveList'>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://blog.tint0.com/2021/'>
2021
</a>
<span class='post-count' dir='ltr'>(1)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://blog.tint0.com/2021/09/'>
Sep 2021
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://blog.tint0.com/2019/'>
2019
</a>
<span class='post-count' dir='ltr'>(3)</span>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://blog.tint0.com/2019/03/'>
Mar 2019
</a>
<span class='post-count' dir='ltr'>(3)</span>
<ul class='posts'>
<li><a href='https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html'>A Saga of Code Executions on Zimbra</a></li>
<li><a href='https://blog.tint0.com/2019/03/when-el-injection-meets-java-deserialization.html'>When EL Injection meets Java Deserialization</a></li>
<li><a href='https://blog.tint0.com/2019/03/matesctf-2018-wutfaces-cve-2013-2165.html'>MatesCTF 2018 WutFaces &amp; CVE-2013-2165</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class='clear'></div>
</div>
</div></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='sidebar no-items section' id='sidebar-right-2-1'></div>
</td>
<td class='columns-cell'>
<div class='sidebar no-items section' id='sidebar-right-2-2'></div>
</td>
</tr>
</tbody>
</table>
<div class='sidebar no-items section' id='sidebar-right-3'></div>
</aside>
</div>
</div>
</div>
<div style='clear: both'></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class='main-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<footer>
<div class='footer-outer'>
<div class='footer-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left footer-fauxborder-left'>
<div class='fauxborder-right footer-fauxborder-right'></div>
<div class='region-inner footer-inner'>
<div class='foot section' id='footer-1'><div class='widget Profile' data-version='1' id='Profile1'>
<h2>About Me</h2>
<div class='widget-content'>
<a href='https://www.blogger.com/profile/15659119678974316182'><img alt='My photo' class='profile-img' height='80' src='//3.bp.blogspot.com/-K_q_Lfzkhag/XIfcuzuSeoI/AAAAAAAABDs/3h09BrLdCKMuZ-GH2sYehoCS6d_eIqmRgCK4BGAYYCw/s80/brewmaster1.png' width='80'/></a>
<dl class='profile-datablock'>
<dt class='profile-data'>
<a class='profile-name-link g-profile' href='https://www.blogger.com/profile/15659119678974316182' rel='author' style='background-image: url(//www.blogger.com/img/logo-16.png);'>
tint0
</a>
</dt>
</dl>
<a class='profile-link' href='https://www.blogger.com/profile/15659119678974316182' rel='author'>View my complete profile</a>
<div class='clear'></div>
</div>
</div></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='foot no-items section' id='footer-2-1'></div>
</td>
<td class='columns-cell'>
<div class='foot no-items section' id='footer-2-2'></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class='foot section' id='footer-3' name='Footer'><div class='widget Attribution' data-version='1' id='Attribution1'>
<div class='widget-content' style='text-align: center;'>
Powered by <a href='https://www.blogger.com' target='_blank'>Blogger</a>.
</div>
<div class='clear'></div>
</div></div>
</div>
</div>
<div class='footer-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class='content-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<script type='text/javascript'>
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>
<script src='https://apis.google.com/js/plusone.js' type='text/javascript'></script>

<script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/1140752822-widgets.js"></script>
<script type='text/javascript'>
window['__wavt'] = 'AOuZoY4eppKruofZ8LMs58rrhM6-xAtXfw:1635610567570';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d3042129283045399598','//blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html','3042129283045399598');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '3042129283045399598', 'title': 'tint0', 'url': 'https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html', 'canonicalUrl': 'https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html', 'homepageUrl': 'https://blog.tint0.com/', 'searchUrl': 'https://blog.tint0.com/search', 'canonicalHomepageUrl': 'https://blog.tint0.com/', 'blogspotFaviconUrl': 'https://blog.tint0.com/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': true, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': 'UA-209049493-1', 'encoding': 'UTF-8', 'locale': 'en', 'localeUnderscoreDelimited': 'en', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22tint0 - Atom\x22 href\x3d\x22https://blog.tint0.com/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22tint0 - RSS\x22 href\x3d\x22https://blog.tint0.com/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22tint0 - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/3042129283045399598/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22tint0 - Atom\x22 href\x3d\x22https://blog.tint0.com/feeds/9131331354675697613/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'adsenseAutoAds': false, 'ieCssRetrofitLinks': '\x3c!--[if IE]\x3e\x3cscript type\x3d\x22text/javascript\x22 src\x3d\x22https://www.blogger.com/static/v1/jsbin/403901366-ieretrofit.js\x22\x3e\x3c/script\x3e\n\x3c![endif]--\x3e', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/091427a9c3afa5a8', 'plusOneApiSrc': 'https://apis.google.com/js/plusone.js', 'disableGComments': true, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'Twitter', 'key': 'twitter', 'shareMessage': 'Share to Twitter', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 0, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '9131331354675697613', 'postImageThumbnailUrl': 'https://1.bp.blogspot.com/-q0RYsZOQhVw/XIjXY6D0gRI/AAAAAAAABEY/ShFcmeO1c8I1BKL4BT-POYqqVuSrBkjmgCLcBGAs/s72-c/ftp_patch.PNG', 'postImageUrl': 'https://1.bp.blogspot.com/-q0RYsZOQhVw/XIjXY6D0gRI/AAAAAAAABEY/ShFcmeO1c8I1BKL4BT-POYqqVuSrBkjmgCLcBGAs/s400/ftp_patch.PNG', 'pageName': 'A Saga of Code Executions on Zimbra', 'pageTitle': 'tint0: A Saga of Code Executions on Zimbra'}}, {'name': 'features', 'data': {'sharing_get_link_dialog': 'true', 'sharing_native': 'false'}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard!', 'ok': 'Ok', 'postLink': 'Post Link'}}, {'name': 'template', 'data': {'name': 'custom', 'localizedName': 'Custom', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': true}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'A Saga of Code Executions on Zimbra', 'description': 'Zimbra is well known for its signature email product, Zimbra Collaboration Suite. Putting client-side vulnerabilities aside, Zimbra seems to...', 'featuredImage': 'https://1.bp.blogspot.com/-q0RYsZOQhVw/XIjXY6D0gRI/AAAAAAAABEY/ShFcmeO1c8I1BKL4BT-POYqqVuSrBkjmgCLcBGAs/s400/ftp_patch.PNG', 'url': 'https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 9131331354675697613}}]);
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/1918504883-lbx.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/4076883957-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-1', document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_ProfileView', new _WidgetInfo('Profile1', 'footer-1', document.getElementById('Profile1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', document.getElementById('Attribution1'), {}, 'displayModeFull'));
</script>
</body>
</html>